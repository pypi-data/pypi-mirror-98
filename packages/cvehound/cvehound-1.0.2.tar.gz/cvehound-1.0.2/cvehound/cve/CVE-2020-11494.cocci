/// Files: drivers/net/can/slcan.c
/// Fix: b9258a2cece4ec1f020715fe3554bc2e360f6264
/// Fixes: a1044e36e457fb6dbdf90ce756d578b251d99b5e

virtual detect

@err exists@
identifier cf;
position p;
@@

slc_bump(...)
{
	...
*	struct can_frame cf;@p
	... when != memset(&cf, 0, sizeof(cf));
(
	skb_put_data(..., &cf, \(sizeof(struct can_frame)\|sizeof(cf)\))
|
	memcpy(..., &cf, \(sizeof(struct can_frame)\|sizeof(cf)\))
)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-11494')
