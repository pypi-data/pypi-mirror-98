/// Files: drivers/android/binder.c
/// Fix: 16981742717b04644a41052570fb502682a315d2
/// Fixes: bde4a19fc04f5f46298c86b1acb7a4af1d5f138d

virtual detect

@err exists@
identifier buffer_offset, off_start_offset;
position p;
// typedef binder_size_t;
@@

binder_transaction(...)
{
	... when any
//*	TODO: (buffer_offset - off_start_offset) *@p sizeof(binder_size_t)

(
*	size_t num_valid = (buffer_offset - off_start_offset) *@p ...;
|
*	num_valid = (buffer_offset - off_start_offset) *@p ...;
)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-0041')
