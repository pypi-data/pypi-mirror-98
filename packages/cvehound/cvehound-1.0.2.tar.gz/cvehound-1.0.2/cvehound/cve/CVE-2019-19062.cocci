/// Files: crypto/crypto_user_base.c
/// Fix: ffdde5932042600c6807d46c1550b28b0db6a3bc
/// Fixes: a38f7907b926e4c6c7d389ad96cc38cec2e5a9e9

virtual detect

@err exists@
identifier skb;
position p;
@@

crypto_report(...)
{
	... when any
*	skb = nlmsg_new(...);
	...
	if (err) {
		... when != kfree_skb(skb);
* 		return err;@p
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19062')
