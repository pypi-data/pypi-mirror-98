/// Files: mm/gup.c
/// Fix: 9fa2dd946743ae6f30dc4830da19147bf100a7f2
/// Fixes: 3faa52c03f440d1b9ddef18c4f189f4790d52d7e

virtual detect

@try_grab_page@
@@

try_grab_page(...)
{
	...
}

@err depends on try_grab_page exists@
identifier page, ret;
position p;
@@

get_gate_page(...)
{
	... when any
*	if (unlikely(!try_get_page@p(*page))) {
		ret = -ENOMEM;
 		goto unmap;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-25221')
