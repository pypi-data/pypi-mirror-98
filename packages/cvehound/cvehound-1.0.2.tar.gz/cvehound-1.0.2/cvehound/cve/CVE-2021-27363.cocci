/// Files: drivers/scsi/scsi_transport_iscsi.c
/// Fix: 688e8128b7a92df982709a4137ea4588d16f24aa
/// Fixes: 0896b752302662909b52895bd7f601136001069d

virtual detect

@err exists@
identifier priv;
type T;
position p;
@@

show_transport_handle(...)
{
	... when != if (!capable(CAP_SYS_ADMIN)) return -EACCES;
*	return \(sysfs_emit@p\|sprintf@p\)(..., (T)iscsi_handle(priv->iscsi_transport));
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-27363')
