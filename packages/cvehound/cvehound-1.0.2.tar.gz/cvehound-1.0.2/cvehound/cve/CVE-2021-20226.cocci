/// Files: fs/io_uring.c
/// Fix: 0f2122045b946241a9e549c2a76cea54fa58a7ff
/// Fixes: 

virtual detect

@err exists@
identifier req;
position p;
@@

io_grab_files(struct io_kiocb *req)
{
	...
*	req->work.files =@p current->files;
	... when != atomic_inc(&files->count);
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-20226')
