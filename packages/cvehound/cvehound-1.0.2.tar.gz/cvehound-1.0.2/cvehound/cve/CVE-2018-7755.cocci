/// Files: drivers/block/floppy.c
/// Fix: 65eea8edc315589d6c993cf12dbb5d0e9ef1fe4e
/// Fixes: v2.6.12-rc2

virtual detect

@err exists@
identifier cmd, outparam;
position p;
@@

	switch (cmd) {
	case FDGETPRM:
		...
*		get_floppy_geometry@p(..., (struct floppy_struct **)&outparam)
		... when != outparam
		break;
	}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-7755')
