/// Files: arch/x86/kvm/vmx.c
/// Fix: c2dd5146e9fe1f22c77c1b011adf84eea0245806
/// Fixes: 5e2f30b756a37bd80c5b0471d0e10d769ab2eb9a

virtual detect

@err exists@
identifier vmx;
position p;
@@

nested_get_vmcs12_pages(...)
{
	... when any
	if (vmx->nested.pi_desc_page) {
		...
*		vmx->nested.pi_desc_page =@p NULL;
		... when != vmx->nested.pi_desc = NULL;
		    when != vmcs_write64(POSTED_INTR_DESC_ADDR, -1ull);
	}
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-16882')
