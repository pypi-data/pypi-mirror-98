/// Files: net/ipv4/icmp.c
/// Fix: b38e7819cae946e2edf869e604af1e65a5d241c5
/// Fixes: 4cdf507d54525842dfd9f6313fdafba039084046

virtual detect

@err exists@
identifier credit;
position p;
@@

icmp_global_allow(void)
{
	... when any
	credit = min_t(...);
	if (credit) {
*		credit--;@p
		...
		rc = true;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-25705')
