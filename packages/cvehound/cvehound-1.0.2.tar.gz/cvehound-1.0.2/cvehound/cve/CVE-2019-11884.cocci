/// Files: net/bluetooth/hidp/sock.c
/// Fix: a1616a5ac99ede5d605047a9012481ce7ff18b16
/// Fixes: v2.6.12-rc2

virtual detect

@err exists@
identifier cmd;
position p;
@@

\(do_hidp_sock_ioctl\|hidp_sock_ioctl\)(..., unsigned int cmd, ...)
{
	... when any
	switch (cmd) {
	case HIDPCONNADD:
		... when any
		copy_from_user(&ca, argp, sizeof(ca))
		... when != ca.name[sizeof(ca.name)-1] = 0;
*		copy_to_user(argp, &ca, sizeof(ca))@p
		...when any
	}
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-11884')
