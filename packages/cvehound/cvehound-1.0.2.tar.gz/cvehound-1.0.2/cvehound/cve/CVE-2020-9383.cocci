/// Files: drivers/block/floppy.c
/// Fix: 2e90ca68b0d2f5548804f22f0dd61145516171e3
/// Fixes: v2.6.12-rc2

virtual detect

@err exists@
identifier drive;
position p;
@@

set_fdc(int drive)
{
	...
*	fdc = FDC(drive);@p
	...
	if (...) {
		...
		return ...;
	}
	...
	fdc
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-9383')
