/// Files: kernel/bpf/verifier.c
/// Fix: 5b9fbeb75b6a98955f628e205ac26689bcb1383e
/// Fixes: 3f50f132d8400e129fc9eb68b5020167ef80a244

virtual detect

@err@
type s32, u32;
position p;
@@

scalar32_min_max_or(struct bpf_reg_state *dst_reg,
		    struct bpf_reg_state *src_reg)
{
	...
*	s32 smin_val = src_reg->smin_value;@p
*	u32 umin_val = src_reg->umin_value;
	...
*	dst_reg->s32_min_value = dst_reg->umin_value;
*	dst_reg->s32_max_value = dst_reg->umax_value;
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-27194")
