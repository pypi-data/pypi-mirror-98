/// Files: sound/usb/helper.c
/// Fix: 5d78e1c2b7f4be00bbe62141603a631dc7812f35
/// Fixes: 801ebf1043ae7b182588554cc9b9ad3c14bc2ab5

virtual detect

@err exists@
identifier ep, dev, pipe;
position p;
@@

snd_usb_pipe_sanity_check(struct usb_device *dev, unsigned int pipe)
{
	...
*	ep = usb_pipe_endpoint@p(dev, pipe);
	... when != if (!ep || ...) return -EINVAL;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-15222')
