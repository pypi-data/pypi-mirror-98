/// Files: drivers/gpu/drm/drm_edid_load.c
/// Fix: 9f1f1a2dab38d4ce87a13565cf4dc1b73bef3a5f
/// Fixes: 96206e2922c114b13cadefa03b9f340b58fee13c

virtual detect

@err exists@
position p;
statement S;
@@

drm_load_edid_firmware(...)
{
	...
*	fwstr = kstrdup@p(edid_firmware, ...);
	... when != if (!fwstr) S
*	edidstr = fwstr;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-12382')
