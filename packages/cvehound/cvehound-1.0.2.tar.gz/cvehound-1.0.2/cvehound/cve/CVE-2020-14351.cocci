/// Files: kernel/events/core.c
/// Fix: f91072ed1b7283b13ca57fcfbece5a3b92726143
/// Fixes: 9bb5d40cd93c9dd4be74834b1dcb1ba03629716b

virtual detect

@err exists@
identifier rb;
position p;
statement S;
@@

perf_mmap_close(...)
{
	...
*	atomic_dec(&rb->mmap_count)@p
	...
*	if (atomic_read(&rb->mmap_count)) S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-14351')
