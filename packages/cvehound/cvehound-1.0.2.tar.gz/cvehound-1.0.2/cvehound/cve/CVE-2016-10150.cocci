/// Files: virt/kvm/kvm_main.c
/// Fix: a0f1d21c1ccb1da66629627a74059dd7f5ac9c61
/// Fixes: a28ebea2adc4a2bef5989a5a181ec238f59fbcad

virtual detect

@err exists@
identifier ret, ops, dev;
position p;
@@

kvm_ioctl_create_device(...)
{
	...
	ret = anon_inode_getfd(...);
	if (ret < 0) {
*		ops->destroy(dev);@p
		...
*		list_del(&dev->vm_node);
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-10150')
