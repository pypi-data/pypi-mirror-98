/// Files: net/sctp/associola.c
/// Fix: 600ddd6825543962fb807884169e57b580dba208
/// Fixes: 730fc3d05cd4ba4c9ce2de91f3d43349e95dbbf5

virtual detect

@err exists@
identifier asoc;
position p;
@@

sctp_assoc_update(struct sctp_association *asoc, ...)
{
	...
*	sctp_auth_key_put@p(asoc->asoc_shared_key);
	sctp_auth_asoc_init_active_key(asoc, GFP_ATOMIC);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2015-1421')
