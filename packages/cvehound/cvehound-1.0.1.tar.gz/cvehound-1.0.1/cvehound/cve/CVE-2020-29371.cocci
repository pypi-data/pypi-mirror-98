/// Files: fs/romfs/storage.c
/// Fix: bcf85fcedfdd17911982a3e3564fcfec7b01eebd
/// Fixes: da4458bda237aa0cb1688f6c359477f203788f6a

virtual detect

@err@
identifier sb, pos, limit;
position p;
@@

romfs_dev_read(struct super_block *sb, unsigned long pos, ...)
{
	...
*	limit =@p romfs_maxsize(sb);
	... when != if (pos >= limit || buflen > limit - pos) return -EIO;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-29371")
