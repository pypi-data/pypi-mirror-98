/// Files: lib/syscall.c
/// Fix: 4f134b89a24b965991e7c345b9a4591821f7c2a6
/// Fixes: 631b7abacd02b88f4b0795c08b54ad4fc3e7c7c0

virtual detect

@err@
identifier target, regs, info;
position p;
@@

collect_syscall(..., struct task_struct *target, ..., struct syscall_info *info)
{
	...
	struct pt_regs *regs;
	...
*	syscall_get_arguments(target, regs, ..., (unsigned long *)&info->data.args[0]);@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-28588")
