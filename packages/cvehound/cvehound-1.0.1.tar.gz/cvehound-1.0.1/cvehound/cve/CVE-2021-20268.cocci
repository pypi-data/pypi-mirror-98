/// Files: kernel/bpf/verifier.c
/// Fix: bc895e8b2a64e502fbba72748d59618272052a8b
/// Fixes: 3f50f132d8400e129fc9eb68b5020167ef80a244

virtual detect

@err_add32 exists@
typedef s64;
position p;
@@

* signed_add32_overflows@p(s64 a, s64 b)
{
	...
}

@err_sub exists@
typedef s32;
position p;
@@

* signed_sub_overflows@p(s32 a, s32 b)
{
	...
}

@script:python depends on detect@
p << err_add32.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-20268')

@script:python depends on detect@
p << err_sub.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-20268')
