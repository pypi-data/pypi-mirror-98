/// Files: drivers/usb/usbip/stub_tx.c drivers/staging/usbip/stub_tx.c
/// Fix: be6123df1ea8f01ee2f896a16c2b7be3e4557a5a
/// Fixes: 4d7b5c7f8ad49b7f01fb8aed83c560ac43cfbda8

virtual detect

@fix exists@
identifier urb;
@@

stub_send_ret_submit(...)
{
	... when any
	if (urb->actual_length > 0 && !urb->transfer_buffer && ...) {
		...
		return ...;
	}
	... when any
}

@err depends on !fix exists@
position p;
@@

* stub_send_ret_submit@p(...)
{
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-16914')
