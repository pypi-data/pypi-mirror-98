/// Files: fs/notify/inotify/inotify_user.c
/// Fix: 62c9d2674b31d4c8a674bee86b7edc6da2803aea
/// Fixes: 4d97f7d53da7dc830dbf416a3d2a6778d267ae68

virtual detect

@err exists@
identifier fsn_mark, group, inode;
position p;
@@

inotify_update_existing_watch(struct fsnotify_group *group,
			      struct inode *inode,
			      ...)
{
	...
	fsn_mark = fsnotify_find_mark(&inode->i_fsnotify_marks, group);
	if (!fsn_mark)
		return -ENOENT;
	else if (create)
*		return -EEXIST;@p
	...
	fsnotify_put_mark(fsn_mark);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-9857')
