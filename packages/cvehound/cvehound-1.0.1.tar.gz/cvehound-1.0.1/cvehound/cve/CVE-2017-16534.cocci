/// Files: drivers/usb/core/message.c drivers/net/usb/usbnet.c
/// Fix: 2e1c42391ff2556387b3cb6308b24f6f65619feb
/// Fixes: c40a2c8817e42273a4627c48c884b805475a733f

virtual detect

@err exists@
position p;
@@

cdc_parse_cdc_header(...)
{
	... when != if ((buflen < elength) || (elength < 3)) { ... break; }
*	if (buffer[1] !=@p USB_DT_CS_INTERFACE) {
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-16534')
