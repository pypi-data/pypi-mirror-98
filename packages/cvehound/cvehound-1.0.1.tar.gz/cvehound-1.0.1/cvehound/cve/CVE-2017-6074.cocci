/// Files: net/dccp/input.c
/// Fix: 5edabca9d4cff7f1f2b68f0bac55ef99d9798ba4
/// Detect-To: 7c657876b63cb1d8a2ec06f8fc6c37bb8412e66c

virtual detect

@err exists@
identifier sk, dh;
position p;
@@

dccp_rcv_state_process(struct sock *sk, ..., struct dccp_hdr *dh, ...)
{
	... when any
	if (dh->dccph_type == DCCP_PKT_REQUEST) {
		...
*		goto@p discard;
	}
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-6074')
