/// Files: net/netfilter/nf_conntrack_netlink.c
/// Fix: 1cc5ef91d2ff94d2bf2de3b3585423e8a1051cb6
/// Fixes: c1d10adb4a521de5760112853f42aaeefcec96eb

virtual detect

@err@
position p;
@@

\(ctnetlink_parse_tuple_filter\|ctnetlink_parse_tuple\)(...)
{
	... when != if (l3num != NFPROTO_IPV4 && l3num != NFPROTO_IPV6) return -EOPNOTSUPP;
*	tuple->src.l3num =@p l3num;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-25211")
