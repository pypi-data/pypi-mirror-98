/// Files: fs/cifs/smb2pdu.c
/// Fix: 6a3eb3360667170988f8a6477f6686242061488a
/// Fixes: eccb4422cf97a4b0daf97b3f3d68044514fea7bd

virtual detect

@err exists@
identifier rc, req;
position p;
@@

SMB2_write(...)
{
	... when any
	rc = \(smb2_send_recv\|cifs_send_recv\)(...);
*	cifs_small_buf_release@p(req);
	... when any
	req
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-15919')
