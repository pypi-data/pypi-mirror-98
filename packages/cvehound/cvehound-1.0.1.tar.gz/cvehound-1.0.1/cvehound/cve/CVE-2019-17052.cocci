/// Files: net/ax25/af_ax25.c
/// Fix: 0614e2b73768b502fc32a75349823356d98aae2c
/// Fixes: v2.6.12-rc2

virtual detect

@err exists@
identifier sock;
position p;
@@

ax25_create(..., struct socket *sock, ...)
{
	... when any
	switch (sock->type) {
	case SOCK_RAW:
		... when != if (!capable(CAP_NET_RAW)) return ...;
*		break;@p
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-17052')
