/// Files: drivers/net/mdio/mdio-bcm-unimac.c drivers/net/phy/mdio-bcm-unimac.c
/// Fix: 297a6961ffb8ff4dc66c9fbf53b924bd1dda05d5
/// Detect-To: 2ba1b163c9d5d716fb1061f3fb76832cc6eea37f

virtual detect

@err@
expression pdev, res, e;
position p;
@@

unimac_mdio_probe(...)
{
	...
*	res = platform_get_resource@p(pdev, ...);
	... when != res == NULL
	e = devm_ioremap(..., res->start, ...);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2018-8043")
