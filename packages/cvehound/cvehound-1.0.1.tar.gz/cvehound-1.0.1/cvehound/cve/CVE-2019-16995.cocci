/// Files: net/hsr/hsr_device.c
/// Fix: 6caabe7f197d3466d238f70915d65301f1716626
/// Fixes: c5a7591172100269e426cf630da0f2dc8138a206

virtual detect

@err exists@
identifier hsr_dev, res;
position p;
@@

hsr_dev_finalize(struct net_device *hsr_dev, ...)
{
	...
*	res = hsr_add_port(..., hsr_dev, HSR_PT_MASTER);
*	if (res)
*		return res;@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-16995')
