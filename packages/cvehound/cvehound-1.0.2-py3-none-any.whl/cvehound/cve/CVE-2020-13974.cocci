/// Files: drivers/tty/vt/keyboard.c drivers/char/keyboard.c
/// Fix: b86dab054059b970111b5516ae548efaae5b3aae
/// Fixes: v2.6.12-rc2

virtual detect

@var_npadch@
identifier npadch;
@@

int npadch = -1;

@err exists@
identifier value, base;
identifier var_npadch.npadch;
position p;
@@

k_ascii(..., unsigned char value, ...)
{
	... when != npadch = 0;
*	npadch = npadch * base + value;@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-13974')
