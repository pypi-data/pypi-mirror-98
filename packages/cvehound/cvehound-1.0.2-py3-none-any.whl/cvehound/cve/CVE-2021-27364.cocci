/// Files: drivers/scsi/scsi_transport_iscsi.c
/// Fix: 688e8128b7a92df982709a4137ea4588d16f24aa
/// Fixes: 0896b752302662909b52895bd7f601136001069d

virtual detect

@err exists@
position p;
@@

iscsi_if_recv_msg(struct sk_buff *skb, ...)
{
	... when != if (!netlink_capable(skb, CAP_SYS_ADMIN)) return -EPERM;
*	iscsi_if_transport_lookup@p(...)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-27364')
