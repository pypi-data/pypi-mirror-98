/// Files: arch/x86/kvm/ioapic.c
/// Fix: 77377064c3a94911339f13ce113b3abf265e06da
/// Fixes: f458d039db7e8518041db4169d657407e3217008

virtual detect

@err@
position p;
iterator name kvm_for_each_vcpu;
@@

ioapic_lazy_update_eoi(...)
{
	...
	kvm_for_each_vcpu(...) {
		...
		rtc_irq_eoi(...);
*		kvm_ioapic_update_eoi_one@p(...);
		break;
	}
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-27152")
