/// Files: drivers/input/keyboard/sunkbd.c
/// Fix: 77e70d351db7de07a46ac49b87a6c3c7a60fca7e
/// Detect-To: 3c42f0c3dde8feb59fc87df45cadb847d5511c0a

virtual detect

@err_sunkbd_enable@
identifier sunkbd, enable;
@@

sunkbd_enable(struct sunkbd *sunkbd, ...)
{
	...
	sunkbd->enabled = ...;
	... when exists
	    when != cancel_work_sync(&sunkbd->tq);
}

@err_sunkbd_interrupt depends on err_sunkbd_enable@
position p;
@@

sunkbd_interrupt(...)
{
	...
	switch (...) {
	case SUNKBD_RET_RESET:
		...
*		schedule_work(&sunkbd->tq);@p
		sunkbd->reset = -1;
		break;
	}
	...
}

@script:python depends on detect@
p << err_sunkbd_interrupt.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-25669")
