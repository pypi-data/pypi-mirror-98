/// Files: net/ieee802154/socket.c
/// Fix: e69dbd4619e7674c1679cba49afd9dd9ac347eef
/// Fixes: 9ec7671603573ede31207eb5b0b3e1aa211b2854

virtual detect

@err exists@
identifier sock;
statement S;
position p;
@@

ieee802154_create(..., struct socket *sock, ...)
{
	... when any
	switch (sock->type) {
	case SOCK_RAW:@p
		... when != if (!capable(CAP_NET_RAW)) S
*		break;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-17053')
