/// Files: net/packet/af_packet.c
/// Fix: 2b6867c2ce76c596676bec7d2d525af525fdc6e2
/// Detect-To: dc808110bb62b64a448696ecac3938902c92e1ab

virtual detect

@err exists@
position p;
@@

packet_set_ring(...)
{
	...
*	if (po->tp_version >= TPACKET_V3 &&@p
*		    (int)(req->tp_block_size -
*			  BLK_PLUS_PRIV(req_u->req3.tp_sizeof_priv)) <= 0)
		goto out;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-7308')
