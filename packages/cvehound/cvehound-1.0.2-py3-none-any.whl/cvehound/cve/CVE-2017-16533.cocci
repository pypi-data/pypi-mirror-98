/// Files: drivers/hid/usbhid/hid-core.c drivers/usb/input/hid-core.c
/// Fix: f043bfc98c193c284e2cd768fefabe18ac2fed9b
/// Fixes: v2.6.12-rc2

virtual detect

@err exists@
position p;
@@

* \(usbhid_parse@p\|usb_hid_configure@p\)(...)
{
	... when != if (hdesc->bLength < sizeof(struct hid_descriptor)) { ... return -EINVAL; }
	    when any
	if (hdesc->desc[n].bDescriptorType == HID_DT_REPORT)
		rsize = le16_to_cpu(hdesc->desc[n].wDescriptorLength);
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-16533')
