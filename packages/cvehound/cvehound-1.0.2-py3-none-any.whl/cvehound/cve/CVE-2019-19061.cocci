/// Files: drivers/iio/imu/adis_buffer.c
/// Fix: 9c0530e898f384c5d279bfcebd8bb17af1105873
/// Detect-To: 0e92e2d036232da1543599dc9b7acc1ce4289d1b

virtual detect

@err@
identifier adis;
position p;
@@

adis_update_scan_mode_burst(...)
{
	...
	adis->buffer = kzalloc(...);
*	if (!adis->buffer)@p
		return -ENOMEM;
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2019-19061")
