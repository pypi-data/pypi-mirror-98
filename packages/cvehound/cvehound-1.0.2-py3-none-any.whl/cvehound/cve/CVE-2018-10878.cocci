/// Files: fs/ext4/balloc.c
/// Fix: 819b23f1c501b17b9694325471789e6b5cc2d0d2
/// Detect-To: 0bf7e8379ce7e0159a2a6bd3d937f2f6ada79799

virtual detect

@err exists@
identifier sb, flex_bg;
position p;
@@

ext4_init_block_bitmap(struct super_block *sb, ...)
{
	...
*	int flex_bg@p = 0;
	...
(
	if (ext4_has_feature_flex_bg(sb))
		flex_bg = 1;
|
	if (EXT4_HAS_INCOMPAT_FEATURE(sb, EXT4_FEATURE_INCOMPAT_FLEX_BG))
		flex_bg = 1;
)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-10878')
