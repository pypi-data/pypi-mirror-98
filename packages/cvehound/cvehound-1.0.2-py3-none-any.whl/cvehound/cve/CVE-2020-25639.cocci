/// Files: drivers/gpu/drm/nouveau/nouveau_chan.c
/// Fix: eaba3b28401f50e22d64351caa8afe8d29509f27
/// Fixes: eeaf06ac1a5584e41cf289f8351e446bb131374b

virtual detect

@err exists@
identifier pchan, ret, done;
position p;
@@

nouveau_channel_new(..., struct nouveau_channel **pchan)
{
	...
	ret = nouveau_channel_init(*pchan, ...);
*	if (ret) {
*		...
*		nouveau_channel_del@p(pchan);
*		... when != goto done;
*	}
	...
	ret = nouveau_svmm_join(...);
	...
done:
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-25639')
