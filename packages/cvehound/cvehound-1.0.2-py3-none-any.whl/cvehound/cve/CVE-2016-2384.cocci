/// Files: sound/usb/midi.c
/// Fix: 07d86ca93db7e5cdf4743564d98292042ec21af7
/// Fixes: v2.6.12-rc2

virtual detect

@err exists@
identifier umidi;
position p;
@@

\(snd_usbmidi_create\|snd_usb_create_midi_interface\)(...)
{
	...
	snd_usbmidi_create_rawmidi(umidi, ...)
	...
*	snd_usbmidi_free(umidi)@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-2384')
