/// Files: drivers/powercap/powercap_sys.c
/// Fix: 949dd0104c496fa7c14991a23c03c62e44637e71
/// Fixes: 95677a9a3847de4f37e0f463aeb94aa8d5cccc50

virtual detect

@err_reset_energy_uj@
position p;
@@

create_power_zone_common_attributes(...)
{
	...
*	dev_attr_energy_uj.attr.mode = S_IWUSR | S_IRUGO;@p
	...
}

@err@
position p;
@@

create_power_zone_common_attributes(...)
{
	...
*	dev_attr_energy_uj.attr.mode = S_IRUGO;@p
	...
}

@script:python depends on detect@
p << err_reset_energy_uj.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-8694")

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-8694")
