/// Files: mm/slub.c
/// Fix: fd4d9c7d0c71866ec0c2825189ebd2ce35bd95b8
/// Fixes: ebe909e0fdb34b980c5cf636c495e4f0bb0dfda8

virtual detect

@err exists@
identifier object, c;
position p;
@@

kmem_cache_alloc_bulk(...)
{
	... when any
	void *object = c->freelist;
	if (unlikely(!object)) {
		... when != c->tid = next_tid(c->tid);
*		\(___slab_alloc@p\|__slab_alloc@p\)(...)
		...
	}
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-29370')
