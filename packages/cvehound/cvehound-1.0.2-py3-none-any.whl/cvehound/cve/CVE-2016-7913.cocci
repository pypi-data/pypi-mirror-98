/// Files: drivers/media/tuners/tuner-xc2028.c drivers/media/common/tuners/tuner-xc2028.c
/// Fix: 8dfbcc4351a0b6d2f2d77f367552f48ffefafe18
/// Detect-To: 61a96113de51e1f8f43ac98cbeadb54e60045905

virtual detect

@err exists@
identifier p, priv, ctrl, rc;
position pos;
@@

xc2028_set_config(...)
{
	...
	if (p->fname) {
		priv->ctrl.fname = kstrdup(p->fname, GFP_KERNEL);
		if (priv->ctrl.fname == NULL)
*			rc =@pos -ENOMEM;
	}
	...
}

@script:python depends on detect@
p << err.pos;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-7913')
