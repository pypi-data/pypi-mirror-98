/// Files: mm/hugetlb.c kernel/sysctl.c
/// Fix: 17743798d81238ab13050e8e2833699b54e15467
/// Fixes: e5ff215941d59f8ae6bf58f6428dc5c26745a612

virtual detect

@minmax@
identifier table;
@@

do_proc_doulongvec_minmax(struct ctl_table *table, ...)
{
	...
(
*	table->data = ...;
|
*	__do_proc_doulongvec_minmax(table->data, ...)
)
	...
}

@err depends on minmax exists@
identifier table;
position p;
@@

\(hugetlb_sysctl_handler_common\|hugetlb_overcommit_handler\)(..., struct ctl_table *table, ...)
{
	...
*	table->data@p = ...;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-25285')
