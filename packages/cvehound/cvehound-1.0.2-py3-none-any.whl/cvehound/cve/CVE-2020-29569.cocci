/// Files: drivers/block/xen-blkback/xenbus.c
/// Fix: 1c728719a4da6e654afb9cc047164755072ed7c9
/// Fixes: a24fa22ce22ae302b3bf8f7008896d52d5d57b8d

virtual detect

@err exists@
position p;
identifier ring;
@@

xen_blkif_disconnect(...)
{
	... when any
	if (ring->xenblkd) {
*		kthread_stop(ring->xenblkd);@p
		... when != ring->xenblkd = NULL;
		wake_up(&ring->shutdown_wq);
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-29569')
