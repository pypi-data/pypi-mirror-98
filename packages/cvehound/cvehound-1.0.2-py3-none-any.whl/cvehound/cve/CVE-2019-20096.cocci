/// Files: net/dccp/feat.c
/// Fix: 1d3ff0950e2b40dc861b1739029649d03f591820
/// Fixes: e8ef967a54f401ac5e8637b7f7f8bddb006144c4

virtual detect

@kmemdup_alloc exists@
//identifier fval, val, len;
//typedef u8, dccp_feat_val; Cocci 1.04 doesn't support typedefs
position p;
@@

//dccp_feat_clone_sp_val(dccp_feat_val *fval, u8 *val, u8 len)
dccp_feat_clone_sp_val(...)
{
	...
*	fval->sp.vec =@p kmemdup(val, len, ...);
	...
}

@err depends on kmemdup_alloc exists@
identifier fn, fval;
position p;
@@

__feat_register_sp(struct list_head *fn, ...)
{
	...
	dccp_feat_clone_sp_val(&fval, ...)
	...
*	return dccp_feat_push_change@p(fn, ..., &fval);
}

@script:python depends on detect@
pa << kmemdup_alloc.p;
pe << err.p;
@@

coccilib.report.print_report(pe[0], 'ERROR: CVE-2019-20096')
coccilib.report.print_report(pa[0], 'ERROR: CVE-2019-20096')
