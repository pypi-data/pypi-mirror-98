/// Files: drivers/staging/android/ashmem.c
/// Fix: 6d67b0290b4b84c477e6a2fc6e005e174d3c7786
/// Fixes: 11980c2ac4ccfad21a5f8ee9e12059f1e687bb40

virtual detect

@fix exists@
@@

ashmem_mmap(...)
{
	...
	if (!vmfile_fops.mmap) {
		...
		vmfile_fops = *vmfile->f_op;
		...
		vmfile_fops.mmap = ...;
		...
		vmfile_fops.get_unmapped_area = ...;
		...
	}
	...
	vmfile->f_op = &vmfile_fops;
	...
}

@err depends on !fix exists@
position p;
@@

* ashmem_mmap@p(...)
{
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-0009')
