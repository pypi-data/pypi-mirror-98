/// Files: net/xfrm/xfrm_user.c
/// Fix: b805d78d300bcf2c83d6df7da0c818b0fee41427
/// Fixes: e682adf021be796940be6cc10c07be7f7398c220

virtual detect

@err exists@
identifier p;
position pos;
@@

verify_newpolicy_info(struct xfrm_userpolicy_info *p)
{
	...
*	if (p->index && ((p->index & XFRM_POLICY_MAX) != p->dir))@pos
		return -EINVAL;
	...
}

@script:python depends on detect@
p << err.pos;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-15666')
