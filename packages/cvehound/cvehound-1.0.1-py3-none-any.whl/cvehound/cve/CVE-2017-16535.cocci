/// Files: drivers/usb/core/config.c
/// Fix: 1c0edc3633b56000e18d82fc241e3995ca18a69e
/// Fixes: 3148bf041d169a083aa31bd69bedd5bfb7ffe215

virtual detect

@err exists@
position p;
@@

usb_get_bos_descriptor(...)
{
	... when != if (total_len < sizeof(*cap) || total_len < cap->bLength) { ... break; }
*	length =@p cap->bLength;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-16535')
