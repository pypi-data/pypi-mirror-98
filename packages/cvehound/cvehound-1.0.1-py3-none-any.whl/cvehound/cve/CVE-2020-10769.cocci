/// Files: crypto/authenc.c
/// Fix: 8f9c469348487844328e162db57112f7d347c49f
/// Fixes: e236d4a89a2ffbc8aa18064161f4f159c4d89b4a

virtual detect

@err exists@
identifier rta, param, key, keylen;
statement S;
position p;
@@

\(crypto_authenc_extractkeys\|crypto_authenc_setkey\)(...,
	u8 *key, unsigned int keylen)
{
	...
*	if (RTA_PAYLOAD(rta) < sizeof(*param))@p S
	...
// TODO: uncomment. cocc 1.08 fails to parse key += REA_ALIGN(...);
//	key += RTA_ALIGN(rta->rta_len);
//	keylen -= RTA_ALIGN(rta->rta_len);
//	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-10769')
