/// Files: net/appletalk/ddp.c
/// Fix: 6cc03e8aa36c51f3b26a0d21a3c4ce2809c842ac
/// Fixes: v2.6.12-rc2

virtual detect

@err@
identifier sock;
statement S;
position p;
@@

atalk_create(..., struct socket *sock, ...)
{
	... when != if (sock->type == SOCK_RAW && ... && !capable(CAP_NET_RAW)) S
*	sk_alloc@p(...)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-17054')
