/// Files: mm/hugetlb.c
/// Fix: 5af10dfd0afc559bb4b0f7e3e8227a1578333995
/// Detect-To: 1c9e8def43a3452e7af658b340f5f4f4ecde5c38

virtual detect

@err exists@
position p;
@@

hugetlb_mcopy_atomic_pte(...)
{
	...
out_release_nounlock:
	...
* 	if (vm_shared)@p
* 		unlock_page(page);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-15127')
