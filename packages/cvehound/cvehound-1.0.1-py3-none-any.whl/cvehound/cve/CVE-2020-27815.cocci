/// Files: fs/jfs/jfs_dmap.h fs/jfs/jfs_dmap.c
/// Fix: c61b3e4839007668360ed8b87d7da96d2e59fc6c
/// Detect-To: v2.6.12-rc2

virtual detect

@err_define exists@
position p;
@@

* #define dmt_stree@p t1.stree

@err_dbAdjTree depends on err_define exists@
identifier tp, i;
assignment operator aop;
position p;
@@

dbAdjTree(...)
{
	...
(
*	tp->dmt_stree[i] aop@p ...
|
*	&tp->dmt_stree[i]@p
)
	...
}

@script:python depends on detect@
pd << err_define.p;
pf << err_dbAdjTree.p;
@@

coccilib.report.print_report(pd[0], 'ERROR: CVE-2020-27815')
coccilib.report.print_report(pf[0], 'ERROR: CVE-2020-27815')
