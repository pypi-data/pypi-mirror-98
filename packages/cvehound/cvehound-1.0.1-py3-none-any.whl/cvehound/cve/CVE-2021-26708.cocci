/// Files: net/vmw_vsock/af_vsock.c
/// Fix: c518adafa39f37858697ac9309c6cf1805581446
/// Fixes: c0cfa2d8a788fcf45df5bf4070ab2474c88d543a

virtual detect

@vsock_assign_transport@
@@

vsock_assign_transport(...)
{
	...
}

@err depends on vsock_assign_transport exists@
position p;
@@

(
*	transport =@p vsk->transport;
|
*	struct vsock_transport *transport =@p vsk->transport;
)
	... when != release_sock(sk)
	lock_sock(sk);

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-26708')
