/// Files: kernel/exit.c
/// Fix: 96ca579a1ecc943b75beba58bebb0356f6cc4b51
/// Fixes: 4c48abe91be03d191d0c20cc755877da2cb35622

virtual detect

@err exists@
identifier infop;
position p;
@@

	// coccinelle fails to recognize COMPAT_SYSCALL_DEFINE5
	... when != access_ok(..., infop, sizeof(*infop))
*	user_access_begin()@p;
*	unsafe_put_user(..., &infop->si_signo, ...);

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-5123')
