/// Files: mm/mempolicy.c
/// Fix: 73223e4e2e3867ebf033a5a8eb2e5df0158ccc99
/// Detect-To: v2.6.12-rc2

virtual detect

@err exists@
position p;
@@

\(sys_get_mempolicy\|do_get_mempolicy\)(...)
{
	...
*	if (vma) {
*		up_read@p(&current->mm->mmap_sem);
*		vma = NULL;
*	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-10675')
