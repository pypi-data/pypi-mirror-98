/// Files: drivers/net/ethernet/intel/fm10k/fm10k_main.c
/// Fix: 01ca667133d019edc9f0a1f70a272447c84ec41f
/// Detect-To: b382bb1b3e2d498ee7ce8976afa7737d407a4f11

virtual detect

@err exists@
identifier fm10k_workqueue;
position p;
statement S;
@@

fm10k_init_module(...)
{
	...
*	fm10k_workqueue =@p \(create_workqueue\|alloc_workqueue\)(...);
	... when != if (!fm10k_workqueue) S
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-15924')
