/// Files: drivers/block/rbd.c
/// Fix: f44d04e696feaf13d192d942c4f14ad2e117065a
/// Detect-To: dfc5606dc51381186de765243bab340c8e021868

virtual detect

@err_rbd_config_info_show exists@
position p;
@@

* \(rbd_config_info_show@p\|rbd_image_refresh@p\|do_rbd_add@p\|do_rbd_remove@p\)(...)
{
	... when != if (!capable(CAP_SYS_ADMIN)) return -EPERM;
}

@script:python depends on detect@
p << err_rbd_config_info_show.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-25284")
