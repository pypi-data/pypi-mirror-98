/// Files: arch/powerpc/kernel/rtas.c arch/ppc64/kernel/rtas.c
/// Fix: bd59380c5ba4147dcbaad3e582b55ccfd120b764
/// Detect-To: v2.6.12-rc2

virtual detect

@fix@
@@

block_rtas_call(...)
{
	...
}

@stub@
position p;
@@

static inline void rtas_initialize@p(void) { }

@err depends on !fix exists@
position p != stub.p;
@@

* rtas_initialize@p(void)
{
	... when != rtas_filters
	    when any
}

@script:python depends on detect && !fix@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-27777')
