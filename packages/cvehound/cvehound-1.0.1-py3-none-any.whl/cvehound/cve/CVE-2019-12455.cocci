/// Files: drivers/clk/sunxi/clk-sunxi.c
/// Fix: fcdf445ff42f036d22178b49cf64e92d527c1330
/// Detect-To: ff2bb89335daec6053b5ac778369f7f72b931142

virtual detect

@err exists@
identifier factors;
position p;
@@

sunxi_divs_clk_setup(...)
{
	...
*	derived_name = kstrndup(clk_name, ...);@p
	... when != if (!derived_name) return NULL;
*	factors.name = derived_name;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-12455')
