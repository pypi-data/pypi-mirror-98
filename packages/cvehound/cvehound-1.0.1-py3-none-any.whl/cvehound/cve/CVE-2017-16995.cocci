/// Files: kernel/bpf/verifier.c
/// Fix: 95a762e2c8c942780948091f8f2a4f32fce1ac6f
/// Fixes: 484611357c19f9e19ef742ebef4505a07d243cc9

virtual detect

@err exists@
position p;
@@

check_alu_op(...)
{
	...
	regs[insn->dst_reg].type = \(CONST_IMM\|SCALAR_VALUE\);
(
*	__mark_reg_known@p(regs + insn->dst_reg, insn->imm);
|
	...
*	regs[insn->dst_reg].max_value =@p insn->imm;
*	regs[insn->dst_reg].min_value = insn->imm;
)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-16995')
