/// Files: drivers/isdn/mISDN/socket.c
/// Fix: b91ee4aa2a2199ba4d4650706c272985a5a32d80
/// Fixes: 1b2b03f8e514e4f68e293846ba511a948b80243c

virtual detect

@err exists@
position p;
@@

* base_sock_create@p(...)
{
	... when != if (!capable(CAP_NET_RAW)) return ...;
	sk_alloc(...) // FIX: coccinelle doens't match a pattern without this
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-17055')
