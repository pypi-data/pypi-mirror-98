/// Files: net/nfc/llcp_sock.c net/nfc/llcp/sock.c
/// Fix: 3a359798b176183ef09efb7a3dc59abad1cc7104
/// Fixes: 4463523bef98ff827a89cf8219db7dfac4350241

virtual detect

@err exists@
identifier sock;
position p;
statement S;
@@

llcp_sock_create(..., struct socket *sock, ...)
{
	...
*	if (sock->type ==@p SOCK_RAW) {
		... when != if (!capable(CAP_NET_RAW)) return ...;
*		sock->ops = &llcp_rawsock_ops;
	} else S // FIX: Doesn't work without else branch
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-17056')
