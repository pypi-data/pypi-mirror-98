/// Files: drivers/cdrom/cdrom.c
/// Fix: 8f3fafc9c2f0ece10832c25f7ffcb07c97a32ad4
/// Fixes: v2.6.12-rc2

virtual detect

@err exists@
identifier cdi, arg;
position p;
@@

\(cdrom_ioctl\|cdrom_ioctl_drive_status\)(...,
	struct cdrom_device_info *cdi,
	...,
	unsigned long arg,
	...)
{
	... when any
*	if (((int)arg >= cdi->capacity))@p
 		return -EINVAL;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-16658')
