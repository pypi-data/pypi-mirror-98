/// Files: drivers/crypto/ccp/ccp-ops.c
/// Fix: 128c66429247add5128c03dc1e144ca56f05a4e2
/// Fixes: 4b394a232df78414442778b02ca4a388d947d059

virtual detect

@err exists@
position p;
@@

ccp_run_sha_cmd(...)
{
	...
	if (sha->final && sha->opad) {
		...
		switch (sha->type) {
		default:
			ret = -EINVAL;
*			goto e_ctx;@p
		}
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2019-18808")
