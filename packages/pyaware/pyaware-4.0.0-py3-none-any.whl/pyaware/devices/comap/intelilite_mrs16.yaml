sources:
  poll_holding:
    type: poll
    poll_interval: 5
    handle: holding
    blocks:
      - [1046, 1047]
      - [1048, 1050]
      - [1256, 1257]
      - [1258, 1263]
      - [1272, 1274]
      - [1276, 1279]
      - [1287, 1289]
      - [3020, 3021]
      - [3028, 3029]
      - [3044, 3045]
      - [3048, 3049]
      - [3082, 3083]
      - [3087, 3092]
      - [3093, 3103]
      - [3367, 3368]
      - [3412, 3413]
      - [4207, 4209]
  poll_coils:
    type: poll
    poll_interval: 5
    handle: coils
    blocks:
      - [0, 4]
      - [6, 7]
      - [20, 21]
      - [67, 69]
      - [70, 71]
      - [85, 99]
  write_only_holding:
    type: write_only
    handle: holding
    blocks:
      - [4209, 4210]
parameters:
  emergency-stop:
    source: poll_coils
    form:
      type: ParamCType
      address: 0
      idx: emergency-stop
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  remote-start-stop:
    source: poll_coils
    form:
      type: ParamCType
      address: 1
      idx: remote-start-stop
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  low-oil-level:
    source: poll_coils
    form:
      type: ParamCType
      address: 2
      idx: low-oil-level
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  low-coolant-level:
    source: poll_coils
    form:
      type: ParamCType
      address: 3
      idx: low-coolant-level
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  fault-reset-button:
    source: poll_coils
    form:
      type: ParamCType
      address: 6
      idx: fault-reset-button
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
  alarm:
    source: poll_coils
    form:
      type: ParamCType
      address: 20
      idx: alarm
      data_type: bool
    triggers:
      process:
        store:
          - [ always ]
        event:
          - [ state ]
    metadata:
      kind: alarm
  sd-overspeed:
    source: poll_coils
    form:
      type: ParamCType
      address: 67
      idx: sd-overspeed
      data_type: bool
    triggers:
      process:
        store:
          - [always]
        event:
          - [state]
  sd-underspeed:
    source: poll_coils
    form:
      type: ParamCType
      address: 68
      idx: sd-underspeed
      data_type: bool
    triggers:
      process:
        store:
          - [always]
        event:
          - [state]
  sd-battery-flat:
    source: poll_coils
    form:
      type: ParamCType
      address: 70
      idx: sd-battery-flat
      data_type: bool
    triggers:
      process:
        store:
          - [always]
        event:
          - [state]
  wrn-generator-overfrequency:
    source: poll_coils
    form:
      type: ParamCType
      address: 85
      idx: wrn-generator-overfrequency
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  sd-generator-overfrequency:
    source: poll_coils
    form:
      type: ParamCType
      address: 86
      idx: sd-generator-overfrequency
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  wrn-generator-underfrequency:
    source: poll_coils
    form:
      type: ParamCType
      address: 87
      idx: wrn-generator-underfrequency
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  sd-generator-underfrequency:
    source: poll_coils
    form:
      type: ParamCType
      address: 88
      idx: sd-generator-underfrequency
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  wrn-overload:
    source: poll_coils
    form:
      type: ParamCType
      address: 89
      idx: wrn-overload
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  sd-overload:
    source: poll_coils
    form:
      type: ParamCType
      address: 90
      idx: sd-overload
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  short-circuit:
    source: poll_coils
    form:
      type: ParamCType
      address: 92
      idx: short-circuit
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  sd-earth-fault-current:
    source: poll_coils
    form:
      type: ParamCType
      address: 94
      idx: sd-earth-fault-current
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  generator-l1-overvoltage:
    source: poll_coils
    form:
      type: ParamCType
      address: 95
      idx: generator-l1-overvoltage
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  generator-l1-undervoltage:
    source: poll_coils
    form:
      type: ParamCType
      address: 96
      idx: generator-l1-undervoltage
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  sd-start-fail:
    source: poll_coils
    form:
      type: ParamCType
      address: 97
      idx: sd-start-fail
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  wrn-stop-fail:
    source: poll_coils
    form:
      type: ParamCType
      address: 98
      idx: wrn-stop-fail
      data_type: bool
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
        event:
          - [state]
  battery-voltage:
    source: poll_holding
    form:
      type: ParamCType
      address: 1046
      idx: battery-voltage
      data_type: short
    triggers:
      process:
        store:
          - [always]
  oil-pressure:
    source: poll_holding
    form:
      type: ParamCType
      address: 1048
      idx: oil-pressure
      data_type: short
    triggers:
      process:
        store:
          - [always]
  coolant-temp:
    source: poll_holding
    form:
      type: ParamCType
      address: 1049
      idx: coolant-temp
      data_type: short
    triggers:
      process:
        store:
          - [always]
  fuel-level:
    source: poll_holding
    form:
      type: ParamCType
      address: 1256
      idx: fuel-level
      data_type: short
    triggers:
      process:
        store:
          - [always]
        send:
          - [time, 60]
  total-fuel-consumption:
    source: poll_holding
    form:
      type: ParamCType
      address: 1258
      idx: total-fuel-consumption
      data_type: uint
    triggers:
      process:
        store:
          - [always]
        send:
          - [time, 60]
  running-hours:
    source: poll_holding
    form:
      type: ParamCType
      address: 1260
      idx: running-hours
      data_type: int
    triggers:
      process:
        send:
          - [time, 60]
  num-starts:
    source: poll_holding
    form:
      type: ParamCType
      address: 1262
      idx: num-starts
      data_type: ushort
    triggers:
      process:
        send:
          - [time, 60]
  total-positive-energy:
    source: poll_holding
    form:
      type: ParamCType
      address: 1272
      idx: total-positive-energy
      data_type: int
    triggers:
      process:
        store:
          - [always]
  time-till-empty-days:
    source: poll_holding
    form:
      type: ParamCType
      address: 1276
      idx: time-till-empty-days
      data_type: short
    triggers:
      process:
        store:
          - [always]
  time-till-empty-hrs:
    source: poll_holding
    form:
      type: ParamCType
      address: 1277
      idx: time-till-empty-hrs
      data_type: short
    triggers:
      process:
        store:
          - [always]
  time-till-empty-mins:
    source: poll_holding
    form:
      type: ParamCType
      address: 1278
      idx: time-till-empty-mins
      data_type: short
    triggers:
      process:
        store:
          - [always]
  engine-state:
    source: poll_holding
    form:
      type: ParamLookup
      address: 1287
      idx: engine-state
      table:
        1: "Init"
        2: "Not Ready"
        3: "PreStart"
        4: "Cranking"
        5: "Pause"
        6: "Starting"
        7: "Running"
        8: "Loaded"
        9: "Stop"
        10: "Shutdown"
        11: "Ready"
        12: "Cooling"
        13: "EmergMan"
      table_reversed:
        "Init": 1
        "Not Ready": 2
        "PreStart": 3
        "Cranking": 4
        "Pause": 5
        "Starting": 6
        "Running": 7
        "Loaded": 8
        "Stop": 9
        "Shutdown": 10
        "Ready": 11
        "Cooling": 12
        "EmergMan": 13
    triggers:
      process:
        store:
          - [always]
        send:
          - [state]
          - [time, 60]
  breaker-state:
    source: poll_holding
    form:
      type: ParamLookup
      address: 1288
      idx: breaker-state
      table:
        0: "Brakes On"
        1: "Brakes Off"
      table_reversed:
        "Brakes On": 0
        "Brakes Off": 1
    triggers:
      process:
        store:
          - [always]
        send:
          - [state]
          - [time, 60]
  controller-mode:
    source: poll_holding
    form:
      type: ParamLookup
      address: 3020
      idx: controller-mode
      table:
        0: "OFF"
        1: "MAN"
        2: "AUTO"
      table_reversed:
        "OFF": 0
        "MAN": 1
        "AUTO": 2
    triggers:
      process:
        send:
          - [state]
          - [time, 60]
  cranking-attempts-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3028
      idx: cranking-attempts-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  stop-time-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3044
      idx: stop-time-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  overspeed-sd-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3048
      idx: overspeed-sd-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  battery-charger-fail-delay-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3082
      idx: battery-charger-fail-delay-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  overload-sd-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3087
      idx: overload-sd-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  overload-wrn-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3088
      idx: overload-wrn-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  overload-delay-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3089
      idx: overload-delay-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  short-circuit-sd-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3090
      idx: short-circuit-sd-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  short-circuit-sd-delay-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3091
      idx: short-circuit-sd-delay-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  generator-overvoltage-sd-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3093
      idx: generator-overvoltage-sd-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  generator-overvoltage-wrn-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3094
      idx: generator-overvoltage-wrn-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  generator-undervoltage-wrn-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3095
      idx: generator-undervoltage-wrn-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  generator-undervoltage-sd-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3096
      idx: generator-undervoltage-sd-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  generator-over-under-voltage-delay-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3097
      idx: generator-over-under-voltage-delay-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  generator-overfrequency-sd-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3098
      idx: generator-overfrequency-sd-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  generator-overfrequency-wrn-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3099
      idx: generator-overfrequency-wrn-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  generator-underfrequency-wrn-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3100
      idx: generator-underfrequency-wrn-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  generator-underfrequency-sd-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3101
      idx: generator-underfrequency-sd-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  generator-over-under-frequency-delay-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3102
      idx: generator-over-under-frequency-delay-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  earth-fault-delay-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3367
      idx: earth-fault-delay-setpoint
      data_type: short
    triggers:
      process:
        store:
          - [always]
  underspeed-sd-setpoint:
    source: poll_holding
    form:
      type: ParamCType
      address: 3412
      idx: underspeed-sd-setpoint
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  command-argument-register:
    source: poll_holding
    form:
      type: ParamCType
      address: 4207
      word_order: <
      idx: command-argument-register
      data_type: uint
    triggers:
      process:
        store:
          - [always]
  command-code-register:
    source: write_only_holding
    form:
      type: ParamCType
      address: 4209
      idx: command-code-register
      data_type: ushort
    triggers:
      process:
        store:
          - [always]
  modbus-comms-status:
    source: status
    triggers:
      process:
        event:
          - [state]
        send:
          - [state]
          - [time, 60]