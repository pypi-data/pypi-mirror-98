var clockTarget=0;var clockTickId=0;var countdownIntervalId=0;function showAdjust(){jQuery("#btnadjust").addClass("hidden");jQuery("#adjust").removeClass("hidden");var mom=moment.tz(new Date,"Etc/UTC");jQuery("#tathour").val(mom.format("HH"));jQuery("#tatminute").val(mom.format("mm"));jQuery("#tatday").val(mom.format("DD"));jQuery("#tatmonth").val(mom.format("MM"));jQuery("#tatyear").val(mom.format("YYYY"))}function reloadToTimestamp(){var timestamp=parseInt((new Date).getTime()/1e3)+jQuery("#tind").val()*24*60*60+jQuery("#tinh").val()*60*60+jQuery("#tinm").val()*60;window.location.replace(aaTimezonesOptions.base_url+timestamp)}function reloadBasePage(){window.location.replace(aaTimezonesOptions.base_url)}function setdate(str,tz){if(tz!==""){window.location.replace(aaTimezonesOptions.base_url+moment.tz(str,tz).unix())}else{window.location.replace(aaTimezonesOptions.base_url+moment(str).unix())}}function updatePanel(mom,id){jQuery("#time-"+id).html(mom.format("HH:mm:ss"));jQuery("#utc-offset-"+id).html("(UTC "+mom.format("Z")+")");jQuery("#date-"+id).html(mom.format("dddd DD MMM YYYY"));jQuery("#icon-"+id).removeClass();var h=mom.format("H")*1;var icon="wi wi-night-clear";if(h<23){icon="wi wi-moonrise"}if(h<20){icon="wi wi-sunset"}if(h<17){icon="wi wi-day-sunny"}if(h<14){icon="wi wi-day-sunny"}if(h<11){icon="wi wi-day-sunny"}if(h<9){icon="wi wi-sunrise"}if(h<6){icon="wi wi-moonset"}if(h<3){icon="wi wi-night-clear"}jQuery("#icon-"+id).addClass(icon)}function updatePanels(now){updatePanel(moment(now),"local-time");jQuery.each(aaTimezonesPanels,function(index,value){updatePanel(moment.tz(now,value.timezoneName),value.timezoneId)})}function timeUntil(timestamp){var timestampDifference=timestamp-Date.now();var timeDifferenceInSeconds=timestampDifference/1e3;countdownIntervalId=setInterval(function(){timeDifferenceInSeconds--;if(timeDifferenceInSeconds>=0){var days=Math.floor(timeDifferenceInSeconds/(24*60*60));var hours=Math.floor(timeDifferenceInSeconds/(60*60))%24;var minutes=Math.floor(timeDifferenceInSeconds/60)%60;var seconds=Math.floor(timeDifferenceInSeconds/1)%60;if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}var countdown=days+" "+aaTimezonesTranslations.days+", "+hours+":"+minutes+":"+seconds}else{var countdown=aaTimezonesTranslations.alreadyOver}$(".aa-timezones-time-until-countdown").html(countdown)},1e3)}function clockTick(){updatePanels(new Date)}function switchto(mode){if(clockTickId!==0){clearInterval(clockTickId)}if(countdownIntervalId!==0){clearInterval(countdownIntervalId)}$(".aa-timezones-time-until-countdown").html("");if(mode===0){jQuery("#headlineCurrent").removeClass("hidden");jQuery("#headlineFixed").addClass("hidden");jQuery("#adjust").addClass("hidden");jQuery("#btnadjust").removeClass("hidden");jQuery("#btnshowcurrent").addClass("hidden");jQuery(".aa-timezones-time-until").addClass("hidden");if(clockTarget!==0){jQuery("#btnshowfixed").removeClass("hidden")}jQuery("#btnclear").addClass("hidden");clockTickId=setInterval(clockTick,1e3);clockTick()}else{jQuery("#headlineCurrent").addClass("hidden");jQuery("#headlineFixed").removeClass("hidden");jQuery("#adjust").addClass("hidden");jQuery("#btnadjust").addClass("hidden");jQuery("#btnshowcurrent").removeClass("hidden");jQuery("#btnshowfixed").addClass("hidden");jQuery("#btnclear").removeClass("hidden");jQuery(".aa-timezones-time-until").removeClass("hidden");updatePanels(new Date(clockTarget));timeUntil(clockTarget)}}function hashchange(){var ts=aaTimezonesAdjustOptions.timestamp.substring(1);clockTarget=0;if(!isNaN(parseFloat(ts))&&isFinite(ts)){clockTarget=ts*1e3;var mom=moment.tz(new Date(clockTarget),"Etc/UTC");jQuery("#timestamp").attr("datetime",mom.format("YYYY-MM-DDTHH:mm:00Z0000"));jQuery("#timestamp").timeago("update",new Date(clockTarget))}switchto(clockTarget)}jQuery(document).ready(function($){window.addEventListener("hashchange",hashchange,false);var mom=moment.tz(new Date,"Etc/UTC");var year=mom.format("YYYY")*1;var i;for(i=year-4;i<year+5;i++){$("#tatyear").append($("<option>",{i:i}).text(i))}$.timeago.settings.allowFuture=true;$.timeago.settings.allowPast=true;setInterval(function(){$("#timestamp").timeago("update",new Date(clockTarget))},1e4);hashchange()});