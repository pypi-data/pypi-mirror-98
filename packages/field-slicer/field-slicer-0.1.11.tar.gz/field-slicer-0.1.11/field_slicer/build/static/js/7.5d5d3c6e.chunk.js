(this["webpackJsonpfield-slicer"]=this["webpackJsonpfield-slicer"]||[]).push([[7],{174:function(e,t,n){"use strict";n.r(t),n.d(t,"activate",(function(){return M}));var o=n(12),c=n(175),i=n(16),r=n(0),s=n(31),a=n(32),l=function(e,t){switch(t.type){case"addFieldModel":return Object(a.a)(Object(a.a)({},e),{},{fieldModels:[].concat(Object(s.a)(e.fieldModels.filter((function(e){return e.fieldModelId!==t.fieldModel.fieldModelId}))),[t.fieldModel])});case"deleteFieldModels":return Object(a.a)(Object(a.a)({},e),{},{fieldModels:e.fieldModels.filter((function(e){return!t.fieldModelIds.includes(e.fieldModelId)}))});default:return e}},u=n(178),d=n(162),f=n(11),b=function(){var e=Object(r.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(r.useContext)(i.a);Object(r.useEffect)((function(){var e=setInterval((function(){var e=s.getHitherJobs();c(e)}),1e3);return function(){clearInterval(e)}}),[s]);var a={pendingJobs:n.filter((function(e){return"pending"===e.status})),runningJobs:n.filter((function(e){return"running"===e.status})),finishedJobs:n.filter((function(e){return"finished"===e.status})),erroredJobs:n.filter((function(e){return"error"===e.status}))},l=a.runningJobs,u=a.finishedJobs,d=a.erroredJobs,b=a.pendingJobs.length,j=l.length,p=u.length,O=d.length,h="Jobs: ".concat(b," pending | ").concat(j," running | ").concat(p," finished | ").concat(O," errored"),g=O>0?Object(f.jsxs)("span",{children:[":",Object(f.jsx)("span",{style:{color:"pink"},children:O})]}):Object(f.jsx)("span",{});return Object(f.jsxs)("span",{title:h,style:{fontFamily:"courier"},children:[b,":",j,":",p,g]})},j=n(173),p=n(157),O=n(159),h=n(160),g=function(e){var t=e.color,n=Object(r.useContext)(i.c),o=n.websocketStatus,c=n.onReconnectWebsocket,s=Object(r.useMemo)((function(){switch(o){case"waiting":return{icon:Object(f.jsx)(p.a,{style:{color:"blue"}}),title:"Loading..."};case"connected":return{icon:Object(f.jsx)(O.a,{style:{color:t}}),title:"Connected"};case"disconnected":return{icon:Object(f.jsx)(h.a,{style:{color:"red"}}),title:"Disconnected from server. Click to attempt reconnect."};default:throw Error("Unexpected.")}}),[o,t]),a=s.icon,l=s.title,u=Object(r.useCallback)((function(){"disconnected"===o&&c()}),[o,c]);return Object(f.jsx)(j.a,{title:l,onClick:u,children:a})},w=n(161),k=function(e){var t=e.onOpenSettings,n=e.color,o=Object(r.useMemo)((function(){return{icon:Object(f.jsx)(w.a,{}),title:"Open settings"}}),[]),c=o.icon,i=o.title,s=Object(r.useCallback)((function(){t()}),[t]);return Object(f.jsx)(j.a,{style:{color:n},title:i,onClick:s,children:c})},v=function(e){var t=e.onOpenSettings,n=e.workspaceRouteDispatch,o=e.logo,c=Object(r.useCallback)((function(){n({type:"gotoFieldModelsPage"})}),[n]);return Object(f.jsx)(u.a,{position:"static",style:{height:50,color:"white"},children:Object(f.jsxs)(d.a,{children:[o&&Object(f.jsx)("img",{src:o,className:"App-logo",alt:"logo",height:30,style:{paddingBottom:5,cursor:"pointer"},onClick:c}),"\xa0\xa0\xa0",Object(f.jsx)("span",{style:{paddingBottom:0,color:"white",fontFamily:"sans-serif",fontWeight:"bold"},children:"Field slicer"}),Object(f.jsx)("span",{style:{marginLeft:"auto"}}),Object(f.jsxs)("span",{style:{paddingBottom:0,color:"white"},children:[Object(f.jsx)(k,{onOpenSettings:t,color:"white"}),Object(f.jsx)(g,{color:"white"}),Object(f.jsx)(b,{})]})]})})};function m(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var x=function(e){var t=e.workspaceUri,n=e.workspaceRoute,s=e.workspaceRouteDispatch,a=(e.version,function(){var e=Object(r.useState)(m()),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){function e(){c(m())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}()),u=a.width,d=a.height-62-2,b=u-0-2,j=function(){var e=Object(i.f)();return Object(r.useMemo)((function(){return e.filter((function(e){return"WorkspaceView"===e.type})).map((function(e){return e}))}),[e])}().filter((function(e){return"WorkspaceView"===e.name}))[0];if(!j)throw Error("Unable to find workspace view plugin");var p=Object(r.useState)(!1),O=Object(o.a)(p,2),h=O[0],g=O[1],w=Object(r.useReducer)(l,Object(r.useMemo)((function(){return{fieldModels:[]}}),[])),k=Object(o.a)(w,2),x=k[0],M=k[1],y=Object(r.useCallback)((function(e){console.log("--- workspace subfeed messages",e),e.forEach((function(e){return M(e)}))}),[]),C=function(e){if(!e)return{feedUri:void 0,workspaceName:void 0};if(!e.startsWith("workspace://"))return{feedUri:void 0,workspaceName:void 0};var t=e.split("/"),n=t[2]||void 0,o=t[3]||void 0;return n&&o?{feedUri:"feed://".concat(n),workspaceName:o}:{feedUri:void 0,workspaceName:void 0}}(t),J=C.feedUri,U=C.workspaceName,W=Object(r.useMemo)((function(){return{workspaceName:U}}),[U]),N=Object(i.g)({feedUri:J,subfeedName:W,onMessages:y}).appendMessages,R=Object(r.useCallback)((function(e){N([e])}),[N]),S=Object(r.useCallback)((function(){g(!0)}),[]),E=Object(r.useCallback)((function(){g(!1)}),[]);return Object(f.jsxs)("div",{style:{margin:0},children:[Object(f.jsx)(v,{onOpenSettings:S,workspaceRouteDispatch:s}),Object(f.jsx)("div",{style:{position:"absolute",top:62},children:Object(f.jsx)(j.component,{width:b,height:d,workspace:x,workspaceDispatch:R,workspaceRoute:n,workspaceRouteDispatch:s})}),Object(f.jsx)(c.a,{open:h,onClose:E,style:{zIndex:9999},children:Object(f.jsx)("span",{})})]})};function M(e){e.registerPlugin({type:"MainWindow",name:"MainWindow",label:"Main Window",component:x})}}}]);
//# sourceMappingURL=7.5d5d3c6e.chunk.js.map