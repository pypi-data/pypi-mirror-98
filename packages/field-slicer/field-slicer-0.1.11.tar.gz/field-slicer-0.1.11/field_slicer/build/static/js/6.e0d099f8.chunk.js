(this["webpackJsonpfield-slicer"]=this["webpackJsonpfield-slicer"]||[]).push([[6],{127:function(e,t,n){},139:function(e,t){},172:function(e,t,n){"use strict";n.r(t),n.d(t,"activate",(function(){return Oe}));var i,r,a,o=n(0),c=n.n(o),s=n(11),l=function(e){return Object(s.jsx)("span",{style:{color:"gray",cursor:"pointer",textDecoration:"underline"},onClick:e.onClick,children:e.children})},u=n(12),h=n(163),f=n(164),d=n(165),v=n(166),x=n(167),b=n(176),g=n(173),m=n(168),p=n(169),y=(n(127),function(e){var t=e.title,n=e.rowKey,i=e.onDeleteRow,r=Object(o.useCallback)((function(){i&&i(n)}),[i,n]);return Object(s.jsx)(g.a,{title:t,onClick:r,children:Object(s.jsx)(m.a,{})})}),j=function(e){var t=e.title,n=e.rowKey,i=e.onConfirmDeleteRow,r=Object(o.useCallback)((function(){i&&i(n,!0)}),[i,n]),a=Object(o.useCallback)((function(){i&&i(n,!1)}),[i,n]);return Object(s.jsxs)("span",{children:["Confirm delete?",Object(s.jsx)(g.a,{title:t,onClick:r,children:Object(s.jsx)(m.a,{})}),Object(s.jsx)(g.a,{title:"Cancel",onClick:a,children:"\u2716"})]})},_=function(e){var t=e.title,n=e.rowKey,i=e.onEditRow;return Object(s.jsx)(g.a,{title:t,onClick:function(){return i&&i(n)},children:Object(s.jsx)(p.a,{})})},O=function(e){return 0==e?e:e?"object"==typeof e?e.element?e.element:e.text||"":e:""},k=function(e){var t=e.rows,n=e.columns,i=e.onDeleteRow,r=void 0===i?void 0:i,a=e.deleteRowLabel,c=void 0===a?void 0:a,l=e.onEditRow,g=void 0===l?void 0:l,m=e.editRowLabel,p=void 0===m?void 0:m,k=e.selectionMode,M=void 0===k?"none":k,w=e.selectedRowKeys,D=void 0===w?{}:w,E=e.onSelectedRowKeysChanged,C=void 0===E?void 0:E,R=Object(o.useMemo)((function(){var e={};return Object.keys(D).forEach((function(t){e[t]=D[t]})),e}),[D]),P=Object(o.useState)(null),A=Object(u.a)(P,2),H=A[0],S=A[1],T=Object(o.useCallback)((function(e){C&&("single"===M?e in R&&R[e]?C([]):C([e+""]):"multiple"===M&&C(Object.keys(R).filter((function(t){return t!=e&&R[t]})).concat(R[e]?[]:[e.toString()])))}),[C,M,R]),I=Object(o.useCallback)((function(e){S(e)}),[]),W=Object(o.useCallback)((function(e,t){t&&r&&r(e),S(null)}),[r]),B=Object(o.useCallback)((function(e){g&&g(e)}),[g]);return Object(s.jsxs)(h.a,{className:"NiceTable",children:[Object(s.jsx)(f.a,{children:Object(s.jsxs)(d.a,{children:[Object(s.jsx)(v.a,{style:{width:0}},"_first"),n.map((function(e){return Object(s.jsx)(v.a,{children:Object(s.jsx)("span",{children:e.label})},e.key)}))]})}),Object(s.jsx)(x.a,{children:t.map((function(e){return Object(s.jsxs)(d.a,{children:[Object(s.jsxs)(v.a,{children:[r&&(H===e.key?Object(s.jsx)(j,{title:c||"",onConfirmDeleteRow:W,rowKey:e.key}):Object(s.jsx)(y,{title:c||"",onDeleteRow:I,rowKey:e.key})),g&&Object(s.jsx)(_,{title:p||"",onEditRow:B,rowKey:e.key}),"none"!==M&&Object(s.jsx)(b.a,{checked:R[e.key]||!1,onClick:function(){return T(e.key)}})]}),n.map((function(t){return Object(s.jsx)(v.a,{children:Object(s.jsx)("span",{children:O(e.columnValues[t.key])})},t.key)}))]},e.key)}))})]})},M=function(e){var t=e.fieldModel,n=e.onClick,i=e.label,r=Object(o.useCallback)((function(){n(t.fieldModelId)}),[n,t.fieldModelId]);return Object(s.jsx)(l,{onClick:r,children:i})},w=function(e){var t=e.fieldModels,n=e.onFieldModelClicked,i=e.onDeleteFieldModels,r=Object(o.useMemo)((function(){return[{key:"fieldModelId",label:"Field Model"},{key:"fieldModelLabel",label:"Label"}]}),[]),a=Object(o.useMemo)((function(){return t.map((function(e){return{key:e.fieldModelId,columnValues:{fieldModelId:{text:e.fieldModelId,element:Object(s.jsxs)("span",{children:[Object(s.jsx)(M,{fieldModel:e,label:e.fieldModelId,onClick:n}),"\xa0\xa0\xa0"]})},fieldModelLabel:{text:e.fieldModelLabel,element:Object(s.jsxs)("span",{children:[Object(s.jsx)(M,{fieldModel:e,label:e.fieldModelLabel,onClick:n}),"\xa0\xa0\xa0"]})}}}}))}),[t,n]),c=Object(o.useCallback)((function(e){i([e])}),[i]);return Object(s.jsx)(k,{columns:r,rows:a,onDeleteRow:c})},D=n(32),E=n(16),C=n(171),R=function(e){return[[e.get([0,0]),e.get([0,1]),e.get([0,2]),e.get([0,3])],[e.get([1,0]),e.get([1,1]),e.get([1,2]),e.get([1,3])],[e.get([2,0]),e.get([2,1]),e.get([2,2]),e.get([2,3])]]},P=function(e){return Object(C.c)([[e[0][0],e[0][1],e[0][2],e[0][3]],[e[1][0],e[1][1],e[1][2],e[1][3]],[e[2][0],e[2][1],e[2][2],e[2][3]],[0,0,0,1]])},A=function(e,t){var n=P(e),i=P(t),r=Object(C.d)(n,i);return R(r)},H=function(e){var t=P(e),n=Object(C.b)(t);return R(n)},S=function(e,t,n){var i=t.map((function(t){return Object(D.a)(Object(D.a)({},t),{},{transformation:A(H(e.transformation),t.transformation)})})),r=n.map((function(t){return e.components.indexOf(t)})),a=function(e,t,n){var i=Object(E.e)("createjob_sample_data_object_slices",{data_uri:e,slices:t,component_indices:n},{useClientCache:!0}),r=i.result;return i.job,r||void 0}(e.dataUri,i,r);return a?t.map((function(e,t){return{slice:e,components:n,data:a[t]}})):void 0},T=n(23),I=n(31),W=n(2),B=n.n(W),L=n(52),F=n(8),N=n(9),K=function(e){if(e&&Array.isArray(e)&&2===e.length){var t,n=Object(T.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!q(i))return!1}}catch(r){n.e(r)}finally{n.f()}return!0}return!1},V=function(e){if(e&&Array.isArray(e)&&3===e.length){var t,n=Object(T.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!q(i))return!1}}catch(r){n.e(r)}finally{n.f()}return!0}return!1},z=function(e){return Object(C.a)(e.xmax-e.xmin)},U=function(e){return Object(C.a)(e.ymax-e.ymin)},J=function(e){return[e.xmin+z(e)/2,Math.min(e.ymin,e.ymax)+U(e)/2]},G=function(e){if(JSON.stringify(e.size())===JSON.stringify([3,3])){var t=e.toArray();if(JSON.stringify(t[2])===JSON.stringify([0,0,1]))return t}throw Error("Matrix ".concat(JSON.stringify(e)," is invalid as a transform matrix."))},Y=function(e,t){2===t.length&&(t=[t[0],t[1],1]);var n=Object(C.c)(e),i=Object(C.c)(t);return Object(C.d)(n,i).toArray()},X=function(e,t){var n=Object(C.c)(e),i=Object(C.c)([[t.xmin,t.xmax],[t.ymin,t.ymax],[1,1]]),r=Object(C.d)(n,i).toArray(),a=r[0][0],o=r[0][1],c=r[1][0],s=r[1][1];return{xmin:Math.min(a,o),xmax:Math.max(a,o),ymin:Math.min(c,s),ymax:Math.max(c,s)}},q=function(e){return null!==e&&void 0!==e&&"number"===typeof e},Q=function(){function e(t,n,i,r){Object(F.a)(this,e),this._exportingFigure=!1,this._context2D=void 0,this._pixelWidth=void 0,this._pixelHeight=void 0,this._primaryContext2D=void 0,this._offscreenCanvas=null,this._transformMatrix=void 0,this._context2D=t,this._primaryContext2D=t,this._pixelWidth=n,this._pixelHeight=i,this._transformMatrix=r}return Object(N.a)(e,[{key:"transform",value:function(t){try{var n=G(Object(C.d)(Object(C.c)(this._transformMatrix),Object(C.c)(t)));return new e(this._context2D,this._pixelWidth,this._pixelHeight,n)}catch(i){return console.warn("Problem transforming painter:",i),this}}},{key:"useOffscreenCanvas",value:function(e,t){try{var n=new OffscreenCanvas(Math.max(e,10),Math.max(t,10));this._offscreenCanvas=n;var i=n.getContext("2d");if(!i)throw Error("Unexpected");this._context2D=i}catch(r){console.warn("Problem in useOffscreenCanvas",r)}}},{key:"transferOffscreenToPrimary",value:function(){var e=this._offscreenCanvas;if(e){var t=e.transferToImageBitmap();this._context2D=this._primaryContext2D,this._context2D.clearRect(0,0,t.width,t.height),this._context2D.drawImage(t,0,0)}else console.warn("No offscreen canvas")}},{key:"getDefaultPen",value:function(){return{color:"black"}}},{key:"getDefaultFont",value:function(){return{"pixel-size":12,family:"Arial"}}},{key:"getDefaultBrush",value:function(){return{color:"black"}}},{key:"createPainterPath",value:function(){return new Z}},{key:"setExportingFigure",value:function(e){this._exportingFigure=e}},{key:"exportingFigure",value:function(){return this._exportingFigure}},{key:"fillWholeCanvas",value:function(e){console.log("Pixel dimensions: 0 to ".concat(this._pixelWidth," and 0 to ").concat(this._pixelHeight)),this._context2D.save(),te(this._context2D,{color:e}),this._context2D.fillRect(0,0,this._pixelWidth,this._pixelHeight),this._context2D.restore()}},{key:"clear",value:function(){this.clearRect({xmin:0,xmax:this._pixelWidth,ymin:0,ymax:this._pixelHeight})}},{key:"clearRect",value:function(e){this.fillRect(e,{color:"transparent"})}},{key:"ctxSave",value:function(){this._context2D.save()}},{key:"ctxRestore",value:function(){this._context2D.restore()}},{key:"wipe",value:function(){this._context2D.clearRect(0,0,this._pixelWidth,this._pixelHeight)}},{key:"ctxTranslate",value:function(e){throw Error("Deprecated method, needs rewrite.")}},{key:"ctxRotate",value:function(e){this._context2D.rotate(e)}},{key:"fillRect",value:function(e,t){var n=X(this._transformMatrix,e);this._context2D.save(),te(this._context2D,t),this._context2D.fillRect(Math.min(n.xmin,n.xmax),Math.min(n.ymin,n.ymax),z(n),U(n)),this._context2D.restore()}},{key:"drawRect",value:function(e,t){var n=X(this._transformMatrix,e);this._context2D.save(),ee(this._context2D,t),this._context2D.strokeRect(Math.min(n.xmin,n.xmax),Math.min(n.ymin,n.ymax),z(n),U(n)),this._context2D.restore()}},{key:"getEllipseFromBoundingRect",value:function(e){var t=X(this._transformMatrix,e);return{center:J(t),W:Math.abs(z(t)),H:Math.abs(U(t))}}},{key:"fillEllipse",value:function(e,t){var n=Object(D.a)({},this.getEllipseFromBoundingRect(e)),i=n.center,r=n.W,a=n.H;this._context2D.fillStyle=$(t.color),this._context2D.beginPath(),this._context2D.ellipse(i[0],i[1],r/2,a/2,0,0,2*Math.PI),this._context2D.fill()}},{key:"drawEllipse",value:function(e,t){var n=Object(D.a)({},this.getEllipseFromBoundingRect(e)),i=n.center,r=n.W,a=n.H;this._context2D.save(),ee(this._context2D,t),this._context2D.beginPath(),this._context2D.ellipse(i[0],i[1],r/2,a/2,0,0,2*Math.PI),this._context2D.stroke(),this._context2D.restore()}},{key:"drawPath",value:function(e,t){this._context2D.save(),ee(this._context2D,t),e._draw(this._context2D,this._transformMatrix),this._context2D.restore()}},{key:"drawLine",value:function(e,t,n,i,r){var a=new Z;a.moveTo(e,t),a.lineTo(n,i),this.drawPath(a,r)}},{key:"drawText",value:function(e){var t,n,i=e.text,r=e.rect,a=e.alignment,o=e.font,c=e.pen,s=e.brush,l=e.orientation,u=void 0===l?"Horizontal":l,h=X(this._transformMatrix,r);this._context2D.save(),"Vertical"===u&&(this._context2D.rotate(-Math.PI/2),h={xmin:-(n=h).ymax,xmax:-n.ymin,ymin:n.xmin,ymax:n.xmax},a={Horizontal:"AlignBottom"===(t=a).Vertical?"AlignLeft":"AlignTop"===t.Vertical?"AlignRight":"AlignCenter",Vertical:"AlignRight"===t.Horizontal?"AlignBottom":"AlignLeft"===t.Horizontal?"AlignTop":"AlignCenter"}),ne(this._context2D,o);var f=function(e,t){var n,i,r="left",a="bottom";switch(t.Horizontal){case"AlignLeft":n=e.xmin,r="left";break;case"AlignCenter":n=J(e)[0],r="center";break;case"AlignRight":n=e.xmax,r="right";break;default:throw new Error("Missing horizontal alignment in drawText: AlignLeft, AlignCenter, or AlignRight")}switch(t.Vertical){case"AlignBottom":i=e.ymax,a="bottom";break;case"AlignCenter":i=J(e)[1],a="middle";break;case"AlignTop":i=e.ymin,a="top";break;default:throw new Error("Missing vertical alignment in drawText: AlignTop, AlignBottom, or AlignVCenter")}return{x:n,y:i,textAlign:r,textBaseline:a}}(h,a);ie(this._context2D,f),ee(this._context2D,c),te(this._context2D,s),this._context2D.translate(f.x,f.y),this._context2D.fillText(i,0,0),this._context2D.restore()}},{key:"drawMarker",value:function(e,t){var n=Y(this._transformMatrix,e);this._context2D.save(),t.pen&&(ee(this._context2D,t.pen),this._context2D.beginPath(),this._context2D.ellipse(n[0],n[1],t.radius,t.radius,0,0,2*Math.PI),this._context2D.stroke()),t.brush&&(te(this._context2D,t.brush),this._context2D.beginPath(),this._context2D.ellipse(n[0],n[1],t.radius,t.radius,0,0,2*Math.PI),this._context2D.fill()),this._context2D.restore()}},{key:"createImageData",value:function(e,t){return this._context2D.createImageData(e,t)}},{key:"getImageData",value:function(e,t,n,i){return this._context2D.getImageData(e,t,n,i)}},{key:"putImageData",value:function(e,t,n){this._context2D.putImageData(e,t,n)}}]),e}(),Z=function(){function e(){Object(F.a)(this,e),this._actions=[]}return Object(N.a)(e,[{key:"moveTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(K(e))return this.moveTo(e[0],e[1]);if(!q(t))throw Error("unexpected");this._actions.push({name:"moveTo",x:e,y:t})}},{key:"lineTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(K(e))return this.lineTo(e[0],e[1]);if(!q(t))throw Error("unexpected");this._actions.push({name:"lineTo",x:e,y:t})}},{key:"_draw",value:function(e,t){var n=this;e.beginPath(),this._transformPathPoints(t).forEach((function(t){n._applyAction(e,t)})),e.stroke()}},{key:"_applyAction",value:function(e,t){"moveTo"===t.name?void 0!==t.x&&void 0!==t.y&&e.moveTo(t.x,t.y):"lineTo"===t.name&&void 0!==t.x&&void 0!==t.y&&e.lineTo(t.x,t.y)}},{key:"_transformPathPoints",value:function(e){var t=Object(C.c)(e);return this._actions.map((function(e){if(void 0!==e.x&&void 0!==e.y){var n=Object(C.c)([e.x,e.y,1]),i=Object(C.d)(t,n).toArray();return Object(D.a)(Object(D.a)({},e),{},{x:i[0],y:i[1]})}return e}))}}]),e}(),$=function(e){if(null!==(t=e)&&void 0!==t&&"string"===typeof t)return e;if(function(e){if(e&&Array.isArray(e)&&4===e.length){var t,n=Object(T.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!q(i))return!1}}catch(r){n.e(r)}finally{n.f()}return!0}return!1}(e))return"rgba(".concat(Math.floor(e[0]),", ").concat(Math.floor(e[1]),", ").concat(Math.floor(e[2]),", ").concat(e[3],")");if(V(e))return"rgb(".concat(Math.floor(e[0]),", ").concat(Math.floor(e[1]),", ").concat(Math.floor(e[2]),")");throw Error("unexpected");var t},ee=function(e,t){var n=t.color||"black",i=q(t.width)?t.width:1;e.strokeStyle=$(n),e.lineWidth=i||1},te=function(e,t){var n="color"in t?t.color:"black";e.fillStyle=$(n)},ne=function(e,t){var n=t.pixelSize||"12",i=t.family||"Arial";e.font="".concat(n,"px ").concat(i)},ie=function(e,t){e.textAlign=t.textAlign,e.textBaseline=t.textBaseline};!function(e){e.Move="MOVE",e.Press="PRESS",e.Release="RELEASE"}(i||(i={})),function(e){e.Press="PRESS",e.Release="RELEASE"}(r||(r={})),function(e){e.Enter="ENTER",e.Leave="LEAVE",e.Out="OUT"}(a||(a={}));var re=function(e,t,n){var i=e.currentTarget,r=[e.clientX-i.getBoundingClientRect().x,e.clientY-i.getBoundingClientRect().y];if(n){var a=function(e,t,n){return Y(e,[(i=[t,n])[0],i[1],1]);var i}(n,r[0],r[1]);r=[a[0],a[1]]}var o={alt:e.altKey,ctrl:e.ctrlKey||e.metaKey,shift:e.shiftKey};return{point:[r[0],r[1]],mouseButton:e.buttons,modifiers:o,type:t}},ae=function(){function e(t,n,i,r){Object(F.a)(this,e),this._onPaint=void 0,this._onPropsChange=void 0,this._runningOnPropsChange=!1,this._props=null,this._state=void 0,this._pixelWidth=null,this._pixelHeight=null,this._canvasElement=null,this._transformMatrix=void 0,this._inverseMatrix=void 0,this._repaintScheduled=!1,this._lastRepaintTimestamp=Number(new Date),this._discreteMouseEventHandlers=[],this._dragHandlers=[],this._keyboardEventHandlers=[],this._mousePresenceEventHandlers=[],this._wheelEventHandlers=[],this._refreshRate=120,this._state=i,this._onPaint=t,this._onPropsChange=n,this._discreteMouseEventHandlers=(null===r||void 0===r?void 0:r.discreteMouseEventHandlers)||[],this._dragHandlers=(null===r||void 0===r?void 0:r.dragHandlers)||[],this._keyboardEventHandlers=(null===r||void 0===r?void 0:r.keyboardEventHandlers)||[],this._mousePresenceEventHandlers=(null===r||void 0===r?void 0:r.mousePresenceEventHandlers)||[],this._wheelEventHandlers=(null===r||void 0===r?void 0:r.wheelEventHandlers)||[],this._transformMatrix=[[1,0,0],[0,1,0],[0,0,1]],this._inverseMatrix=[[1,0,0],[0,1,0],[0,0,1]]}return Object(N.a)(e,[{key:"getProps",value:function(){if(!this._props)throw Error("getProps must not be called before initial props are set");return this._props}},{key:"setProps",value:function(e){if(this._runningOnPropsChange)throw Error("Calling setProps inside onPropsChange is not allowed.");if(null===this._props||!oe(this._props,e)){this._props=e,this._pixelWidth=e.width,this._pixelHeight=e.height,this._runningOnPropsChange=!0;try{this._onPropsChange(this,e)}finally{this._runningOnPropsChange=!1}}}},{key:"getState",value:function(){return this._state}},{key:"setState",value:function(e){this._state=e}},{key:"getTransformMatrix",value:function(){return this._transformMatrix}},{key:"setTransformMatrix",value:function(e){this._transformMatrix=e;try{this._inverseMatrix=function(e){var t=Object(C.c)(e);return Object(C.b)(t).toArray()}(e)}catch(t){console.warn(t),console.warn("WARNING: problem getting inverse transformation matrix"),this._inverseMatrix=e}}},{key:"pixelWidth",value:function(){if(null===this._pixelWidth)throw Error("Cannot get pixelWidth before it is set");return this._pixelWidth}},{key:"pixelHeight",value:function(){if(null===this._pixelHeight)throw Error("Cannot get pixelHeight before it is set");return this._pixelHeight}},{key:"resetCanvasElement",value:function(e){this._canvasElement=e}},{key:"canvasElement",value:function(){return this._canvasElement}},{key:"refreshRate",value:function(){return this._refreshRate}},{key:"setRefreshRate",value:function(e){this._refreshRate=e}},{key:"scheduleRepaint",value:function(){var e=this;if(!this._repaintScheduled){var t=Number(new Date)-this._lastRepaintTimestamp,n=1e3/this._refreshRate;t>2*n?this._doRepaint():(this._repaintScheduled=!0,setTimeout((function(){e._repaintScheduled=!1,e._doRepaint()}),n))}}},{key:"repaintImmediate",value:function(){this._doRepaint()}},{key:"_doRepaint",value:function(){var e=Object(L.a)(B.a.mark((function e(){var t,n,i,r,a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!==(t=null===(n=this._canvasElement)||void 0===n?void 0:n.getContext("2d"))&&void 0!==t?t:null){e.next=3;break}return e.abrupt("return");case 3:if(null!==this._pixelWidth&&null!==this._pixelHeight){e.next=5;break}return e.abrupt("return");case 5:if(r=new Q(i,this._pixelWidth,this._pixelHeight,this._transformMatrix),!(a=this._onPaint(r,this._props,this._state))){e.next=11;break}return this._lastRepaintTimestamp=Number(new Date),e.next=11,a;case 11:this._lastRepaintTimestamp=Number(new Date);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleDiscreteEvent",value:function(e,t){if(0!==this._discreteMouseEventHandlers.length){var n,i=re(e,t,this._inverseMatrix),r=Object(T.a)(this._discreteMouseEventHandlers);try{for(r.s();!(n=r.n()).done;){(0,n.value)(i,this)}}catch(a){r.e(a)}finally{r.f()}}}},{key:"handleDrag",value:function(e,t,n,i,r){if(0!==this._dragHandlers.length){var a,o=X(this._inverseMatrix,e),c=i?Y(this._inverseMatrix,[].concat(Object(I.a)(i),[1])):void 0,s=r?Y(this._inverseMatrix,[].concat(Object(I.a)(r),[1])):void 0,l=Object(T.a)(this._dragHandlers);try{for(l.s();!(a=l.n()).done;){(0,a.value)(this,{dragRect:o,released:t,shift:n||!1,anchor:c,position:s})}}catch(u){l.e(u)}finally{l.f()}}}},{key:"handleKeyboardEvent",value:function(e,t){if(0===this._keyboardEventHandlers.length)return!0;var n,i=function(e,t){return{type:e,keyCode:t.keyCode}}(e,t),r=!0,a=Object(T.a)(this._keyboardEventHandlers);try{for(a.s();!(n=a.n()).done;){!1===(0,n.value)(i,this)&&(r=!1)}}catch(o){a.e(o)}finally{a.f()}return r}},{key:"handleMousePresenceEvent",value:function(e,t){if(0!==this._mousePresenceEventHandlers.length){var n,i={type:t},r=Object(T.a)(this._mousePresenceEventHandlers);try{for(r.s();!(n=r.n()).done;){(0,n.value)(i,this)}}catch(a){r.e(a)}finally{r.f()}}}},{key:"handleWheelEvent",value:function(e){if(0!==this._wheelEventHandlers.length){var t,n=function(e){return{deltaY:e.deltaY}}(e),i=Object(T.a)(this._wheelEventHandlers);try{for(i.s();!(t=i.n()).done;){(0,t.value)(n,this)}}catch(r){i.e(r)}finally{i.f()}}}}]),e}(),oe=function(e,t){for(var n in e)if(e[n]!==t[n])return!1;for(var i in t)if(e[i]!==t[i])return!1;return!0},ce="COMPUTE_DRAG",se="END_DRAG",le=function(e,t){var n=e.dragging,i=e.dragAnchor,r=t.type,a=t.mouseButton,o=t.point,c=t.shift;switch(r){case se:return{dragging:!1};case ce:if(!a)return{dragging:!1};if(!o)throw Error("Unexpected: no point");if(n&&!i)throw Error("Invalid state in computing drag: cannot have drag set with no dragAnchor.");if(!n&&!i)return{dragging:!1,dragAnchor:o,shift:c||!1};if(!n&&i){if(!(n=Math.abs(o[0]-i[0])>4||Math.abs(o[1]-i[1])>4))return{dragging:!1,dragAnchor:i,shift:c||!1}}if(n&&i)return{dragging:!0,dragAnchor:i,dragPosition:o,dragRect:[Math.min(i[0],o[0]),Math.min(i[1],o[1]),Math.abs(i[0]-o[0]),Math.abs(i[1]-o[1])],shift:c||!1};break;default:throw Error("Invalid mode for drag reducer.")}throw Error("Unexpected: unreachable, but keeps ESLint happy")},ue=function(e){var t=e.layers,n=e.preventDefaultWheel,l=e.width,h=e.height,f=Object(o.useState)(null),d=Object(u.a)(f,2),v=d[0],x=d[1],b=Object(o.useState)(!1),g=Object(u.a)(b,2),m=g[0],p=g[1],y=c.a.useCallback((function(e){x(e)}),[]);Object(o.useEffect)((function(){v&&(v._hasFocus=m)}),[m,v]),Object(o.useEffect)((function(){if(v&&t){var e=function(e){v._hasFocus&&e.preventDefault()};t.forEach((function(t,i){var r=v.children[i];r&&t?(n&&r.addEventListener("wheel",e),t.resetCanvasElement(r),t.scheduleRepaint()):console.warn("Unable to get canvas element for layer",i)}))}}),[v,t,n]);var j=Object(o.useReducer)(le,{dragging:!1}),_=Object(u.a)(j,2),O=_[0],k=_[1],M=Object(o.useRef)(null);Object(o.useEffect)((function(){t.forEach((function(e){e&&e.scheduleRepaint()}))}),[l,h,t]);var w=Object(o.useState)(null),D=Object(u.a)(w,2),E=D[0],C=D[1];Object(o.useEffect)((function(){var e=null;if(e=O.dragging?O:E&&E.dragging?E:null){var n=e.dragRect;if(n){var i,r={xmin:n[0],xmax:n[0]+n[2],ymin:n[1]+n[3],ymax:n[1]},a=Object(T.a)(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;o&&o.handleDrag(r,!O.dragging,e.shift,e.dragAnchor,e.dragPosition)}}catch(c){a.e(c)}finally{a.f()}}}C(O)}),[O,E,C,t]);var R,P=Object(o.useCallback)((function(e,n){if(!O.dragging){var i,r=Object(T.a)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;a&&a.handleDiscreteEvent(e,n)}}catch(o){r.e(o)}finally{r.f()}}}),[t,O]),A=Object(o.useCallback)((function(e,n){if(t){var i,r=Object(T.a)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;a&&a.handleMousePresenceEvent(e,n)}}catch(o){r.e(o)}finally{r.f()}}}),[t]),H=Object(o.useCallback)((function(e){var t,n=re(e,i.Move),r=n.point,a=n.mouseButton,o=n.modifiers;t={type:ce,mouseButton:1===a,point:r,shift:o.shift||!1},M.current?M.current=t:(M.current=t,setTimeout((function(){var e=M.current;M.current=null,e&&k(e)}),30)),P(e,i.Move)}),[P]),S=Object(o.useCallback)((function(e){var t=re(e,i.Press),n=t.point,r=t.modifiers;P(e,i.Press),k({type:ce,mouseButton:!0,point:n,shift:r.shift||!1})}),[P]),I=Object(o.useCallback)((function(e){p(!0);var t=re(e,i.Move),n=t.point,r=t.mouseButton,a=t.modifiers;P(e,i.Release),k({type:ce,mouseButton:1===r,point:n,shift:a.shift||!1}),k({type:se})}),[P,k]),W=Object(o.useCallback)((function(e){A(e,a.Enter)}),[A]),B=Object(o.useCallback)((function(e){p(!1),A(e,a.Leave)}),[A]),L=Object(o.useCallback)((function(e){var n,i=Object(T.a)(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;r&&r.handleWheelEvent(e)}}catch(a){i.e(a)}finally{i.f()}}),[t]),F=Object(o.useCallback)((function(e){var n,i=Object(T.a)(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;a&&!1===a.handleKeyboardEvent(r.Press,e)&&e.preventDefault()}}catch(o){i.e(o)}finally{i.f()}}),[t]),N=Object(T.a)(t);try{for(N.s();!(R=N.n()).done;){var K=R.value;if(K){var V=K.getProps(),z=V.width,U=V.height;if(z!==l||U!==h)throw console.warn(z,U,l,h),Error("Inconsistent width or height between canvas widget and layer")}}}catch(J){N.e(J)}finally{N.f()}return Object(s.jsx)("div",{ref:y,style:{position:"relative",width:l,height:h,left:0,top:0},onKeyDown:F,tabIndex:0,children:(t||[]).map((function(e,t){return Object(s.jsx)("canvas",{style:{position:"absolute",left:0,top:0},width:l,height:h,onMouseMove:H,onMouseDown:S,onMouseUp:I,onMouseEnter:W,onMouseLeave:B,onWheel:L},"canvas-"+t)}))})},he={},fe=function(e,t){},de=function(){return new ae((function(e,t,n){var i=t.sampledSlice,r=t.valueRange,a=t.width,o=t.height;if(i){var c=i.slice.nx,s=i.slice.ny,l=Math.min(a/c,o/s);e.wipe();for(var u=e.createImageData(a,o),h=0;h<a;h++){var f=Math.round(h/l);if(0<f&&f<c)for(var d=0;d<o;d++){var v=Math.round(d/l);if(0<v&&v<s){var x=(i.data[f][v][0]-r.min)/(r.max-r.min),b=4*(h+a*d),g=ve(x);u.data[b+0]=g[0],u.data[b+1]=g[1],u.data[b+2]=g[2],u.data[b+3]=g[3]}}}e.putImageData(u,0,0)}}),(function(e,t){e.scheduleRepaint()}),he,{discreteMouseEventHandlers:[fe],dragHandlers:[]})},ve=function(e){e<=0&&(e=0),e>=1&&(e=1);var t=Math.floor(255.999*e);return[t,t,t,255]},xe=function(e){e.width,e.height;var t=e.sampledSlice,n=e.valueRange,i=function(e){var t=Object(o.useState)([]),n=Object(u.a)(t,2),i=n[0],r=n[1];return function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(i,e)?i:(r(e),e)}([function(e,t){var n=Object(o.useState)(null),i=Object(u.a)(n,2),r=i[0],a=i[1];return Object(o.useEffect)((function(){null===r&&a(e())}),[r,a,e]),r&&t&&r.setProps(t),r}(de,{width:300,height:300,sampledSlice:t,valueRange:n})]);return Object(s.jsx)(ue,{layers:i,width:300,height:300})},be=n(177);function ge(e){return"Slice ".concat(e)}var me=function(e){var t=e.width,n=e.numSlices,i=e.currentSlice,r=e.onCurrentSliceChanged,a=Object(o.useCallback)((function(e,t){r(t)}),[r]);return Object(s.jsx)("div",{style:{width:t},children:Object(s.jsx)(be.a,{value:i,onChange:a,getAriaValueText:ge,valueLabelDisplay:"auto",step:1,marks:!0,min:0,max:n-1})})},pe=function(e){var t=e.sampledSlices,n=Object(o.useState)(0),i=Object(u.a)(n,2),r=i[0],a=i[1],c=t?t.length:0,l=Object(o.useMemo)((function(){var e,n={min:0,max:0},i=!0,r=Object(T.a)(t||[]);try{for(r.s();!(e=r.n()).done;)for(var a=e.value,o=0;o<a.data.length;o++)for(var c=0;c<a.data[o].length;c++){var s=a.data[o][c][0];n.min=i?s:Math.min(n.min,s),n.max=i?s:Math.max(n.max,s),i=!1}}catch(l){r.e(l)}finally{r.f()}return n}),[t]);return Object(s.jsxs)("div",{style:{margin:30},children:[Object(s.jsx)(xe,{width:300,height:300,sampledSlice:t?t[r]:void 0,valueRange:l}),Object(s.jsx)(me,{width:300,numSlices:c,currentSlice:r,onCurrentSliceChanged:a})]})},ye=function(e){var t=e.fieldModel,n=Object(o.useMemo)((function(){return[.1,.2,.3,.4,.5,.6,.7,.8,.9].map((function(e){return function(e){var t=e.center,n=e.dx,i=e.dy,r=e.nx,a=e.ny;return{transformation:[[n[0],i[0],0,t[0]-.5*r*n[0]-.5*a*i[0]],[n[1],i[1],0,t[1]-.5*r*n[1]-.5*a*i[1]],[n[2],i[2],0,t[2]-.5*r*n[2]-.5*a*i[2]]],nx:r,ny:a}}({center:[.5,.5,e],dx:[.01,0,0],dy:[0,.01,0],nx:90,ny:90})}))}),[]),i=S(t,n,t.components);return Object(s.jsx)(pe,{sampledSlices:i})},je=function(e){var t=e.fieldModel,n=e.workspaceRouteDispatch,i=Object(o.useCallback)((function(){n({type:"gotoFieldModelsPage"})}),[n]);return t?Object(s.jsxs)("div",{children:[Object(s.jsx)(l,{onClick:i,children:"Back to field models"}),Object(s.jsx)("div",{children:Object(s.jsxs)("h3",{children:["Field model: ",t.fieldModelId," (",t.fieldModelLabel,")"]})}),Object(s.jsx)(ye,{fieldModel:t})]}):Object(s.jsx)("div",{children:"No field model"})},_e=function(e){var t=e.workspace,n=e.workspaceDispatch,i=e.workspaceRoute,r=e.workspaceRouteDispatch,a=(e.width,e.height,Object(o.useCallback)((function(e){n({type:"deleteFieldModels",fieldModelIds:e})}),[n])),c=Object(o.useCallback)((function(e){r({type:"gotoFieldModelPage",fieldModelId:e})}),[r]);switch(i.page){case"fieldModels":return Object(s.jsx)(w,{fieldModels:t.fieldModels,onFieldModelClicked:c,onDeleteFieldModels:a});case"fieldModel":return Object(s.jsx)(je,{fieldModel:t.fieldModels.filter((function(e){return e.fieldModelId===i.fieldModelId}))[0],workspaceRouteDispatch:r})}};function Oe(e){e.registerPlugin({type:"WorkspaceView",name:"WorkspaceView",label:"Workspace View",component:_e})}}}]);
//# sourceMappingURL=6.e0d099f8.chunk.js.map