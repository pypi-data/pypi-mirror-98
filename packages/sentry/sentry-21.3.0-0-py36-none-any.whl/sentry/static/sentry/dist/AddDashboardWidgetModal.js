(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[42],{1887:function(e,t,n){"use strict";n.r(t),n.d(t,"modalCss",(function(){return De}));var r=n(20),i=n.n(r),o=n(29),a=n.n(o),l=n(9),c=n.n(l),s=n(10),u=n.n(s),d=n(11),f=n.n(d),b=n(12),p=n.n(b),g=n(7),h=n.n(g),m=n(24),y=n.n(m),v=n(8),O=n.n(v),j=n(121),C=n.n(j),S=n(3),w=n(1),x=n.n(w),k=n(0),D=n(751),T=n.n(D),F=n(59),R=n.n(F),P=n(296),A=n.n(P),E=n(393),q=n.n(E),z=n(2338),I=n(33),U=n(27),M=n(76),L=n(1932),W=n(120),B=n(15),N=n(2),Q=n(6),G=n(61),_=n(223),Y=n(698),H=n(2324),V=n(2175),J=n(426);function K(e){var t=e.displayType,n=e.errors,r=e.fields,i=e.fieldOptions,o=e.onChange;function a(e,t){var n=y()(r);n[t]=Object(G.m)(e),o(n)}if("table"===t)return Object(k.f)(Y.a,{"data-test-id":"columns",label:Object(N.b)("Columns"),inline:!1,flexibleControlStateSize:!0,stacked:!0,error:null==n?void 0:n.fields,required:!0},Object(k.f)(X,{columns:r.map((function(e){return Object(G.i)({field:e})})),onChange:function(e){var t=e.map(G.m);o(t)},fieldOptions:i}));var l=["world_map","big_number"].includes(t)&&1===r.length||["line","area","stacked_area","bar"].includes(t)&&3===r.length;return Object(k.f)(Y.a,{"data-test-id":"y-axis",label:Object(N.b)("Y-Axis"),inline:!1,style:{padding:"16px 0 24px 0"},flexibleControlStateSize:!0,stacked:!0,error:null==n?void 0:n.fields,required:!0},r.map((function(e,t){return Object(k.f)($,{key:"".concat(e,":").concat(t)},Object(k.f)(V.a,{fieldValue:Object(G.i)({field:e}),fieldOptions:i,onChange:function(e){return a(e,t)},filterPrimaryOptions:function(e){return e.value.kind===J.a.FUNCTION}}),r.length>1&&Object(k.f)(U.b,{size:"zero",borderless:!0,onClick:function(e){return function(e,t){e.preventDefault();var n=y()(r);n.splice(t,1),o(n)}(e,t)},icon:Object(k.f)(B.r,null),title:Object(N.b)("Remove this Y-Axis"),label:Object(N.b)("Remove this Y-Axis")}))})),!l&&Object(k.f)("div",null,Object(k.f)(U.b,{size:"small",icon:Object(k.f)(B.b,{isCircled:!0}),onClick:function(e){e.preventDefault();var t=[].concat(y()(r),[""]);o(t)}},Object(N.b)("Add Overlay"))))}K.displayName="WidgetQueryFields";var X=Object(S.a)(H.a,{target:"e1pigdln0",label:"StyledColumnEditCollection"})("margin-top:",Object(Q.a)(1),";"),$=Object(S.a)("div",{target:"e1pigdln1",label:"QueryFieldWrapper"})("display:flex;align-items:center;justify-content:space-between;margin-bottom:",Object(Q.a)(1),";> * + *{margin-left:",Object(Q.a)(1),";}"),Z=K;function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var re=function(e){f()(n,e);var t=ne(n);function n(){var e;c()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).handleFieldChange=function(t,n){var r=e.props,i=r.queries,o=r.onChange,a=i[t];return function(e){var r=te(te({},a),{},O()({},n,e));o(t,r)}},e}return u()(n,[{key:"getFirstQueryError",value:function(e){var t=this.props.errors;if(t)return t.find((function(t){return t&&t[e]}))}},{key:"render",value:function(){var e,t,n,r=this,i=this.props,o=i.organization,a=i.selection,l=i.errors,c=i.queries,s=i.canAddSearchConditions,u=i.handleAddSearchConditions,d=i.handleDeleteQuery,f=i.displayType,b=i.fieldOptions,p=i.onChange,g=["table","world_map","big_number"].includes(f);return Object(k.f)(ie,null,c.map((function(e,t){return Object(k.f)(Y.a,{key:t,label:0===t?Object(N.b)("Query"):null,inline:!1,style:{paddingBottom:"8px"},flexibleControlStateSize:!0,stacked:!0,error:null==l?void 0:l[t].conditions},Object(k.f)(oe,null,Object(k.f)(ae,{organization:o,projectIds:a.projects,query:e.conditions,fields:[],onSearch:r.handleFieldChange(t,"conditions"),onBlur:r.handleFieldChange(t,"conditions"),useFormWrapper:!1}),!g&&Object(k.f)(le,{type:"text",name:"name",required:!0,value:e.name,placeholder:Object(N.b)("Legend Alias"),onChange:function(e){return r.handleFieldChange(t,"name")(e.target.value)}}),c.length>1&&Object(k.f)(U.b,{size:"zero",borderless:!0,onClick:function(e){e.preventDefault(),d(t)},icon:Object(k.f)(B.r,null),title:Object(N.b)("Remove query"),label:Object(N.b)("Remove query")})))})),s&&Object(k.f)(U.b,{size:"small",icon:Object(k.f)(B.b,{isCircled:!0}),onClick:function(e){e.preventDefault(),u()}},Object(N.b)("Add Query")),Object(k.f)(Z,{displayType:f,fieldOptions:b,errors:this.getFirstQueryError("fields"),fields:c[0].fields,onChange:function(e){c.forEach((function(t,n){var r=T()(t);r.fields=e,p(n,r)}))}}),"table"===f&&Object(k.f)(Y.a,{label:Object(N.b)("Sort by"),inline:!1,flexibleControlStateSize:!0,stacked:!0,error:null===(e=this.getFirstQueryError("orderby"))||void 0===e?void 0:e.orderby,style:{marginBottom:Object(Q.a)(1)}},Object(k.f)(W.a,{value:c[0].orderby,name:"orderby",options:(t=c[0].fields,n=[],t.forEach((function(e){var t=Object(G.n)(e);n.push({label:Object(N.b)("%s asc",e),value:t}),n.push({label:Object(N.b)("%s desc",e),value:"-".concat(t)})})),n),onChange:function(e){return r.handleFieldChange(0,"orderby")(e.value)},onSelectResetsInput:!1,onCloseResetsInput:!1,onBlurResetsInput:!1})))}}]),n}(x.a.Component);re.displayName="WidgetQueriesForm";var ie=Object(S.a)("div",{target:"e15gdnm00",label:"QueryWrapper"})({name:"79elbk",styles:"position:relative;"}),oe=Object(S.a)("div",{target:"e15gdnm01",label:"SearchConditionsWrapper"})("display:flex;align-items:center;> * + *{margin-left:",Object(Q.a)(1),";}"),ae=Object(S.a)(L.a,{target:"e15gdnm02",label:"StyledSearchBar"})({name:"i9gxme",styles:"flex-grow:1;"}),le=Object(S.a)(_.a,{target:"e15gdnm03",label:"LegendAliasInput"})({name:"1e2wulm",styles:"width:33%;"}),ce=re,se=n(96),ue=n(2008),de=n(47),fe=n(328),be=n(2009),pe=n(2377),ge=n(2438),he=n(704);function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}function ye(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ve(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce={name:"",fields:["count()"],conditions:"",orderby:""};function Se(e,t){return Object.keys(e).forEach((function(n){var r=e[n];Array.isArray(r)&&"string"==typeof r[0]?t[n]=r[0]:Array.isArray(r)&&"object"===C()(r[0])?t[n]=r.map((function(e){return Se(e,{})})):t[n]=Se(r,{})})),t}function we(e,t){var n=["line","area","stacked_area","bar"].includes(e);if(["table","world_map","big_number"].includes(e)?t=t.slice(0,1):n&&(t=t.slice(0,3)),"table"===e)return t;if(t=t.map((function(e){var t=e.fields.filter(G.q);return n&&t.length&&t.length>3&&(t=t.slice(0,3)),je(je({},e),{},{fields:t.length?t:["count()"]})})),n){var r,i=y()(t[0].fields),o=ye(t);try{e:for(o.s();!(r=o.n()).done;){var a=r.value;if(i.length>=3)break;if(!R()(i,a.fields)){var l,c=ye(a.fields);try{for(c.s();!(l=c.n()).done;){var s=l.value;if(i.length>=3)break e;i.includes(s)||i.push(s)}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){o.e(e)}finally{o.f()}t=t.map((function(e){return je(je({},e),{},{fields:i})}))}return["world_map","big_number"].includes(e)&&(t=t.map((function(e){return je(je({},e),{},{fields:e.fields.slice(0,1)})}))),t}var xe=function(e){f()(n,e);var t=me(n);function n(e){var r;c()(this,n),(r=t.call(this,e)).handleSubmit=function(){var e=a()(i.a.mark((function e(t){var n,o,a,l,c,s,u,d,f,b;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=r.props,o=n.api,a=n.closeModal,l=n.organization,c=n.onAddWidget,s=n.onUpdateWidget,u=n.widget,r.setState({loading:!0}),e.prev=3,d=A()(r.state,["title","displayType","interval","queries"]),e.next=7,Object(z.d)(o,l.slug,d);case 7:"function"==typeof s&&u?(s(je({id:null==u?void 0:u.id},d)),Object(I.c)(Object(N.b)("Updated widget."))):(c(d),Object(I.c)(Object(N.b)("Added widget."))),a(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),b=Se(null!==(f=null===e.t0||void 0===e.t0?void 0:e.t0.responseJSON)&&void 0!==f?f:{},{}),r.setState({errors:b});case 15:return e.prev=15,r.setState({loading:!1}),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[3,11,15,18]])})));return function(t){return e.apply(this,arguments)}}(),r.handleFieldChange=function(e){return function(t){r.setState((function(n){var r=T()(n);if(q()(r,e,t),"displayType"===e){var i=t;q()(r,"queries",we(i,n.queries))}return je(je({},r),{},{errors:void 0})}))}},r.handleQueryChange=function(e,t){r.setState((function(n){var r=T()(n);return q()(r,"queries.".concat(t),e),je(je({},r),{},{errors:void 0})}))},r.handleQueryRemove=function(e){r.setState((function(t){var n=T()(t);return n.queries.splice(e,e+1),je(je({},n),{},{errors:void 0})}))},r.handleAddSearchConditions=function(){r.setState((function(e){var t=T()(e);return t.queries.push(T()(Ce)),t}))};var o=e.widget;return o?(r.state={title:o.title,displayType:o.displayType,interval:o.interval,queries:we(o.displayType,o.queries),errors:void 0,loading:!1},r):(r.state={title:"",displayType:"line",interval:"5m",queries:[je({},Ce)],errors:void 0,loading:!1},p()(r))}return u()(n,[{key:"canAddSearchConditions",value:function(){var e=["line","area","stacked_area","bar"].includes(this.state.displayType),t=this.state.queries.length<3;return e&&t}},{key:"render",value:function(){var e=this,t=this.props,n=t.Footer,r=t.Body,i=t.Header,o=t.api,a=t.closeModal,l=t.organization,c=t.selection,s=t.tags,u=t.onUpdateWidget,d=t.widget,f=this.state,b=f.errors,p="function"==typeof u&&!!d;return Object(k.f)(x.a.Fragment,null,Object(k.f)(i,{closeButton:!0,onHide:a},Object(k.f)("h4",null,p?Object(N.b)("Edit Widget"):Object(N.b)("Add Widget"))),Object(k.f)(r,null,Object(k.f)(ke,null,Object(k.f)(Y.a,{"data-test-id":"widget-name",label:Object(N.b)("Widget Name"),inline:!1,flexibleControlStateSize:!0,stacked:!0,error:null==b?void 0:b.title,required:!0},Object(k.f)(_.a,{type:"text",name:"title",maxLength:255,required:!0,value:f.title,onChange:function(t){e.handleFieldChange("title")(t.target.value)}})),Object(k.f)(Y.a,{"data-test-id":"chart-type",label:Object(N.b)("Visualization Display"),inline:!1,flexibleControlStateSize:!0,stacked:!0,error:null==b?void 0:b.displayType,required:!0},Object(k.f)(W.a,{required:!0,options:pe.b.slice(),name:"displayType",label:Object(N.b)("Visualization Display"),value:f.displayType,onChange:function(t){e.handleFieldChange("displayType")(t.value)}}))),Object(k.f)(ue.a,null,(function(t){var n=t.measurements,r=function(e){return Object(he.c)({organization:l,tagKeys:Object.values(s).map((function(e){return e.key})),measurementKeys:e})}(Object.values(n).map((function(e){return e.key})));return Object(k.f)(ce,{organization:l,selection:c,fieldOptions:r,displayType:f.displayType,queries:f.queries,errors:null==b?void 0:b.queries,onChange:function(t,n){return e.handleQueryChange(n,t)},canAddSearchConditions:e.canAddSearchConditions(),handleAddSearchConditions:e.handleAddSearchConditions,handleDeleteQuery:e.handleQueryRemove})})),Object(k.f)(ge.a,{api:o,organization:l,selection:c,widget:this.state,isEditing:!1,onDelete:function(){},onEdit:function(){},renderErrorMessage:function(e){return"string"==typeof e&&Object(k.f)(se.b,{type:"error"},e)},isSorting:!1,currentWidgetDragging:!1})),Object(k.f)(n,null,Object(k.f)(M.a,{gap:1},Object(k.f)(U.b,{external:!0,href:"https://docs.sentry.io/product/dashboards/custom-dashboards/#widget-builder"},Object(N.b)("Read the docs")),Object(k.f)(U.b,{"data-test-id":"add-widget",priority:"primary",type:"button",onClick:this.handleSubmit,disabled:f.loading,busy:f.loading},p?Object(N.b)("Update Widget"):Object(N.b)("Add Widget")))))}}]),n}(x.a.Component);xe.displayName="AddDashboardWidgetModal";var ke=Object(S.a)("div",{target:"e1mshziv0",label:"DoubleFieldWrapper"})("display:inline-grid;grid-template-columns:repeat(2,1fr);grid-column-gap:",Object(Q.a)(1),";width:100%;"),De={name:"1luw0r8-modalCss",styles:".modal-dialog{position:unset;width:100%;max-width:700px;margin:70px auto;};label:modalCss;"};t.default=Object(de.a)(Object(fe.a)(Object(be.a)(xe)))},1917:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,i=n(8),o=n.n(i),a=n(2),l=n(61),c=(r={},o()(r,l.e.FP,{slug:"fp",name:Object(a.b)("First Paint"),acronym:"FP",description:Object(a.b)("Render time of the first pixel loaded in the viewport (may overlap with FCP)."),poorThreshold:3e3,type:Object(l.s)(l.e.FP)}),o()(r,l.e.FCP,{slug:"fcp",name:Object(a.b)("First Contentful Paint"),acronym:"FCP",description:Object(a.b)("Render time of the first image, text or other DOM node in the viewport."),poorThreshold:3e3,type:Object(l.s)(l.e.FCP)}),o()(r,l.e.LCP,{slug:"lcp",name:Object(a.b)("Largest Contentful Paint"),acronym:"LCP",description:Object(a.b)("Render time of the largest image, text or other DOM node in the viewport."),poorThreshold:4e3,type:Object(l.s)(l.e.LCP)}),o()(r,l.e.FID,{slug:"fid",name:Object(a.b)("First Input Delay"),acronym:"FID",description:Object(a.b)("Response time of the browser to a user interaction (clicking, tapping, etc)."),poorThreshold:300,type:Object(l.s)(l.e.FID)}),o()(r,l.e.CLS,{slug:"cls",name:Object(a.b)("Cumulative Layout Shift"),acronym:"CLS",description:Object(a.b)("Sum of layout shift scores that measure the visual stability of the page."),poorThreshold:.25,type:Object(l.s)(l.e.CLS)}),o()(r,l.e.TTFB,{slug:"ttfb",name:Object(a.b)("Time to First Byte"),acronym:"TTFB",description:Object(a.b)("The time that it takes for a user's browser to receive the first byte of page content."),poorThreshold:600,type:Object(l.s)(l.e.TTFB)}),o()(r,l.e.RequestTime,{slug:"ttfb.requesttime",name:Object(a.b)("Request Time"),acronym:"RT",description:Object(a.b)("Captures the time spent making the request and receiving the first byte of the response."),poorThreshold:600,type:Object(l.s)(l.e.RequestTime)}),r)},2056:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){var t={userSelect:document.body.style.userSelect,MozUserSelect:document.body.style.MozUserSelect,msUserSelect:document.body.style.msUserSelect,webkitUserSelect:document.body.style.webkitUserSelect};return document.body.style.userSelect=e.userSelect||"",document.body.style.MozUserSelect=e.MozUserSelect||"",document.body.style.msUserSelect=e.msUserSelect||"",document.body.style.webkitUserSelect=e.webkitUserSelect||"",t}},2324:function(e,t,n){"use strict";var r=n(24),i=n.n(r),o=n(9),a=n.n(o),l=n(10),c=n.n(l),s=n(11),u=n.n(s),d=n(12),f=n.n(d),b=n(7),p=n.n(b),g=n(3),h=n(1),m=n.n(h),y=n(42),v=n.n(y),O=n(27),j=n(1897),C=n(15),S=n(2),w=n(6),x=n(38);function k(e,t){var n="nativeEvent"in e?e.nativeEvent:e;return window.TouchEvent&&n instanceof TouchEvent?n.targetTouches[0][t]:n instanceof MouseEvent?n[t]:0}var D=n(2056),T=n(2175),F=n(0);function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var P,A="draggable-item";!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"}(P||(P={}));var E=function(e){u()(n,e);var t=R(n);function n(){var e;a()(this,n);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={isDragging:!1,draggingIndex:void 0,draggingTargetIndex:void 0,draggingGrabbedOffset:void 0,left:void 0,top:void 0},e.previousUserSelect=null,e.portal=null,e.dragGhostRef=m.a.createRef(),e.handleAddColumn=function(){e.props.onChange([].concat(i()(e.props.columns),[{kind:"field",field:""}]))},e.handleUpdateColumn=function(t,n){var r=i()(e.props.columns);r.splice(t,1,n),e.props.onChange(r)},e.onDragMove=function(t){var n,r,i=e.state,o=i.isDragging,a=i.draggingTargetIndex,l=i.draggingGrabbedOffset;if(o&&["mousemove","touchmove"].includes(t.type)){t.preventDefault(),t.stopPropagation();var c=k(t,"pageX"),s=k(t,"pageY"),u=null!==(n=null==l?void 0:l.x)&&void 0!==n?n:0,d=null!==(r=null==l?void 0:l.y)&&void 0!==r?r:0;if(e.dragGhostRef.current){var f=e.dragGhostRef.current;f.style.left="".concat(c-u,"px"),f.style.top="".concat(s-d,"px")}var b=document.querySelectorAll(".".concat(A)),p=Array.from(b).findIndex((function(e){var t=e.getBoundingClientRect(),n=s,r=window.scrollY+t.top,i=window.scrollY+t.top+t.height;return n>=r&&n<=i}));p>=0&&p!==a&&e.setState({draggingTargetIndex:p})}},e.onDragEnd=function(t){if(e.state.isDragging&&["mouseup","touchend"].includes(t.type)){var n=e.state.draggingIndex,r=e.state.draggingTargetIndex;if("number"==typeof n&&"number"==typeof r){e.cleanUpListeners(),e.previousUserSelect&&(Object(D.a)(e.previousUserSelect),e.previousUserSelect=null);var o=i()(e.props.columns),a=o.splice(n,1);o.splice(r,0,a[0]),e.props.onChange(o),e.setState({isDragging:!1,left:void 0,top:void 0,draggingIndex:void 0,draggingTargetIndex:void 0,draggingGrabbedOffset:void 0})}}},e}return c()(n,[{key:"componentDidMount",value:function(){if(!this.portal){var e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.zIndex=String(x.c.zIndex.modal),this.portal=e,document.body.appendChild(this.portal)}}},{key:"componentWillUnmount",value:function(){this.portal&&document.body.removeChild(this.portal),this.cleanUpListeners()}},{key:"keyForColumn",value:function(e,t){return"function"===e.kind?[].concat(i()(e.function),[t]).join(":"):[].concat(i()(e.field),[t]).join(":")}},{key:"cleanUpListeners",value:function(){this.state.isDragging&&(window.removeEventListener("mousemove",this.onDragMove),window.removeEventListener("touchmove",this.onDragMove),window.removeEventListener("mouseup",this.onDragEnd),window.removeEventListener("touchend",this.onDragEnd))}},{key:"removeColumn",value:function(e){var t=i()(this.props.columns);t.splice(e,1),this.props.onChange(t)}},{key:"startDrag",value:function(e,t){if(!this.state.isDragging&&["mousedown","touchstart"].includes(e.type)){e.preventDefault(),e.stopPropagation();var n=k(e,"pageY"),r=k(e,"pageX"),i=Array.from(document.querySelectorAll(".".concat(A))).find((function(t){return t.contains(e.currentTarget)})).getBoundingClientRect(),o={x:r-i.x+4,y:n-i.y+4};this.previousUserSelect=Object(D.a)({userSelect:"none",MozUserSelect:"none",msUserSelect:"none",webkitUserSelect:"none"}),window.addEventListener("mousemove",this.onDragMove),window.addEventListener("touchmove",this.onDragMove),window.addEventListener("mouseup",this.onDragEnd),window.addEventListener("touchend",this.onDragEnd),this.setState({isDragging:!0,draggingIndex:t,draggingTargetIndex:t,draggingGrabbedOffset:o,top:n,left:r})}}},{key:"renderGhost",value:function(e){var t,n,r=this.state,i=r.isDragging,o=r.draggingIndex,a=r.draggingGrabbedOffset,l=o;if("number"!=typeof l||!i||!this.portal)return null;var c=null!==(t=null==a?void 0:a.x)&&void 0!==t?t:0,s=null!==(n=null==a?void 0:a.y)&&void 0!==n?n:0,u=Number(this.state.top)-s,d=Number(this.state.left)-c,f=this.props.columns[l],b={top:"".concat(u,"px"),left:"".concat(d,"px")},p=Object(F.f)(z,{ref:this.dragGhostRef,style:b},this.renderItem(f,l,{isGhost:!0,gridColumns:e}));return v.a.createPortal(p,this.portal)}},{key:"renderItem",value:function(e,t,n){var r=this,i=n.canDelete,o=void 0===i||i,a=n.isGhost,l=void 0!==a&&a,c=n.gridColumns,s=void 0===c?2:c,u=this.props.fieldOptions,d=this.state,f=d.isDragging,b=d.draggingTargetIndex,p=d.draggingIndex,g=null;if(f&&!1===l&&b===t&&(g=Object(F.f)(I,{key:"placeholder:".concat(this.keyForColumn(e,l)),className:A})),f&&!1===l&&p===t)return g;var h=Number(b)<=Number(p)?P.TOP:P.BOTTOM;return Object(F.f)(m.a.Fragment,{key:"".concat(t,":").concat(this.keyForColumn(e,l))},h===P.TOP&&g,Object(F.f)(q,{className:l?"":A},o?Object(F.f)(O.b,{"aria-label":Object(S.b)("Drag to reorder"),onMouseDown:function(e){return r.startDrag(e,t)},onTouchStart:function(e){return r.startDrag(e,t)},icon:Object(F.f)(C.H,{size:"xs"}),size:"zero",borderless:!0}):Object(F.f)("span",null),Object(F.f)(T.a,{fieldOptions:u,gridColumns:s,fieldValue:e,onChange:function(e){return r.handleUpdateColumn(t,e)},takeFocus:t===this.props.columns.length-1}),o?Object(F.f)(O.b,{"aria-label":Object(S.b)("Remove column"),onClick:function(){return r.removeColumn(t)},icon:Object(F.f)(C.r,null),borderless:!0}):Object(F.f)("span",null)),h===P.BOTTOM&&g)}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.columns,o=r.length>1,a=r.length<20,l=a?void 0:"Sorry, you reached the maximum number of columns. Delete columns to add more.",c=Math.max.apply(Math,i()(r.map((function(e){return"function"===e.kind&&void 0!==e.function[2]?3:2}))));return Object(F.f)("div",{className:n},this.renderGhost(c),Object(F.f)(q,null,Object(F.f)(M,{gridColumns:c},Object(F.f)(L,null,Object(S.b)("Tag / Field / Function")),Object(F.f)(L,null,Object(S.b)("Field Parameter")))),r.map((function(t,n){return e.renderItem(t,n,{canDelete:o,gridColumns:c})})),Object(F.f)(q,null,Object(F.f)(U,null,Object(F.f)(O.b,{size:"small",label:Object(S.b)("Add a Column"),onClick:this.handleAddColumn,title:l,disabled:!a,icon:Object(F.f)(C.b,{isCircled:!0,size:"xs"})},Object(S.b)("Add a Column")))))}}]),n}(m.a.Component);E.displayName="ColumnEditCollection";var q=Object(g.a)("div",{target:"epvkpxc0",label:"RowContainer"})("display:grid;grid-template-columns:",Object(w.a)(3)," 1fr ",Object(w.a)(3),";justify-content:center;align-items:center;width:100%;touch-action:none;padding-bottom:",Object(w.a)(1),";"),z=Object(g.a)("div",{target:"epvkpxc1",label:"Ghost"})("background:",(function(e){return e.theme.background}),";display:block;position:absolute;padding:",4,"px;border-radius:",(function(e){return e.theme.borderRadius}),";box-shadow:0 0 15px rgba(0,0,0,0.15);width:710px;opacity:0.8;cursor:grabbing;padding-right:",Object(w.a)(2),";& > ",q,"{padding-bottom:0;}& svg{cursor:grabbing;}"),I=Object(g.a)("div",{target:"epvkpxc2",label:"DragPlaceholder"})("margin:0 ",Object(w.a)(3)," ",Object(w.a)(1)," ",Object(w.a)(3),";border:2px dashed ",(function(e){return e.theme.border}),";border-radius:",(function(e){return e.theme.borderRadius}),";height:41px;"),U=Object(g.a)("div",{target:"epvkpxc3",label:"Actions"})({name:"1x09e8q",styles:"grid-column:2 / 3;"}),M=Object(g.a)("div",{target:"epvkpxc4",label:"Heading"})("grid-column:2 / 3;display:grid;grid-template-columns:repeat(",(function(e){return e.gridColumns}),",1fr);grid-column-gap:",Object(w.a)(1),";"),L=Object(g.a)(j.f,{target:"epvkpxc5",label:"StyledSectionHeading"})({name:"1uk1gs8",styles:"margin:0;"});t.a=E}}]);
//# sourceMappingURL=AddDashboardWidgetModal.js.map