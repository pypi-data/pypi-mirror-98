(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[197],{2314:function(t,e,n){"use strict";var r=n(9),a=n.n(r),c=n(10),o=n.n(c),s=n(11),i=n.n(s),l=n(12),u=n.n(l),f=n(7),p=n.n(f),d=n(3),j=n(1),h=n.n(j),b=n(62),m=n(5),g=n.n(m),v=n(14),y=n.n(v),O=n(0);function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return u()(this,n)}}var P=function(t){i()(n,t);var e=k(n);function n(){return a()(this,n),e.apply(this,arguments)}return o()(n,[{key:"render",value:function(){var t=this.props,e=t.project,n=y()(t,["project"]);return Object(O.f)("span",g()({className:"project-label"},n),Object(O.f)("span",{className:"project-name"},e.slug))}}]),n}(h.a.PureComponent);P.displayName="ProjectLabel";var R=n(770),S=n(6);function z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return u()(this,n)}}var x=function(t){i()(n,t);var e=z(n);function n(){var t;a()(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(t=e.call.apply(e,[this].concat(c))).state={isBookmarked:t.props.project.isBookmarked},t.handleToggleBookmark=function(e){t.setState({isBookmarked:e})},t}return o()(n,[{key:"render",value:function(){var t=this.props,e=t.project,n=t.organization;return Object(O.f)(I,null,Object(O.f)(L,{organization:n,project:e,isBookmarked:this.state.isBookmarked,onToggle:this.handleToggleBookmark}),Object(O.f)(b.a,{to:"/settings/".concat(n.slug,"/projects/").concat(e.slug,"/")},Object(O.f)(P,{project:e})))}}]),n}(h.a.Component);x.displayName="ProjectItem";var I=Object(d.a)("div",{target:"e15nsoxf0",label:"Wrapper"})({name:"70qvj9",styles:"display:flex;align-items:center;"}),L=Object(d.a)(R.a,{target:"e15nsoxf1",label:"BookmarkLink"})("margin-right:",Object(S.a)(1),";margin-top:-",Object(S.a)(.25),";");e.a=x},2817:function(t,e,n){"use strict";n.r(e),n.d(e,"TeamProjects",(function(){return W}));var r=n(5),a=n.n(r),c=n(30),o=n.n(c),s=n(9),i=n.n(s),l=n(10),u=n.n(l),f=n(11),p=n.n(f),d=n(12),j=n.n(d),h=n(7),b=n.n(h),m=n(3),g=n(1),v=n.n(g),y=n(33),O=n(48),k=n(27),P=n(229),R=n(265),S=n(131),z=n(44),x=n(694),I=n(96),L=n(31),T=n(15),w=n(2),A=n(6),q=n(18),B=n(47),C=n(54),D=n(440),N=n(2314),U=n(0);function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var a=b()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}var W=function(t){p()(n,t);var e=E(n);function n(){var t;i()(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={error:!1,loading:!0,pageLinks:null,unlinkedProjects:[],linkedProjects:[]},t.fetchAll=function(){t.fetchTeamProjects(),t.fetchUnlinkedProjects()},t.handleLinkProject=function(e,n){var r=t.props.params,a=r.orgId,c=r.teamId;t.props.api.request("/projects/".concat(a,"/").concat(e.slug,"/teams/").concat(c,"/"),{method:"add"===n?"POST":"DELETE",success:function(e){t.fetchAll(),O.a.updateSuccess(e),Object(y.c)("add"===n?Object(w.b)("Successfully added project to team."):Object(w.b)("Successfully removed project from team"))},error:function(){Object(y.a)(Object(w.b)("Wasn't able to change project association."))}})},t.handleProjectSelected=function(e){var n=t.state.unlinkedProjects.find((function(t){return t.id===e.value}));n&&t.handleLinkProject(n,"add")},t.handleQueryUpdate=function(e){t.fetchUnlinkedProjects(e.target.value)},t}return u()(n,[{key:"componentDidMount",value:function(){this.fetchAll()}},{key:"componentDidUpdate",value:function(t){t.params.orgId===this.props.params.orgId&&t.params.teamId===this.props.params.teamId||this.fetchAll(),t.location!==this.props.location&&this.fetchTeamProjects()}},{key:"fetchTeamProjects",value:function(){var t=this,e=this.props,n=e.location,r=e.params,a=r.orgId,c=r.teamId;this.setState({loading:!0}),this.props.api.requestPromise("/organizations/".concat(a,"/projects/"),{query:{query:"team:".concat(c),cursor:n.query.cursor||""},includeAllArgs:!0}).then((function(e){var n,r=o()(e,3),a=r[0],c=(r[1],r[2]);t.setState({loading:!1,error:!1,linkedProjects:a,pageLinks:null!==(n=null==c?void 0:c.getResponseHeader("Link"))&&void 0!==n?n:null})})).catch((function(){t.setState({loading:!1,error:!0})}))}},{key:"fetchUnlinkedProjects",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=this.props.params,r=n.orgId,a=n.teamId;this.props.api.requestPromise("/organizations/".concat(r,"/projects/"),{query:{query:e?"!team:".concat(a," ").concat(e):"!team:".concat(a)}}).then((function(e){t.setState({unlinkedProjects:e})}))}},{key:"projectPanelContents",value:function(t){var e=this,n=this.props.organization,r=new Set(n.access).has("org:write");return t.length?Object(q.u)(t).map((function(t){return Object(U.f)(M,{key:t.id},Object(U.f)(N.a,{project:t,organization:n}),Object(U.f)(L.a,{disabled:r,title:Object(w.b)("You do not have enough permission to change project association.")},Object(U.f)(k.b,{size:"small",disabled:!r,icon:Object(U.f)(T.xb,{isCircled:!0,size:"xs"}),onClick:function(){e.handleLinkProject(t,"remove")}},Object(w.b)("Remove"))))})):Object(U.f)(D.a,{size:"large",icon:Object(U.f)(T.C,{size:"xl"})},Object(w.b)("This team doesn't have access to any projects."))}},{key:"render",value:function(){var t=this,e=this.state,n=e.linkedProjects,r=e.unlinkedProjects,c=e.error,o=e.loading;if(c)return Object(U.f)(S.a,{onRetry:function(){return t.fetchAll()}});if(o)return Object(U.f)(z.default,null);var s=new Set(this.props.organization.access),i=r.map((function(t){return{value:t.id,searchKey:t.slug,label:Object(U.f)(J,null,t.slug)}}));return Object(U.f)(v.a.Fragment,null,Object(U.f)(I.a,null,Object(U.f)(I.e,{hasButtons:!0},Object(U.f)("div",null,Object(w.b)("Projects")),Object(U.f)("div",{style:{textTransform:"none"}},s.has("org:write")?Object(U.f)(P.a,{items:i,onChange:this.handleQueryUpdate,onSelect:this.handleProjectSelected,emptyMessage:Object(w.b)("No projects"),alignMenu:"right"},(function(t){var e=t.isOpen;return Object(U.f)(R.a,{isOpen:e,size:"xsmall"},Object(w.b)("Add Project"))})):Object(U.f)(R.a,{disabled:!0,title:Object(w.b)("You do not have enough permission to associate a project."),size:"xsmall"},Object(w.b)("Add Project")))),Object(U.f)(I.c,null,this.projectPanelContents(n))),Object(U.f)(x.a,a()({pageLinks:this.state.pageLinks},this.props)))}}]),n}(v.a.Component);W.displayName="TeamProjects";var M=Object(m.a)(I.f,{target:"e1em6z4a0",label:"StyledPanelItem"})("display:flex;align-items:center;justify-content:space-between;padding:",Object(A.a)(2),";"),J=Object(m.a)("div",{target:"e1em6z4a1",label:"ProjectListElement"})("padding:",Object(A.a)(.25)," 0;");e.default=Object(B.a)(Object(C.a)(W))}}]);
//# sourceMappingURL=TeamProjects.js.map