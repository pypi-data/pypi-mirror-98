(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[75],{1898:function(t,e,n){"use strict";n.d(e,"a",(function(){return j}));var r=n(9),a=n.n(r),o=n(10),i=n.n(o),c=n(11),u=n.n(c),l=n(12),s=n.n(l),d=n(7),f=n.n(d),b=(n(1),n(264)),p=n.n(b),y=n(693),h=n(0);function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f()(t);if(e){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return s()(this,n)}}var j=function(t){u()(n,t);var e=O(n);function n(){return a()(this,n),e.apply(this,arguments)}return i()(n,[{key:"getTitle",value:function(){return""}},{key:"render",value:function(){var t=this.getTitle();return Object(h.f)(p.a,{title:"".concat(t?"".concat(t," - "):"","Sentry")},this.renderComponent())}}]),n}(y.a);j.displayName="AsyncView"},2166:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r,a=n(5),o=n.n(a),i=n(30),c=n.n(i),u=n(9),l=n.n(u),s=n(10),d=n.n(s),f=n(11),b=n.n(f),p=n(12),y=n.n(p),h=n(7),O=n.n(h),j=n(1),v=n.n(j),g=n(133),w=n.n(g),m=n(59),k=n.n(m),x=n(33),D=n(154),S=n(27),E=n(2),I=n(47),R=n(54),T=n(0);function q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}
//! Coordinate with other ExportQueryType (src/sentry/data_export/base.py)
();return function(){var n,r=O()(t);if(e){var a=O()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return y()(this,n)}}!function(t){t.IssuesByTag="Issues-by-Tag",t.Discover="Discover"}(r||(r={}));var z=function(t){b()(n,t);var e=q(n);function n(){var t;l()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).state=t.initialState,t.resetState=function(){t.setState(t.initialState)},t.startDataExport=function(){var e=t.props,n=e.api,r=e.organization.slug,a=e.payload,o=a.queryType,i=a.queryInfo;t.setState({inProgress:!0}),n.requestPromise("/organizations/".concat(r,"/data-export/"),{includeAllArgs:!0,method:"POST",data:{query_type:o,query_info:i}}).then((function(t){var e=c()(t,3),n=(e[0],e[1],e[2]);Object(x.c)(201===(null==n?void 0:n.status)?Object(E.b)("Sit tight. We'll shoot you an email when your data is ready for download."):Object(E.b)("It looks like we're already working on it. Sit tight, we'll email you."))})).catch((function(e){var n,r,a=null!==(n=null==e||null===(r=e.responseJSON)||void 0===r?void 0:r.detail)&&void 0!==n?n:"We tried our hardest, but we couldn't export your data. Give it another go.";Object(x.a)(Object(E.b)(a)),t.setState({inProgress:!1})}))},t}return d()(n,[{key:"componentDidUpdate",value:function(t){var e=t.payload,n=this.props.payload;k()(e,n)||this.resetState()}},{key:"render",value:function(){var t=this.state.inProgress,e=this.props,n=e.children,r=e.disabled,a=e.icon;return Object(T.f)(D.a,{features:["organizations:discover-query"]},t?Object(T.f)(S.b,o()({size:"small",priority:"default",title:"You can get on with your life. We'll email you when your data's ready."},this.props,{disabled:!0,icon:a}),Object(E.b)("We're working on it...")):Object(T.f)(S.b,o()({onClick:w()(this.startDataExport,500),disabled:r||!1,size:"small",priority:"default",title:"Put your data to work. Start your export and we'll email you when it's finished.",icon:a},this.props),n||Object(E.b)("Export All to CSV")))}},{key:"initialState",get:function(){return{inProgress:!1}}}]),n}(v.a.Component);z.displayName="DataExport",e.b=Object(I.a)(Object(R.a)(z))},2824:function(t,e,n){"use strict";n.r(e),n.d(e,"DownloadStatus",(function(){return r}));var r,a=n(9),o=n.n(a),i=n(10),c=n.n(i),u=n(11),l=n.n(u),s=n(12),d=n.n(s),f=n(7),b=n.n(f),p=n(3),y=n(1),h=n.n(y),O=n(22),j=n(27),v=n(2166),g=n(441),w=n(15),m=n(2),k=n(6),x=n(1898),D=n(897),S=n(0);function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var a=b()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return d()(this,n)}}!function(t){t.Early="EARLY",t.Valid="VALID",t.Expired="EXPIRED"}(r||(r={}));var I=function(t){l()(n,t);var e=E(n);function n(){return o()(this,n),e.apply(this,arguments)}return c()(n,[{key:"getTitle",value:function(){return Object(m.b)("Download Center")}},{key:"getEndpoints",value:function(){var t=this.props.params,e=t.orgId,n=t.dataExportId;return[["download","/organizations/".concat(e,"/data-export/").concat(n,"/")]]}},{key:"getActionLink",value:function(t){var e=this.props.params.orgId;switch(t){case v.a.IssuesByTag:return"/organizations/".concat(e,"/issues/");case v.a.Discover:return"/organizations/".concat(e,"/discover/queries/");default:return"/"}}},{key:"renderDate",value:function(t){if(!t)return null;var e=new Date(t);return Object(S.f)("strong",null,Object(S.f)(g.a,{date:e}))}},{key:"renderEarly",value:function(){return Object(S.f)(h.a.Fragment,null,Object(S.f)(R,null,Object(S.f)("h3",null,Object(m.b)("What are"),Object(S.f)("i",null,Object(m.b)(" you ")),Object(m.b)("doing here?"))),Object(S.f)(T,null,Object(S.f)("p",null,Object(m.b)("Not that its any of our business, but were you invited to this page? It's just that we don't exactly remember emailing you about it.")),Object(S.f)("p",null,Object(m.b)("Close this window and we'll email you when your download is ready."))))}},{key:"renderExpired",value:function(){var t=this.state.download.query,e=this.getActionLink(t.type);return Object(S.f)(h.a.Fragment,null,Object(S.f)(R,null,Object(S.f)("h3",null,Object(m.b)("This is awkward."))),Object(S.f)(T,null,Object(S.f)("p",null,Object(m.b)("That link expired, so your download doesn't live here anymore. Just picked up one day and left town.")),Object(S.f)("p",null,Object(m.b)("Make a new one with your latest data. Your old download will never see it coming.")),Object(S.f)(q,{href:e,priority:"primary"},Object(m.b)("Start a New Download"))))}},{key:"openInDiscover",value:function(){var t=this.state.download.query.info,e=this.props.params.orgId,n={pathname:"/organizations/".concat(e,"/discover/results/"),query:t};O.browserHistory.push(n)}},{key:"renderOpenInDiscover",value:function(){var t=this,e=this.state.download.query,n=(void 0===e?{type:v.a.IssuesByTag,info:{}}:e).type;return"Discover"===(void 0===n?v.a.IssuesByTag:n)?Object(S.f)(h.a.Fragment,null,Object(S.f)("p",null,Object(m.b)("Need to make changes?")),Object(S.f)(j.b,{priority:"primary",onClick:function(){return t.openInDiscover()}},Object(m.b)("Open in Discover")),Object(S.f)("br",null)):null}},{key:"renderValid",value:function(){var t=this.state.download,e=t.dateExpired,n=t.checksum,r=this.props.params,a=r.orgId,o=r.dataExportId;return Object(S.f)(h.a.Fragment,null,Object(S.f)(R,null,Object(S.f)("h3",null,Object(m.b)("All done."))),Object(S.f)(T,null,Object(S.f)("p",null,Object(m.b)("See, that wasn't so bad. Your data is all ready for download.")),Object(S.f)(j.b,{priority:"primary",icon:Object(S.f)(w.t,null),href:"/api/0/organizations/".concat(a,"/data-export/").concat(o,"/?download=true")},Object(m.b)("Download CSV")),Object(S.f)("p",null,Object(m.b)("That link won't last forever â€” it expires:"),Object(S.f)("br",null),this.renderDate(e)),this.renderOpenInDiscover(),Object(S.f)("p",null,Object(S.f)("small",null,Object(S.f)("strong",null,"SHA1:",n)),Object(S.f)("br",null),Object(m.c)("Need help verifying? [link].",{link:Object(S.f)("a",{href:"https://docs.sentry.io/product/discover-queries/query-builder/#filter-by-table-columns",target:"_blank",rel:"noopener noreferrer"},Object(m.b)("Check out our docs"))}))))}},{key:"renderError",value:function(){var t,e=this.state.errors.download,n=null==e||null===(t=e.responseJSON)||void 0===t?void 0:t.detail;return Object(S.f)(D.a,null,Object(S.f)("main",null,Object(S.f)(R,null,Object(S.f)("h3",null,e.status," - ",e.statusText)),n&&Object(S.f)(T,null,Object(S.f)("p",null,n))))}},{key:"renderContent",value:function(){switch(this.state.download.status){case r.Early:return this.renderEarly();case r.Expired:return this.renderExpired();default:return this.renderValid()}}},{key:"renderBody",value:function(){return Object(S.f)(D.a,null,Object(S.f)("main",null,this.renderContent()))}}]),n}(x.a),R=Object(p.a)("header",{target:"e1os4l6w0",label:"Header"})("border-bottom:1px solid ",(function(t){return t.theme.border}),";padding:",Object(k.a)(3)," 40px 0;h3{font-size:24px;margin:0 0 ",Object(k.a)(3)," 0;}"),T=Object(p.a)("div",{target:"e1os4l6w1",label:"Body"})("padding:",Object(k.a)(2)," 40px;max-width:500px;p{margin:",Object(k.a)(1.5)," 0;}"),q=Object(p.a)(j.b,{target:"e1os4l6w2",label:"DownloadButton"})("margin-bottom:",Object(k.a)(1.5),";");e.default=I}}]);
//# sourceMappingURL=DataDownloadView.js.map