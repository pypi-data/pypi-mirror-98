(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[220],{1898:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(9),o=n.n(r),a=n(10),i=n.n(a),c=n(11),s=n.n(c),u=n(12),l=n.n(u),f=n(7),p=n.n(f),b=(n(1),n(264)),d=n.n(b),h=n(693),v=n(0);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}var m=function(e){s()(n,e);var t=y(n);function n(){return o()(this,n),t.apply(this,arguments)}return i()(n,[{key:"getTitle",value:function(){return""}},{key:"render",value:function(){var e=this.getTitle();return Object(v.f)(d.a,{title:"".concat(e?"".concat(e," - "):"","Sentry")},this.renderComponent())}}]),n}(h.a);m.displayName="AsyncView"},1899:function(e,t,n){"use strict";var r=n(14),o=n.n(r),a=n(9),i=n.n(a),c=n(10),s=n.n(c),u=n(11),l=n.n(u),f=n(12),p=n.n(f),b=n(7),d=n.n(b),h=n(3),v=n(1),y=n.n(v),m=n(222),O=n(6),g=n(0);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d()(e);if(t){var o=d()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var w=function(e){l()(n,e);var t=j(n);function n(){return i()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.title,r=e.subtitle,a=e.action,i=e.tabs,c=e.noTitleStyles,s=e.body,u=o()(e,["icon","title","subtitle","action","tabs","noTitleStyles","body"]),l=!r;return Object(g.f)("div",u,Object(g.f)(k,{isNarrow:l},Object(g.f)(S,null,t&&Object(g.f)(P,null,t),n&&Object(g.f)(x,{tabs:i,styled:c},Object(g.f)(m.a,null,n),r&&Object(g.f)(R,null,r))),a&&Object(g.f)(D,{isNarrow:l},a)),s&&Object(g.f)(C,null,s),i&&Object(g.f)(T,null,i))}}]),n}(y.a.Component);w.displayName="UnstyledSettingsPageHeader",w.defaultProps={noTitleStyles:!1};var k=Object(h.a)("div",{target:"e1uay4fd0",label:"TitleAndActions"})("display:flex;align-items:",(function(e){return e.isNarrow?"center":"flex-start"}),";"),S=Object(h.a)("div",{target:"e1uay4fd1",label:"TitleWrapper"})({name:"1rr4qq7",styles:"flex:1;"}),x=Object(h.a)("div",{target:"e1uay4fd2",label:"Title"})((function(e){return!e.styled&&"font-size: 20px; font-weight: 600;"}),";margin:",Object(O.a)(4)," ",Object(O.a)(2)," ",Object(O.a)(3)," 0;"),R=Object(h.a)("div",{target:"e1uay4fd3",label:"Subtitle"})("color:",(function(e){return e.theme.gray400}),";font-weight:400;font-size:",(function(e){return e.theme.fontSizeLarge}),";padding:",Object(O.a)(1.5)," 0 0;"),P=Object(h.a)("div",{target:"e1uay4fd4",label:"Icon"})("margin-right:",Object(O.a)(1),";"),D=Object(h.a)("div",{target:"e1uay4fd5",label:"Action"})("margin-top:",(function(e){return e.isNarrow?"0":Object(O.a)(4)}),";"),I=Object(h.a)(w,{target:"e1uay4fd6",label:"SettingsPageHeader"})("font-size:14px;margin-top:-",Object(O.a)(4),";"),C=Object(h.a)("div",{target:"e1uay4fd7",label:"BodyWrapper"})("flex:1;margin:0 0 ",Object(O.a)(3),";"),T=Object(h.a)("div",{target:"e1uay4fd8",label:"TabsWrapper"})({name:"8k0ai7",styles:"flex:1;margin:0;"});t.a=I},1911:function(e,t,n){"use strict";t.a=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,o="".concat(e," - ").concat(t),a=r?"".concat(o," - ").concat(r):o;return n?"".concat(a," - Sentry"):a}},2153:function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return w}));var r=n(30),o=n.n(r),a=n(24),i=n.n(a),c=n(8),s=n.n(c),u=n(753),l=n.n(u),f=n(2154),p=n.n(f),b=n(296),d=n.n(b);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={read:0,write:1,admin:2},m={project:"Project",team:"Team",release:"Release",event:"Event",org:"Organization",member:"Member"},O={Project:"no-access",Team:"no-access",Release:"no-access",Event:"no-access",Organization:"no-access",Member:"no-access"},g=function(e){var t=e.split(":")[1];return y[t]},j=function(e,t){return g(e)-g(t)};function w(e){var t,n=v({},O),r=i()(e);return e.includes("project:releases")&&(n.Release="admin",r=e.filter((function(e){return"project:releases"!==e}))),(t=r,Object.values(l()(t,(function(e){return e.split(":")[0]}))).map((function(e){return e.sort(j)})).map((function(e){return e.pop()}))).forEach((function(e){if(e){var t=e.split(":"),r=o()(t,2),a=r[0],i=r[1];n[m[a]]=i}})),n}function k(e){var t=w(e),n=d()(p()(t),["read","write","admin"]);return v(v({},{read:[],write:[],admin:[]}),n)}},2154:function(e,t,n){var r=n(242),o=n(2155),a=Object.prototype,i=a.hasOwnProperty,c=a.toString,s=o((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=c.call(t)),i.call(e,t)?e[t].push(n):e[t]=[n]}),r);e.exports=s},2155:function(e,t,n){var r=n(2156);e.exports=function(e,t){return function(n,o){return r(n,e,t(o),{})}}},2156:function(e,t,n){var r=n(586);e.exports=function(e,t,n,o){return r(e,(function(e,r,a){t(o,n(e),r,a)})),o}},2247:function(e,t,n){"use strict";n.r(t),n.d(t,"publicIntegrationForms",(function(){return l})),n.d(t,"internalIntegrationForms",(function(){return f}));n(1);var r,o,a=n(43),i=n(2),c=n(18),s=n(0),u=function(){return[{name:"name",type:"string",required:!0,placeholder:"e.g. My Integration",label:"Name",help:"Human readable name of your Integration."},{name:"author",type:"string",required:!0,placeholder:"e.g. Acme Software",label:"Author",help:"The company or person who built and maintains this Integration."},{name:"webhookUrl",type:"string",required:!0,label:"Webhook URL",placeholder:"e.g. https://example.com/sentry/webhook/",help:Object(i.c)("All webhook requests for your integration will be sent to this URL. Visit the [webhook_docs:documentation] to see the different types and payloads.",{webhook_docs:Object(s.f)(a.a,{href:"https://docs.sentry.io/product/integrations/integration-platform/webhooks/"})})},{name:"redirectUrl",type:"string",label:"Redirect URL",placeholder:"e.g. https://example.com/sentry/setup/",help:"The URL Sentry will redirect users to after installation."},{name:"verifyInstall",label:"Verify Installation",type:"boolean",help:"If enabled, installations will need to be verified before becoming installed."},{name:"isAlertable",type:"boolean",label:"Alert Rule Action",disabled:function(e){return e.webhookDisabled},disabledReason:"Cannot enable alert rule action without a webhook url",help:Object(i.c)("If enabled, this integration will be available in Issue Alert rules and Metric Alert rules in Sentry. The notification destination is the Webhook URL specified above. More on actions [learn_more:here].",{learn_more:Object(s.f)(a.a,{href:"https://docs.sentry.io/product/alerts-notifications/notifications/"})})},{name:"schema",type:"textarea",label:"Schema",autosize:!0,rows:1,help:Object(i.c)("Schema for your UI components. Click [schema_docs:here] for documentation.",{schema_docs:Object(s.f)(a.a,{href:"https://docs.sentry.io/product/integrations/integration-platform/ui-components/"})}),getValue:function(e){return""===e?{}:JSON.parse(e)},setValue:function(e){var t=JSON.stringify(e,null,2);return"{}"===t?"":t},validate:function(e){var t=e.id,n=e.form;if(!n.schema)return[];try{JSON.parse(n.schema)}catch(e){return[[t,"Invalid JSON"]]}return[]}},{name:"overview",type:"textarea",label:"Overview",autosize:!0,rows:1,help:"Description of your Integration and its functionality."},{name:"allowedOrigins",type:"string",multiline:!0,placeholder:"e.g. example.com",label:"Authorized JavaScript Origins",help:"Separate multiple entries with a newline.",getValue:function(e){return Object(c.i)(e)},setValue:function(e){return e&&"function"==typeof e.join&&e.join("\n")||""}}]},l=[{title:"Public Integration Details",fields:u()}],f=[{title:"Internal Integration Details",fields:(r=u().filter((function(e){return!["redirectUrl","verifyInstall","author"].includes(e.name||"")})),o=r.find((function(e){return"webhookUrl"===e.name})),o&&(o.required=!1),r)}]},2458:function(e,t,n){var r=n(2459)(n(1061));e.exports=r},2459:function(e,t,n){var r=n(242),o=n(271),a=n(341);e.exports=function(e){return function(t,n,i){var c=Object(t);if(!o(t)){var s=r(n,3);t=a(t),n=function(e){return s(c[e],e,c)}}var u=e(t,n,i);return u>-1?c[s?t[u]:u]:void 0}}},2876:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Ve}));var r=n(24),o=n.n(r),a=n(8),i=n.n(a),c=n(20),s=n.n(c),u=n(29),l=n.n(u),f=n(21),p=n.n(f),b=n(187),d=n.n(b),h=n(30),v=n.n(h),y=n(9),m=n.n(y),O=n(10),g=n.n(O),j=n(11),w=n.n(j),k=n(12),S=n.n(k),x=n(7),R=n.n(x),P=n(3),D=n(1),I=n.n(D),C=n(22),T=n(114),E=n.n(T),A=n(149),z=n(532),N=n.n(z),U=n(33),F=n(2);function q(e,t){return L.apply(this,arguments)}function L(){return(L=l()(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(U.b)(),e.prev=1,e.next=4,t.requestPromise("/sentry-apps/".concat(n.slug,"/api-tokens/"),{method:"POST"});case 4:return r=e.sent,Object(U.c)(Object(F.b)("Token successfully added.")),e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(1),Object(U.a)(Object(F.b)("Unable to create token")),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function V(e,t,n){return J.apply(this,arguments)}function J(){return(J=l()(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(U.b)(),e.prev=1,e.next=4,t.requestPromise("/sentry-apps/".concat(n.slug,"/api-tokens/").concat(r,"/"),{method:"DELETE"});case 4:return Object(U.c)(Object(F.b)("Token successfully deleted.")),e.abrupt("return");case 8:throw e.prev=8,e.t0=e.catch(1),Object(U.a)(Object(F.b)("Unable to delete token")),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}var W=n(27),_=n(441),M=n(96),B=n(31),H=n(32),G=n(2247),Y=n(15),$=n(185),K=n(1911),Q=n(1898),X=n(440),Z=n(329),ee=n(726),te=n(699),ne=n(269),re=n(707),oe=n(1899),ae=n(4),ie=n.n(ae),ce=n(2153),se=n(2458),ue=n.n(se),le=n(756),fe=n.n(le),pe=n(333),be=n(0);function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var o=R()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S()(this,n)}}var he=function(e){w()(n,e);var t=de(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).state={permissions:e.props.permissions},e.onChange=function(t,n){var r=e.state.permissions;r[t]=n,e.save(r)},e.save=function(t){e.setState({permissions:t}),e.props.onChange(t),e.context.form.setValue("scopes",e.permissionStateToList())},e}return g()(n,[{key:"permissionStateToList",value:function(){var e=this.state.permissions;return fe()(Object.entries(e),(function(e){var t,n,r,o=v()(e,2),a=o[0],i=o[1];return null===(t=function(e){return ue()(H.E,["resource",e])}(a))||void 0===t||null===(n=t.choices)||void 0===n||null===(r=n[i])||void 0===r?void 0:r.scopes}))}},{key:"render",value:function(){var e=this,t=this.state.permissions;return Object(be.f)(I.a.Fragment,null,H.E.map((function(n){var r=Object.entries(n.choices).map((function(e){var t=v()(e,2);return[t[0],t[1].label]})),o=t[n.resource];return Object(be.f)(pe.a,{name:"".concat(n.resource,"--permission"),key:n.resource,choices:r,help:Object(F.b)(n.help),label:Object(F.b)(n.label||n.resource),onChange:e.onChange.bind(e,n.resource),value:o,defaultValue:o,disabled:e.props.appPublished,disabledReason:Object(F.b)("Cannot update permissions on a published integration")})})))}}]),n}(I.a.Component);he.displayName="PermissionSelection",he.contextTypes={router:ie.a.object.isRequired,form:ie.a.object};var ve=["issue","error"],ye={issue:"created, resolved, assigned",error:"created"},me={issue:"Event",error:"Event"},Oe=n(336),ge=n(54);function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var o=R()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S()(this,n)}}var we=function(e){w()(n,e);var t=je(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).onChange=function(t){var n=t.target.checked,r=e.props.resource;e.props.onChange(r,n)},e}return g()(n,[{key:"render",value:function(){var e=this.props,t=e.resource,n=e.organization,r=e.webhookDisabled,o=e.checked,a=new Set(n.features),i=this.props.disabledFromPermissions||r,c="Must have at least 'Read' permissions enabled for ".concat(t);return"error"!==t||a.has("integrations-event-hooks")||(i=!0,c="Your organization does not have access to the error subscription resource."),r&&(c="Cannot enable webhook subscription without specifying a webhook url"),Object(be.f)(I.a.Fragment,null,Object(be.f)(Re,{key:t},Object(be.f)(B.a,{disabled:!i,title:c},Object(be.f)(xe,{disabled:i},Object(be.f)(Se,null,Object(be.f)(De,null,Object(F.b)("".concat(t))),Object(be.f)(Pe,null,Object(F.b)("".concat(ye[t])))),Object(be.f)(Oe.a,{key:"".concat(t).concat(o),disabled:i,id:t,value:t,checked:o,onChange:this.onChange})))))}}]),n}(I.a.Component);we.displayName="SubscriptionBox",we.defaultProps={webhookDisabled:!1};var ke=Object(ge.a)(we),Se=Object(P.a)("div",{target:"e146sawj0",label:"SubscriptionInfo"})({name:"j7qwjs",styles:"display:flex;flex-direction:column;"}),xe=Object(P.a)("div",{target:"e146sawj1",label:"SubscriptionGridItem"})("display:flex;flex-direction:row;justify-content:space-between;background:",(function(e){return e.theme.backgroundSecondary}),";opacity:",(function(e){return e.disabled?.3:1}),";border-radius:3px;flex:1;padding:12px;height:100%;"),Re=Object(P.a)("div",{target:"e146sawj2",label:"SubscriptionGridItemWrapper"})({name:"ys2khs",styles:"padding:12px;width:33%;"}),Pe=Object(P.a)("div",{target:"e146sawj3",label:"SubscriptionDescription"})("font-size:12px;line-height:1;color:",(function(e){return e.theme.gray300}),";white-space:nowrap;"),De=Object(P.a)("div",{target:"e146sawj4",label:"SubscriptionTitle"})("font-size:16px;line-height:1;color:",(function(e){return e.theme.textColor}),";white-space:nowrap;margin-bottom:5px;");function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var o=R()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S()(this,n)}}var Ce=function(e){w()(n,e);var t=Ie(n);function n(e,r){var o;return m()(this,n),(o=t.call(this,e,r)).onChange=function(e,t){var n=new Set(o.props.events);t?n.add(e):n.delete(e),o.save(Array.from(n))},o.save=function(e){o.props.onChange(e),o.context.form.setValue("events",e)},o.context.form.setValue("events",o.props.events),o}return g()(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.webhookDisabled&&this.props.events.length&&this.save([])}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.permissions,n=e.events,r=n.filter((function(e){return"no-access"!==t[me[e]]}));JSON.stringify(n)!==JSON.stringify(r)&&this.save(r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.permissions,r=t.webhookDisabled,o=t.events;return Object(be.f)(Te,null,ve.map((function(t){var a="no-access"===n[me[t]];return Object(be.f)(I.a.Fragment,{key:t},Object(be.f)(ke,{key:t,disabledFromPermissions:a,webhookDisabled:r,checked:o.includes(t)&&!a,resource:t,onChange:e.onChange}))})))}}]),n}(I.a.Component);Ce.displayName="Subscriptions",Ce.contextTypes={router:ie.a.object.isRequired,form:ie.a.object},Ce.defaultProps={webhookDisabled:!1};var Te=Object(P.a)("div",{target:"eglb30u0",label:"SubscriptionGrid"})({name:"2imjyh",styles:"display:flex;flex-wrap:wrap;"});function Ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var o=R()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S()(this,n)}}var Ae=function(e){w()(n,e);var t=Ee(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).onPermissionChange=function(e){r.setState({permissions:e})},r.onEventChange=function(e){r.setState({events:e})},r.state={permissions:r.scopeListToPermissionState(),events:r.props.events},r}return g()(n,[{key:"scopeListToPermissionState",value:function(){return Object(ce.b)(this.props.scopes)}},{key:"render",value:function(){var e=this.state,t=e.permissions,n=e.events;return Object(be.f)(I.a.Fragment,null,Object(be.f)(M.a,null,Object(be.f)(M.e,null,Object(F.b)("Permissions")),Object(be.f)(M.c,null,Object(be.f)(he,{permissions:t,onChange:this.onPermissionChange,appPublished:this.props.appPublished}))),Object(be.f)(M.a,null,Object(be.f)(M.e,null,Object(F.b)("Webhooks")),Object(be.f)(M.c,null,Object(be.f)(Ce,{permissions:t,events:n,onChange:this.onEventChange,webhookDisabled:this.props.webhookDisabled}))))}}]),n}(I.a.Component);function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var o=R()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S()(this,n)}}function Fe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Ae.displayName="PermissionsObserver",Ae.contextTypes={router:ie.a.object.isRequired,form:ie.a.object},Ae.defaultProps={webhookDisabled:!1,appPublished:!1};var Le=function(e){w()(n,e);var t=Ue(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getData",value:function(){return Object.entries(this.fields.toJSON()).reduce((function(e,t){var n=v()(t,2),r=n[0],o=n[1];return r.endsWith("--permission")||(e[r]=o),e}),{})}},{key:"mapFormErrors",value:function(e){if(!e)return e;var t=E()(e,["scopes"]);return e.scopes&&e.scopes.forEach((function(e){var n=e.match(/Requested permission of (\w+:\w+)/);if(n){var r=function(e){var t,n=Fe(H.E);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(Object.values(r.choices).reduce((function(e,t){var n;return e.concat(null!==(n=null==t?void 0:t.scopes)&&void 0!==n?n:[])}),[]).includes(e))return r.resource}}catch(e){n.e(e)}finally{n.f()}}(n[1]);r&&(t["".concat(r,"--permission")]=[e])}})),t}}]),n}(ne.b),Ve=function(e){w()(n,e);var t=Ue(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).form=new Le,e.handleSubmitSuccess=function(t){var n=e.state.app,r=e.props.params.orgId,o="/settings/".concat(r,"/developer-settings/"),a=n?o:"".concat(o).concat(t.slug,"/");n?Object(U.c)(Object(F.b)("%s successfully saved.",t.name)):Object(U.c)(Object(F.b)("%s successfully created.",t.name)),C.browserHistory.push(a)},e.handleSubmitError=function(t){var n,r=Object(F.b)("Unknown Error");t.status>=400&&t.status<500&&(r=null!==(n=null==t?void 0:t.responseJSON.detail)&&void 0!==n?n:r);if(Object(U.a)(r),e.form.formErrors){var o=Object.keys(e.form.formErrors)[0];o&&N()("#".concat(o),{align:"middle",offset:0})}},e.onAddToken=function(){var t=l()(s.a.mark((function t(n){var r,o,a,i,c,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),r=e.state,o=r.app,a=r.tokens,o){t.next=4;break}return t.abrupt("return");case 4:return i=e.api,t.next=7,q(i,o);case 7:c=t.sent,u=a.concat(c),e.setState({tokens:u});case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRemoveToken=function(){var t=l()(s.a.mark((function t(n,r){var o,a,i,c,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),o=e.state,a=o.app,i=o.tokens,a){t.next=4;break}return t.abrupt("return");case 4:return c=e.api,u=i.filter((function(e){return e.token!==n.token})),t.next=8,V(c,a,n.token);case 8:e.setState({tokens:u});case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.renderTokens=function(){var t=e.state.tokens;return t.length>0?t.map((function(t){return Object(be.f)(Je,{key:t.token},Object(be.f)(We,null,Object(be.f)(B.a,{disabled:e.showAuthInfo,position:"right",containerDisplayMode:"inline",title:Object(F.b)("You do not have access to view these credentials because the permissions for this integration exceed those of your role.")},Object(be.f)(re.a,null,Object($.a)({value:t.token,fixed:"xxxxxx"})))),Object(be.f)(Me,null,Object(be.f)(_e,null,"Created:"),Object(be.f)(_.a,{date:Object($.a)({value:t.dateCreated,fixed:new Date(150820808e4)})})),Object(be.f)(W.b,{onClick:e.onRemoveToken.bind(p()(e),t),size:"small",icon:Object(be.f)(Y.r,null),"data-test-id":"token-delete",type:"button"},Object(F.b)("Revoke")))})):Object(be.f)(X.a,{description:Object(F.b)("No tokens created yet.")})},e.onFieldChange=function(t,n){"webhookUrl"===t&&!n&&e.isInternal&&e.form.setValue("isAlertable",!1)},e}return g()(n,[{key:"getDefaultState",value:function(){return Ne(Ne({},d()(R()(n.prototype),"getDefaultState",this).call(this)),{},{app:null,tokens:[]})}},{key:"getEndpoints",value:function(){var e=this.props.params.appSlug;return e?[["app","/sentry-apps/".concat(e,"/")],["tokens","/sentry-apps/".concat(e,"/api-tokens/")]]:[]}},{key:"getTitle",value:function(){var e=this.props.params.orgId;return Object(K.a)(Object(F.b)("Sentry Integration Details"),e,!1)}},{key:"normalize",value:function(e){return 0===e.length?e:e.map((function(e){return e.split(".").shift()}))}},{key:"renderBody",value:function(){var e,t=this,n=this.props.params.orgId,r=this.state.app,a=r&&o()(r.scopes)||[],i=r&&this.normalize(r.events)||[],c=r?"PUT":"POST",s=r?"/sentry-apps/".concat(r.slug,"/"):"/sentry-apps/",u=this.isInternal?G.internalIntegrationForms:G.publicIntegrationForms;return e=!this.isInternal&&(!r||r.verifyInstall),Object(be.f)("div",null,Object(be.f)(oe.a,{title:this.getTitle()}),Object(be.f)(Z.a,{apiMethod:c,apiEndpoint:s,allowUndo:!0,initialData:Ne(Ne({organization:n,isAlertable:!1,isInternal:this.isInternal,schema:{},scopes:[]},r),{},{verifyInstall:e}),model:this.form,onSubmitSuccess:this.handleSubmitSuccess,onSubmitError:this.handleSubmitError,onFieldChange:this.onFieldChange},Object(be.f)(A.a,null,(function(){var e=t.isInternal&&!t.form.getValue("webhookUrl");return Object(be.f)(I.a.Fragment,null,Object(be.f)(te.a,{location:t.props.location,additionalFieldProps:{webhookDisabled:e},forms:u}),Object(be.f)(Ae,{webhookDisabled:e,appPublished:!!r&&"published"===r.status,scopes:a,events:i}))})),r&&"internal"===r.status&&Object(be.f)(M.a,null,Object(be.f)(M.e,{hasButtons:!0},Object(F.b)("Tokens"),Object(be.f)(W.b,{size:"xsmall",icon:Object(be.f)(Y.b,{size:"xs",isCircled:!0}),onClick:function(e){return t.onAddToken(e)},"data-test-id":"token-add",type:"button"},Object(F.b)("New Token"))),Object(be.f)(M.c,null,this.renderTokens())),r&&Object(be.f)(M.a,null,Object(be.f)(M.e,null,Object(F.b)("Credentials")),Object(be.f)(M.c,null,"internal"!==r.status&&Object(be.f)(ee.a,{name:"clientId",label:"Client ID"},(function(e){var t=e.value;return Object(be.f)(re.a,null,Object($.a)({value:t,fixed:"CI_CLIENT_ID"}))})),Object(be.f)(ee.a,{name:"clientSecret",label:"Client Secret"},(function(e){var n=e.value;return n?Object(be.f)(B.a,{disabled:t.showAuthInfo,position:"right",containerDisplayMode:"inline",title:Object(F.b)("You do not have access to view these credentials because the permissions for this integration exceed those of your role.")},Object(be.f)(re.a,null,Object($.a)({value:n,fixed:"CI_CLIENT_SECRET"}))):Object(be.f)("em",null,"hidden")}))))))}},{key:"isInternal",get:function(){var e=this.state.app;return e?"internal"===e.status:"new-internal/"===this.props.route.path}},{key:"showAuthInfo",get:function(){var e=this.state.app;return!(e&&e.clientSecret&&"*"===e.clientSecret[0])}}]),n}(Q.a),Je=Object(P.a)(M.f,{target:"e13hfg1z0",label:"StyledPanelItem"})({name:"gg4vpm",styles:"display:flex;justify-content:space-between;"}),We=Object(P.a)("div",{target:"e13hfg1z1",label:"TokenItem"})({name:"6gs9hh",styles:"width:70%;"}),_e=Object(P.a)("span",{target:"e13hfg1z2",label:"CreatedTitle"})("color:",(function(e){return e.theme.gray300}),";margin-bottom:2px;"),Me=Object(P.a)("div",{target:"e13hfg1z3",label:"CreatedDate"})({name:"9lkchr",styles:"display:flex;flex-direction:column;font-size:14px;margin:0 10px;"})}}]);
//# sourceMappingURL=sentryApplicationDetails.js.map