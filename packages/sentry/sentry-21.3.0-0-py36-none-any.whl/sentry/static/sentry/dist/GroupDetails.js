(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[86],{1925:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(706),a=n.n(r),o=n(572);function i(t,e){var n,r,i,c,s=e.routes,u=e.params,l=e.location,p=e.stepBack,d=s.map((function(t){return t.path||""}));"string"!=typeof t?(c=s.indexOf(t)+1,i=a()(d.slice(0,c),(function(t){return"/"===t[0]}))):i=a()(d,(function(t){return"/"===t[0]}));var f=d.slice(i,c);void 0!==p&&(f=f.slice(0,p));var b=null!==(n=null==l?void 0:l.search)&&void 0!==n?n:"",h=null!==(r=null==l?void 0:l.hash)&&void 0!==r?r:"",g="".concat(f.join("")).concat("string"!=typeof t?"":t).concat(b).concat(h);return Object(o.a)(g,u)}},2060:function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"g",(function(){return l})),n.d(e,"f",(function(){return p})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return b})),n.d(e,"e",(function(){return h}));var r=n(33),a=n(165),o=n(2),i=n(63),c=n(161),s=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];i.a.apply(void 0,[t[e]].concat(r))};function u(t,e,n){return a.a.fetchDetails(e.teamId),t.request("/teams/".concat(e.orgId,"/").concat(e.teamId,"/"),{success:function(t){a.a.fetchDetailsSuccess(e.teamId,t),s(n,"success",t)},error:function(t){a.a.fetchDetailsError(e.teamId,t),s(n,"error",t)}})}function l(t,e){a.a.updateSuccess(t,e)}function p(t,e,n){var r="/teams/".concat(e.orgId,"/").concat(e.teamId,"/");return a.a.update(e.teamId,e.data),t.request(r,{method:"PUT",data:e.data,success:function(t){l(e.teamId,t),s(n,"success",t)},error:function(t){a.a.updateError(e.teamId,t),s(n,"error",t)}})}function d(t,e,n){var r,o="/organizations/".concat(e.orgId,"/members/").concat(null!==(r=e.memberId)&&void 0!==r?r:"me","/teams/").concat(e.teamId,"/"),i=Object(c.a)();return a.a.update(i,e.teamId),t.request(o,{method:"POST",success:function(t){a.a.updateSuccess(e.teamId,t),s(n,"success",t)},error:function(t){a.a.updateError(i,e.teamId,t),s(n,"error",t)}})}function f(t,e,n){var r="/organizations/".concat(e.orgId,"/members/").concat(e.memberId||"me","/teams/").concat(e.teamId,"/"),o=Object(c.a)();return a.a.update(o,e.teamId),t.request(r,{method:"DELETE",success:function(t){a.a.updateSuccess(e.teamId,t),s(n,"success",t)},error:function(t){a.a.updateError(o,e.teamId,t),s(n,"error",t)}})}function b(t,e,n){return a.a.createTeam(e),t.requestPromise("/organizations/".concat(n.orgId,"/teams/"),{method:"POST",data:e}).then((function(t){return a.a.createTeamSuccess(t),Object(r.c)(Object(o.c)("[team] has been added to the [organization] organization",{team:"#".concat(t.slug),organization:n.orgId})),t}),(function(t){throw a.a.createTeamError(e.slug,t),Object(r.a)(Object(o.c)("Unable to create [team] in the [organization] organization",{team:"#".concat(e.slug),organization:n.orgId})),t}))}function h(t,e){return a.a.removeTeam(e.teamId),t.requestPromise("/teams/".concat(e.orgId,"/").concat(e.teamId,"/"),{method:"DELETE"}).then((function(t){return a.a.removeTeamSuccess(e.teamId,t),Object(r.c)(Object(o.c)("[team] has been removed from the [organization] organization",{team:"#".concat(e.teamId),organization:e.orgId})),t}),(function(t){throw a.a.removeTeamError(e.teamId,t),Object(r.a)(Object(o.c)("Unable to remove [team] from the [organization] organization",{team:"#".concat(e.teamId),organization:e.orgId})),t}))}},2248:function(t,e,n){"use strict";var r=n(9),a=n.n(r),o=n(10),i=n.n(o),c=n(11),s=n.n(c),u=n(12),l=n.n(u),p=n(7),d=n.n(p),f=n(3),b=n(1),h=n.n(b),g=n(33),v=n(2060),m=n(27),j=n(120),y=n(96),O=n(15),I=n(2),E=n(227),S=n(6),T=n(47),k=n(440),w=n(0);function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var a=d()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return l()(this,n)}}var D=function(t){s()(n,t);var e=R(n);function n(t){var r,o;a()(this,n),(o=e.call(this,t)).handleChangeTeam=function(t){var e=t?t.value:null;o.setState({team:e})},o.getPendingTeamOption=function(t){return{value:t,label:Object(w.f)(x,null,Object(I.b)("#".concat(t)))}};var i=o.props,c=i.organization,s=i.projectSlug,u=null===(r=c.projects)||void 0===r?void 0:r.find((function(t){return t.slug===s}));return o.state={loading:!1,error:!1,project:u,team:""},o}return i()(n,[{key:"joinTeam",value:function(t){var e=this;this.setState({loading:!0}),Object(v.c)(this.props.api,{orgId:this.props.organization.slug,teamId:t},{success:function(){e.setState({loading:!1,error:!1}),Object(g.c)(Object(I.b)("Request to join team sent."))},error:function(){e.setState({loading:!1,error:!0}),Object(g.a)(Object(I.b)("There was an error while trying to request access."))}})}},{key:"renderJoinTeam",value:function(t,e){var n=E.a.getBySlug(t);return n?this.state.loading?e.has("open-membership")?Object(w.f)(m.b,{busy:!0},Object(I.b)("Join Team")):Object(w.f)(m.b,{busy:!0},Object(I.b)("Request Access")):null!=n&&n.isPending?Object(w.f)(m.b,{disabled:!0},Object(I.b)("Request Pending")):e.has("open-membership")?Object(w.f)(m.b,{priority:"primary",type:"button",onClick:this.joinTeam.bind(this,t)},Object(I.b)("Join Team")):Object(w.f)(m.b,{priority:"primary",type:"button",onClick:this.joinTeam.bind(this,t)},Object(I.b)("Request Access")):null}},{key:"getTeamsForAccess",value:function(){var t,e,n=[],r=[];return(null!==(t=null===(e=this.state.project)||void 0===e?void 0:e.teams)&&void 0!==t?t:[]).forEach((function(t){var e=t.slug,a=E.a.getBySlug(e);a&&(a.isPending?r.push(a.slug):n.push(a.slug))})),[n,r]}},{key:"render",value:function(){var t,e,n=this,r=this.props.organization,a=this.state.team,o=null!==(t=null===(e=this.state.project)||void 0===e?void 0:e.teams)&&void 0!==t?t:[],i=new Set(r.features),c=[{label:Object(I.b)("Request Access"),options:this.getTeamsForAccess()[0].map((function(t){return{value:t,label:Object(I.b)("#".concat(t))}}))},{label:Object(I.b)("Pending Requests"),options:this.getTeamsForAccess()[1].map((function(t){return n.getPendingTeamOption(t)}))}];return Object(w.f)(P,null,o.length?Object(w.f)(k.a,{icon:Object(w.f)(O.C,{size:"xl"}),title:Object(I.b)("You're not a member of this project."),description:Object(I.b)("You'll need to join a team with access before you can view this data."),action:Object(w.f)(C,null,Object(w.f)(z,{name:"select",placeholder:Object(I.b)("Select a Team"),options:c,onChange:this.handleChangeTeam}),a?this.renderJoinTeam(a,i):Object(w.f)(m.b,{disabled:!0},Object(I.b)("Select a Team")))}):Object(w.f)(k.a,{icon:Object(w.f)(O.C,{size:"xl"})},Object(I.b)("No teams have access to this project yet. Ask an admin to add your team to this project.")))}}]),n}(h.a.Component);D.displayName="MissingProjectMembership";var P=Object(f.a)(y.a,{target:"e1rms11u0",label:"StyledPanel"})("margin:",Object(S.a)(2)," 0;"),C=Object(f.a)("div",{target:"e1rms11u1",label:"Field"})("display:grid;grid-auto-flow:column;gap:",Object(S.a)(2),";text-align:left;"),z=Object(f.a)(j.a,{target:"e1rms11u2",label:"StyledSelectControl"})({name:"1hskriy",styles:"width:250px;"}),x=Object(f.a)("div",{target:"e1rms11u3",label:"DisabledLabel"})({name:"195ow5l",styles:"display:flex;opacity:0.5;overflow:hidden;"});e.a=Object(T.a)(D)},2904:function(t,e,n){"use strict";n.r(e);var r=n(5),a=n.n(r),o=n(14),i=n.n(o),c=n(9),s=n.n(c),u=n(10),l=n.n(u),p=n(11),d=n.n(p),f=n(12),b=n.n(f),h=n(7),g=n.n(h),v=n(1),m=n.n(v),j=n(35),y=n(328),O=n(54),I=n(30),E=n.n(I),S=n(8),T=n.n(S),k=n(20),w=n.n(k),R=n(29),D=n.n(R),P=n(264),C=n.n(P),z=n(22),x=n(50),q=n(429),A=n(4),_=n.n(A),N=n(131),U=n(44),L=n(702),G=n(2248),M=n(2),F=n(176),H=n(74),V=n(222),J=n(63),Y=n(217),B=n(225),W=n(1925),K=n(47),Q="GROUP_NOT_FOUND",X="MISSING_MEMBERSHIP",Z=n(125),$=n(356),tt=n(0);function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){T()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var a=g()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b()(this,n)}}var at=function(t){d()(a,t);var e,n,r=rt(a);function a(){var t;s()(this,a);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.call.apply(r,[this].concat(n))).state=t.initialState,t.remountComponent=function(){t.setState(t.initialState),t.fetchData()},t.listener=H.a.listen((function(e){return t.onGroupChange(e)}),void 0),t}return l()(a,[{key:"getChildContext",value:function(){return{group:this.state.group,location:this.props.location}}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(t,e){var n,r;t.isGlobalSelectionReady!==this.props.isGlobalSelectionReady&&this.fetchData(),(!this.canLoadEventEarly(t)&&(null==e||!e.group)&&this.state.group||(null===(n=t.params)||void 0===n?void 0:n.eventId)!==(null===(r=this.props.params)||void 0===r?void 0:r.eventId)&&this.state.group)&&this.getEvent(this.state.group)}},{key:"componentWillUnmount",value:function(){H.a.reset(),Object(J.a)(this.listener)}},{key:"canLoadEventEarly",value:function(t){return!t.params.eventId||["oldest","latest"].includes(t.params.eventId)}},{key:"getEvent",value:(n=D()(w.a.mark((function t(e){var n,r,a,o,i,c,s,u,l,p;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e&&this.setState({loadingEvent:!0,eventError:!1}),r=this.props,a=r.params,o=r.environments,i=r.api,c=a.orgId,s=a.groupId,u=(null==a?void 0:a.eventId)||"latest",l=null==e||null===(n=e.project)||void 0===n?void 0:n.slug,t.prev=6,t.next=9,Object($.b)(i,c,s,u,o,l);case 9:p=t.sent,this.setState({event:p,loading:!1,eventError:!1,loadingEvent:!1}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(6),x.c(t.t0),this.setState({eventError:!0,loading:!1,loadingEvent:!1});case 17:case"end":return t.stop()}}),t,this,[[6,13]])}))),function(t){return n.apply(this,arguments)})},{key:"getCurrentRouteInfo",value:function(t){var e=this.props,n=e.routes,r=e.organization,a=this.state.event,o=n[n.length-1].props;return{currentTab:o.currentTab,baseUrl:o.isEventRoute&&a?"/organizations/".concat(r.slug,"/issues/").concat(t.id,"/events/").concat(a.id,"/"):"/organizations/".concat(r.slug,"/issues/").concat(t.id,"/")}}},{key:"checkRedirectRoute",value:function(){}},{key:"fetchData",value:(e=D()(w.a.mark((function t(){var e,n,r,a,o,i,c,s,u,l,p,d,f,b,h,g,v,m,j,y,O,I,S,T,k,R,D,P;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.props,n=e.environments,r=e.api,a=e.isGlobalSelectionReady,o=e.params,i=e.routes,c=e.location,s=e.organization,a){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,this.canLoadEventEarly(this.props)&&(d=this.getEvent()),f=nt({},n?{environment:n}:{}),null!=s&&null!==(u=s.features)&&void 0!==u&&u.includes("inbox")&&(f.expand="inbox"),t.next=9,r.requestPromise(this.groupDetailsEndpoint,{query:f});case 9:return b=t.sent,t.next=12,Promise.all([b,d]);case 12:if(h=t.sent,g=E()(h,1),v=g[0],m=s.projects,j=v.project.id,y=null!==(l=null==m||null===(p=m.find((function(t){return t.id===j})))||void 0===p?void 0:p.features)&&void 0!==l?l:[],O=y.includes("reprocessing-v2"),I=Object($.f)(v),S=this.getCurrentRouteInfo(v),T=S.currentTab,k=S.baseUrl,this.props.params.groupId===v.id){t.next=28;break}if(!O){t.next=26;break}if(I!==$.a.REPROCESSED_AND_HASNT_EVENT||T===Z.a.ACTIVITY){t.next=26;break}return z.browserHistory.push({pathname:"".concat(k).concat(Z.a.ACTIVITY,"/"),query:nt(nt({},o),{},{groupId:v.id})}),t.abrupt("return");case 26:return z.browserHistory.push(Object(W.a)("",{routes:i,location:c,params:nt(nt({},o),{},{groupId:v.id})})),t.abrupt("return");case 28:O&&(I===$.a.REPROCESSING&&T!==Z.a.DETAILS&&z.browserHistory.push({pathname:k,query:o}),I!==$.a.REPROCESSED_AND_HASNT_EVENT||T===Z.a.ACTIVITY&&T===Z.a.USER_FEEDBACK||z.browserHistory.push({pathname:"".concat(k).concat(Z.a.ACTIVITY,"/"),query:o})),R=v.project,Object($.h)(r,o.orgId,R.slug,o.groupId),R?(void 0===(D=nt({},this.props.location)).query.project&&void 0===D.query._allp&&(D.query.project=R.id),delete D.query._allp,z.browserHistory.replace(D)):x.m((function(){x.c(new Error("Project not found"))})),this.setState({project:R}),H.a.loadInitialData([v]),t.next=48;break;case 36:t.prev=36,t.t0=t.catch(3),x.c(t.t0),P=null,t.t1=null===t.t0||void 0===t.t0?void 0:t.t0.status,t.next=404===t.t1?43:403===t.t1?45:47;break;case 43:return P=Q,t.abrupt("break",47);case 45:return P=X,t.abrupt("break",47);case 47:this.setState({error:!0,errorType:P,loading:!1});case 48:case"end":return t.stop()}}),t,this,[[3,36]])}))),function(){return e.apply(this,arguments)})},{key:"onGroupChange",value:function(t){var e=this.props.params.groupId;if(t.has(e)){var n=H.a.get(e);if(n){if(n.stale)return void this.fetchData();this.setState({group:n})}}}},{key:"getTitle",value:function(){var t=this.props.organization,e=this.state.group;if(!e)return"Sentry";var n=Object(Y.d)(e,t).title,r=Object(Y.b)(e),a=e.project,o="".concat(t.slug," - ").concat(a.slug);return n&&r?"".concat(n,": ").concat(r," - ").concat(o):"".concat(n||r||"Sentry"," - ").concat(o)}},{key:"renderError",value:function(){var t,e,n=this.props,r=n.organization,a=n.location,o=null!==(t=r.projects)&&void 0!==t?t:[],i=a.query.project,c=null===(e=o.find((function(t){return t.id===i})))||void 0===e?void 0:e.slug;switch(this.state.errorType){case Q:return Object(tt.f)(N.a,{message:Object(M.b)("The issue you were looking for was not found.")});case X:return Object(tt.f)(G.a,{organization:this.props.organization,projectSlug:c});default:return Object(tt.f)(N.a,{onRetry:this.remountComponent})}}},{key:"renderContent",value:function(t){var e=this,n=this.props,r=n.children,a=n.environments,o=this.state,i=o.loadingEvent,c=o.eventError,s=this.state.group,u=this.state.event,l=this.getCurrentRouteInfo(s),p=l.currentTab,d=l.baseUrl,f={environments:a,group:s,project:t};return p===Z.a.DETAILS&&(f=nt(nt({},f),{},{event:u,loadingEvent:i,eventError:c,onRetry:function(){return e.remountComponent()}})),p===Z.a.TAGS&&(f=nt(nt({},f),{},{event:u,baseUrl:d})),Object(tt.f)(m.a.Fragment,null,Object(tt.f)(Z.b,{project:t,event:u,group:s,currentTab:p,baseUrl:d}),m.a.isValidElement(r)?m.a.cloneElement(r,f):r)}},{key:"render",value:function(){var t,e=this,n=this.props.organization,r=this.state,a=r.error,o=r.group,i=r.project,c=r.loading||!o&&!a;return Object(tt.f)(C.a,{title:this.getTitle()},Object(tt.f)(L.a,{skipLoadLastUsed:!0,forceProject:i,showDateSelector:!1,shouldForceProject:!0,lockedMessageSubject:Object(M.b)("issue"),showIssueStreamLink:!0,showProjectSettingsLink:!0},Object(tt.f)(V.b,null,c?Object(tt.f)(U.default,null):a?this.renderError():Object(tt.f)(B.a,{orgId:n.slug,slugs:[null!==(t=null==i?void 0:i.slug)&&void 0!==t?t:""],"data-test-id":"group-projects-container"},(function(t){var n=t.projects,r=t.initiallyLoaded,a=t.fetchError;return r?a?Object(tt.f)(N.a,{message:Object(M.b)("Error loading the specified project")}):e.renderContent(n[0]):Object(tt.f)(U.default,null)})))))}},{key:"initialState",get:function(){return{group:null,loading:!0,loadingEvent:!0,error:!1,eventError:!1,errorType:null,project:null}}},{key:"groupDetailsEndpoint",get:function(){return"/issues/".concat(this.props.params.groupId,"/")}}]),a}(m.a.Component);at.displayName="GroupDetails",at.childContextTypes={group:F.a.Group,location:_.a.object};var ot=Object(K.a)(q.c(at));function it(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var a=g()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b()(this,n)}}var ct=function(t){d()(n,t);var e=it(n);function n(t){var r;return s()(this,n),(r=e.call(this,t)).startMetricCollection(),r}return l()(n,[{key:"componentDidMount",value:function(){Object(j.a)("issue_page.viewed",{group_id:parseInt(this.props.params.groupId,10),org_id:parseInt(this.props.organization.id,10)})}},{key:"startMetricCollection",value:function(){var t=Object(O.b)(this.props.organization)?"cold-start":"warm-start";j.c.mark({name:"page-issue-details-start",data:{start_type:t}})}},{key:"render",value:function(){var t=this.props,e=t.selection,n=i()(t,["selection"]);return Object(tt.f)(ot,a()({key:"".concat(this.props.params.groupId,"-envs:").concat(e.environments.join(",")),environments:e.environments},n))}}]),n}(m.a.Component);ct.displayName="OrganizationGroupDetails";e.default=Object(O.a)(Object(y.a)(ct))}}]);
//# sourceMappingURL=GroupDetails.js.map