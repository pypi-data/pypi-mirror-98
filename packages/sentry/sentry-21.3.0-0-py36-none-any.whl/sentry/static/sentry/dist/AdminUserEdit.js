(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[55],{1898:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(9),a=n.n(r),i=n(10),s=n.n(i),c=n(11),o=n.n(c),u=n(12),l=n.n(u),p=n(7),d=n.n(p),b=(n(1),n(264)),f=n.n(b),h=n(693),m=n(0);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d()(e);if(t){var a=d()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return l()(this,n)}}var v=function(e){o()(n,e);var t=y(n);function n(){return a()(this,n),t.apply(this,arguments)}return s()(n,[{key:"getTitle",value:function(){return""}},{key:"render",value:function(){var e=this.getTitle();return Object(m.f)(f.a,{title:"".concat(e?"".concat(e," - "):"","Sentry")},this.renderComponent())}}]),n}(h.a);v.displayName="AsyncView"},2849:function(e,t,n){"use strict";n.r(t);var r=n(5),a=n.n(r),i=n(20),s=n.n(i),c=n(29),o=n.n(c),u=n(9),l=n.n(u),p=n(10),d=n.n(p),b=n(11),f=n.n(b),h=n(12),m=n.n(h),y=n(7),v=n.n(y),j=n(3),O=n(1),g=n.n(O),w=n(22),R=n(33),U=n(65),x=n(27),D=n(2),k=n(6),E=n(1898),S=n(713),q=n(329),T=n(699),M=n(269),C=n(0);function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return m()(this,n)}}var A={title:"User details",fields:[{name:"name",type:"string",required:!0,label:Object(D.b)("Name")},{name:"username",type:"string",required:!0,label:Object(D.b)("Username"),help:Object(D.b)("The username is the unique id of the user in the system")},{name:"email",type:"string",required:!0,label:Object(D.b)("Email"),help:Object(D.b)("The users primary email address")},{name:"isActive",type:"boolean",required:!0,label:Object(D.b)("Active"),help:Object(D.b)("Designates whether this user should be treated as active. Unselect this instead of deleting accounts.")},{name:"isStaff",type:"boolean",required:!0,label:Object(D.b)("Admin"),help:Object(D.b)("Designates whether this user can perform administrative functions.")},{name:"isSuperuser",type:"boolean",required:!0,label:Object(D.b)("Superuser"),help:Object(D.b)("Designates whether this user has all permissions without explicitly assigning them.")}]},F={disable:Object(D.b)("Disable User"),delete:Object(D.b)("Permanently Delete User")},N=function(e){f()(n,e);var t=P(n);function n(){var e;l()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={deleteType:"disable"},e.onRemove=function(){e.props.onRemove(e.state.deleteType),e.props.closeModal()},e}return d()(n,[{key:"render",value:function(){var e=this,t=this.props.user,n=this.state.deleteType;return Object(C.f)(g.a.Fragment,null,Object(C.f)(S.b,{value:n,label:Object(D.b)("Remove user %s",t.email),onChange:function(t){return e.setState({deleteType:t})},choices:[["disable",Object(D.b)("Disable the account.")],["delete",Object(D.b)("Permanently remove the user and their data.")]]}),Object(C.f)(J,null,Object(C.f)(x.b,{priority:"danger",onClick:this.onRemove},F[n]),Object(C.f)(x.b,{onClick:this.props.closeModal},Object(D.b)("Cancel"))))}}]),n}(g.a.Component);N.displayName="RemoveUserModal";var B=function(e){f()(i,e);var t,n,r=P(i);function i(){var e;l()(this,i);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=r.call.apply(r,[this].concat(n))).removeUser=function(t){return"delete"===t?e.deleteUser():e.deactivateUser()},e.formModel=new M.b,e}return d()(i,[{key:"getEndpoints",value:function(){return[["user",this.userEndpoint]]}},{key:"deleteUser",value:(n=o()(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.requestPromise(this.userEndpoint,{method:"DELETE",data:{hardDelete:!0,organizations:[]}});case 2:Object(R.c)(Object(D.b)("%s's account has been deleted.",null===(t=this.state.user)||void 0===t?void 0:t.email)),w.browserHistory.replace("/manage/users/");case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"deactivateUser",value:(t=o()(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.requestPromise(this.userEndpoint,{method:"PUT",data:{isActive:!1}});case 2:t=e.sent,this.setState({user:t}),this.formModel.setInitialData(t),Object(R.c)(Object(D.b)("%s's account has been deactivated.",t.email));case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"renderBody",value:function(){var e=this,t=this.state.user;if(null===t)return null;return Object(C.f)(g.a.Fragment,null,Object(C.f)("h3",null,Object(D.b)("Users")),Object(C.f)("p",null,Object(D.b)("Editing user: %s",t.email)),Object(C.f)(q.a,{model:this.formModel,initialData:t,apiMethod:"PUT",apiEndpoint:this.userEndpoint,requireChanges:!0,onSubmitError:R.a,onSubmitSuccess:function(t){e.setState({user:t}),Object(R.c)("User account updated.")},extraButton:Object(C.f)(x.b,{type:"button",onClick:function(){return Object(U.openModal)((function(n){return Object(C.f)(N,a()({user:t,onRemove:e.removeUser},n))}))},style:{marginLeft:Object(k.a)(1)},priority:"danger"},Object(D.b)("Remove User"))},Object(C.f)(T.a,{forms:[A]})))}},{key:"userEndpoint",get:function(){var e=this.props.params;return"/users/".concat(e.id,"/")}}]),i}(E.a),J=Object(j.a)("div",{target:"e1drqbta0",label:"ModalFooter"})("display:grid;grid-auto-flow:column;grid-gap:",Object(k.a)(1),";justify-content:end;padding:20px 30px;margin:20px -30px -30px;border-top:1px solid ",(function(e){return e.theme.border}),";");t.default=B}}]);
//# sourceMappingURL=AdminUserEdit.js.map