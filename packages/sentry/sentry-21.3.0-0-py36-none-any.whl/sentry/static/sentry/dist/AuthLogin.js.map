{"version":3,"sources":["webpack:///./app/views/auth/loginForm.tsx","webpack:///./app/views/auth/registerForm.tsx","webpack:///./app/views/auth/ssoForm.tsx","webpack:///./app/views/auth/login.tsx"],"names":["LoginProviders","vstsLoginLink","githubLoginLink","googleLoginLink","ProviderWrapper","ProviderHeading","t","align","size","icon","href","LoginForm","state","errorMessage","errors","handleSubmit","data","onSuccess","onError","a","props","api","requestPromise","method","response","ConfigStore","set","user","browserHistory","push","pathname","nextUri","responseJSON","message","detail","__all__","setState","this","authConfig","hasLoginProvider","css","FormWrapper","submitLabel","onSubmit","footerClass","formFooterClass","extraButton","LostPasswordLink","to","name","placeholder","label","error","username","required","password","React","Component","p","space","theme","border","Link","gray300","textColor","SubscribeField","yesLabel","noLabel","help","tct","link","RegisterForm","hasNewsletter","initialData","subscribe","PrivacyPolicyLink","ExternalLink","SsoForm","serverHostname","className","slug","example","hostname","SlugExample","FORM_COMPONENTS","login","register","sso","Login","loading","activeTab","handleSetTab","event","preventDefault","fetchData","vsts_login_link","github_login_link","google_login_link","config","FormComponent","tabs","canRegister","Fragment","Header","Heading","AuthNavTabs","map","key","onClick","e","StyledLoadingError","onRetry","hasAuthProviders","LoadingError","NavTabs","withApi"],"mappings":"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","file":"AuthLogin.js","sourcesContent":["import React from 'react';\nimport {browserHistory} from 'react-router';\nimport {ClassNames} from '@emotion/core';\nimport styled from '@emotion/styled';\n\nimport {Client} from 'app/api';\nimport Button from 'app/components/button';\nimport Form from 'app/components/forms/form';\nimport PasswordField from 'app/components/forms/passwordField';\nimport TextField from 'app/components/forms/textField';\nimport Link from 'app/components/links/link';\nimport {IconGithub, IconGoogle, IconVsts} from 'app/icons';\nimport {t} from 'app/locale';\nimport ConfigStore from 'app/stores/configStore';\nimport space from 'app/styles/space';\nimport {AuthConfig} from 'app/types';\nimport {formFooterClass} from 'app/views/auth/login';\n\ntype LoginProvidersProps = Partial<\n  Pick<AuthConfig, 'vstsLoginLink' | 'githubLoginLink' | 'googleLoginLink'>\n>;\n\n// TODO(epurkhiser): The abstraction here would be much nicer if we just\n// exposed a configuration object telling us what auth providers there are.\nconst LoginProviders = ({\n  vstsLoginLink,\n  githubLoginLink,\n  googleLoginLink,\n}: LoginProvidersProps) => (\n  <ProviderWrapper>\n    <ProviderHeading>{t('External Account Login')}</ProviderHeading>\n    {googleLoginLink && (\n      <Button\n        align=\"left\"\n        size=\"small\"\n        icon={<IconGoogle size=\"xs\" />}\n        href={googleLoginLink}\n      >\n        {t('Sign in with Google')}\n      </Button>\n    )}\n    {githubLoginLink && (\n      <Button\n        align=\"left\"\n        size=\"small\"\n        icon={<IconGithub size=\"xs\" />}\n        href={githubLoginLink}\n      >\n        {t('Sign in with GitHub')}\n      </Button>\n    )}\n    {vstsLoginLink && (\n      <Button\n        align=\"left\"\n        size=\"small\"\n        icon={<IconVsts size=\"xs\" />}\n        href={vstsLoginLink}\n      >\n        {t('Sign in with Azure DevOps')}\n      </Button>\n    )}\n  </ProviderWrapper>\n);\n\ntype Props = {\n  api: Client;\n  authConfig: AuthConfig;\n};\n\ntype State = {\n  errorMessage: null | string;\n  errors: Record<string, string>;\n};\n\nclass LoginForm extends React.Component<Props, State> {\n  state: State = {\n    errorMessage: null,\n    errors: {},\n  };\n\n  handleSubmit: Form['props']['onSubmit'] = async (data, onSuccess, onError) => {\n    try {\n      const response = await this.props.api.requestPromise('/auth/login/', {\n        method: 'POST',\n        data,\n      });\n      onSuccess(data);\n\n      // TODO(epurkhiser): There is likely more that needs to happen to update\n      // the application state after user login.\n\n      ConfigStore.set('user', response.user);\n\n      // TODO(epurkhiser): Reconfigure sentry SDK identity\n\n      browserHistory.push({pathname: response.nextUri});\n    } catch (e) {\n      if (!e.responseJSON || !e.responseJSON.errors) {\n        onError(e);\n        return;\n      }\n\n      let message = e.responseJSON.detail;\n      if (e.responseJSON.errors.__all__) {\n        message = e.responseJSON.errors.__all__;\n      }\n\n      this.setState({\n        errorMessage: message,\n        errors: e.responseJSON.errors || {},\n      });\n\n      onError(e);\n    }\n  };\n\n  render() {\n    const {errorMessage, errors} = this.state;\n    const {githubLoginLink, vstsLoginLink} = this.props.authConfig;\n\n    const hasLoginProvider = !!(githubLoginLink || vstsLoginLink);\n\n    return (\n      <ClassNames>\n        {({css}) => (\n          <FormWrapper hasLoginProvider={hasLoginProvider}>\n            <Form\n              submitLabel={t('Continue')}\n              onSubmit={this.handleSubmit}\n              footerClass={css`\n                ${formFooterClass}\n              `}\n              errorMessage={errorMessage}\n              extraButton={\n                <LostPasswordLink to=\"/account/recover/\">\n                  {t('Lost your password?')}\n                </LostPasswordLink>\n              }\n            >\n              <TextField\n                name=\"username\"\n                placeholder={t('username or email')}\n                label={t('Account')}\n                error={errors.username}\n                required\n              />\n              <PasswordField\n                name=\"password\"\n                placeholder={t('password')}\n                label={t('Password')}\n                error={errors.password}\n                required\n              />\n            </Form>\n            {hasLoginProvider && <LoginProviders {...{vstsLoginLink, githubLoginLink}} />}\n          </FormWrapper>\n        )}\n      </ClassNames>\n    );\n  }\n}\n\nconst FormWrapper = styled('div')<{hasLoginProvider: boolean}>`\n  display: grid;\n  grid-gap: 60px;\n  grid-template-columns: ${p => (p.hasLoginProvider ? '1fr 0.8fr' : '1fr')};\n`;\n\nconst ProviderHeading = styled('div')`\n  margin: 0;\n  font-size: 15px;\n  font-weight: bold;\n  line-height: 24px;\n`;\n\nconst ProviderWrapper = styled('div')`\n  position: relative;\n  display: grid;\n  grid-auto-rows: max-content;\n  grid-gap: ${space(1.5)};\n\n  &:before {\n    position: absolute;\n    display: block;\n    content: '';\n    top: 0;\n    bottom: 0;\n    left: -30px;\n    border-left: 1px solid ${p => p.theme.border};\n  }\n`;\n\nconst LostPasswordLink = styled(Link)`\n  color: ${p => p.theme.gray300};\n\n  &:hover {\n    color: ${p => p.theme.textColor};\n  }\n`;\n\nexport default LoginForm;\n","import React from 'react';\nimport {browserHistory} from 'react-router';\nimport {ClassNames} from '@emotion/core';\nimport styled from '@emotion/styled';\n\nimport {Client} from 'app/api';\nimport Form from 'app/components/forms/form';\nimport PasswordField from 'app/components/forms/passwordField';\nimport RadioBooleanField from 'app/components/forms/radioBooleanField';\nimport TextField from 'app/components/forms/textField';\nimport ExternalLink from 'app/components/links/externalLink';\nimport {t, tct} from 'app/locale';\nimport ConfigStore from 'app/stores/configStore';\nimport {AuthConfig} from 'app/types';\nimport {formFooterClass} from 'app/views/auth/login';\n\nconst SubscribeField = () => (\n  <RadioBooleanField\n    name=\"subscribe\"\n    yesLabel={t('Yes, I would like to receive updates via email')}\n    noLabel={t(\"No, I'd prefer not to receive these updates\")}\n    help={tct(\n      `We'd love to keep you updated via email with product and feature\n           announcements, promotions, educational materials, and events. Our\n           updates focus on relevant information, and we'll never sell your data\n           to third parties. See our [link] for more details.`,\n      {\n        link: <a href=\"https://sentry.io/privacy/\">Privacy Policy</a>,\n      }\n    )}\n  />\n);\n\ntype Props = {\n  api: Client;\n  authConfig: AuthConfig;\n};\n\ntype State = {\n  errorMessage: null | string;\n  errors: Record<string, string>;\n};\n\nclass RegisterForm extends React.Component<Props, State> {\n  state: State = {\n    errorMessage: null,\n    errors: {},\n  };\n\n  handleSubmit: Form['props']['onSubmit'] = async (data, onSuccess, onError) => {\n    const {api} = this.props;\n\n    try {\n      const response = await api.requestPromise('/auth/register/', {\n        method: 'POST',\n        data,\n      });\n      onSuccess(data);\n\n      // TODO(epurkhiser): There is more we need to do to setup the user. but\n      // definitely primarily we need to init our user.\n      ConfigStore.set('user', response.user);\n\n      browserHistory.push({pathname: response.nextUri});\n    } catch (e) {\n      if (!e.responseJSON || !e.responseJSON.errors) {\n        onError(e);\n        return;\n      }\n\n      let message = e.responseJSON.detail;\n      if (e.responseJSON.errors.__all__) {\n        message = e.responseJSON.errors.__all__;\n      }\n\n      this.setState({\n        errorMessage: message,\n        errors: e.responseJSON.errors || {},\n      });\n\n      onError(e);\n    }\n  };\n\n  render() {\n    const {hasNewsletter} = this.props.authConfig;\n    const {errorMessage, errors} = this.state;\n\n    return (\n      <ClassNames>\n        {({css}) => (\n          <Form\n            initialData={{subscribe: true}}\n            submitLabel={t('Continue')}\n            onSubmit={this.handleSubmit}\n            footerClass={css`\n              ${formFooterClass}\n            `}\n            errorMessage={errorMessage}\n            extraButton={\n              <PrivacyPolicyLink href=\"https://sentry.io/privacy/\">\n                {t('Privacy Policy')}\n              </PrivacyPolicyLink>\n            }\n          >\n            <TextField\n              name=\"name\"\n              placeholder={t('Jane Bloggs')}\n              label={t('Name')}\n              error={errors.name}\n              required\n            />\n            <TextField\n              name=\"username\"\n              placeholder={t('you@example.com')}\n              label={t('Email')}\n              error={errors.username}\n              required\n            />\n            <PasswordField\n              name=\"password\"\n              placeholder={t('something super secret')}\n              label={t('Password')}\n              error={errors.password}\n              required\n            />\n            {hasNewsletter && <SubscribeField />}\n          </Form>\n        )}\n      </ClassNames>\n    );\n  }\n}\n\nconst PrivacyPolicyLink = styled(ExternalLink)`\n  color: ${p => p.theme.gray300};\n\n  &:hover {\n    color: ${p => p.theme.textColor};\n  }\n`;\n\nexport default RegisterForm;\n","import React from 'react';\nimport {browserHistory} from 'react-router';\n\nimport {Client} from 'app/api';\nimport Form from 'app/components/forms/form';\nimport TextField from 'app/components/forms/textField';\nimport {t, tct} from 'app/locale';\nimport {AuthConfig} from 'app/types';\n\ntype Props = {\n  api: Client;\n  authConfig: AuthConfig;\n};\n\ntype State = {\n  errorMessage: string | null;\n};\n\nclass SsoForm extends React.Component<Props, State> {\n  state = {\n    errorMessage: null,\n  };\n\n  handleSubmit: Form['props']['onSubmit'] = async (data, onSuccess, onError) => {\n    const {api} = this.props;\n    try {\n      const response = await api.requestPromise('/auth/sso-locate/', {\n        method: 'POST',\n        data,\n      });\n      onSuccess(data);\n      browserHistory.push({pathname: response.nextUri});\n    } catch (e) {\n      if (!e.responseJSON) {\n        onError(e);\n        return;\n      }\n      const message = e.responseJSON.detail;\n      this.setState({errorMessage: message});\n      onError(e);\n    }\n  };\n\n  render() {\n    const {serverHostname} = this.props.authConfig;\n    const {errorMessage} = this.state;\n\n    return (\n      <Form\n        className=\"form-stacked\"\n        submitLabel={t('Continue')}\n        onSubmit={this.handleSubmit}\n        footerClass=\"auth-footer\"\n        errorMessage={errorMessage}\n      >\n        <TextField\n          name=\"organization\"\n          placeholder=\"acme\"\n          label={t('Organization ID')}\n          required\n          help={tct('Your ID is the slug after the hostname. e.g. [example] is [slug].', {\n            slug: <strong>acme</strong>,\n            example: <SlugExample slug=\"acme\" hostname={serverHostname} />,\n          })}\n        />\n      </Form>\n    );\n  }\n}\n\ntype SlugExampleProps = {\n  hostname: string;\n  slug: string;\n};\n\nconst SlugExample = ({hostname, slug}: SlugExampleProps) => (\n  <code>\n    {hostname}/<strong>{slug}</strong>\n  </code>\n);\n\nexport default SsoForm;\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport {Client} from 'app/api';\nimport LoadingError from 'app/components/loadingError';\nimport LoadingIndicator from 'app/components/loadingIndicator';\nimport NavTabs from 'app/components/navTabs';\nimport {t} from 'app/locale';\nimport space from 'app/styles/space';\nimport {AuthConfig} from 'app/types';\nimport withApi from 'app/utils/withApi';\n\nimport LoginForm from './loginForm';\nimport RegisterForm from './registerForm';\nimport SsoForm from './ssoForm';\n\nconst FORM_COMPONENTS = {\n  login: LoginForm,\n  register: RegisterForm,\n  sso: SsoForm,\n} as const;\n\ntype ActiveTab = keyof typeof FORM_COMPONENTS;\n\ntype TabConfig = [key: ActiveTab, label: string, disabled?: boolean];\n\ntype Props = {\n  api: Client;\n};\n\ntype State = {\n  loading: boolean;\n  error: null | boolean;\n  activeTab: ActiveTab;\n  authConfig: null | AuthConfig;\n};\n\nclass Login extends React.Component<Props, State> {\n  state: State = {\n    loading: true,\n    error: null,\n    activeTab: 'login',\n    authConfig: null,\n  };\n\n  componentDidMount() {\n    this.fetchData();\n  }\n\n  handleSetTab = (activeTab: ActiveTab, event: React.MouseEvent) => {\n    this.setState({activeTab});\n    event.preventDefault();\n  };\n\n  fetchData = async () => {\n    const {api} = this.props;\n    try {\n      const response = await api.requestPromise('/auth/config/');\n\n      const {vsts_login_link, github_login_link, google_login_link, ...config} = response;\n      const authConfig = {\n        ...config,\n        vstsLoginLink: vsts_login_link,\n        githubLoginLink: github_login_link,\n        googleLoginLink: google_login_link,\n      };\n\n      this.setState({authConfig});\n    } catch (e) {\n      this.setState({error: true});\n    }\n\n    this.setState({loading: false});\n  };\n\n  get hasAuthProviders() {\n    if (this.state.authConfig === null) {\n      return false;\n    }\n\n    const {githubLoginLink, googleLoginLink, vstsLoginLink} = this.state.authConfig;\n    return !!(githubLoginLink || vstsLoginLink || googleLoginLink);\n  }\n\n  render() {\n    const {api} = this.props;\n    const {loading, error, activeTab, authConfig} = this.state;\n\n    const FormComponent = FORM_COMPONENTS[activeTab];\n\n    const tabs: TabConfig[] = [\n      ['login', t('Login')],\n      ['sso', t('Single Sign-On')],\n      ['register', t('Register'), !authConfig?.canRegister],\n    ];\n\n    const renderTab = ([key, label, disabled]: TabConfig) =>\n      !disabled && (\n        <li key={key} className={activeTab === key ? 'active' : ''}>\n          <a href=\"#\" onClick={e => this.handleSetTab(key, e)}>\n            {label}\n          </a>\n        </li>\n      );\n\n    return (\n      <React.Fragment>\n        <Header>\n          <Heading>{t('Sign in to continue')}</Heading>\n          <AuthNavTabs>{tabs.map(renderTab)}</AuthNavTabs>\n        </Header>\n        {loading && <LoadingIndicator />}\n        {error && (\n          <StyledLoadingError\n            message={t('Unable to load authentication configuration')}\n            onRetry={this.fetchData}\n          />\n        )}\n        {!loading && authConfig !== null && !error && (\n          <FormWrapper hasAuthProviders={this.hasAuthProviders}>\n            <FormComponent {...{api, authConfig}} />\n          </FormWrapper>\n        )}\n      </React.Fragment>\n    );\n  }\n}\n\nconst StyledLoadingError = styled(LoadingError)`\n  margin: ${space(2)};\n`;\n\nconst Header = styled('div')`\n  border-bottom: 1px solid ${p => p.theme.border};\n  padding: 20px 40px 0;\n`;\n\nconst Heading = styled('h3')`\n  font-size: 24px;\n  margin: 0 0 20px 0;\n`;\n\nconst AuthNavTabs = styled(NavTabs)`\n  margin: 0;\n`;\n\nconst FormWrapper = styled('div')<{hasAuthProviders: boolean}>`\n  padding: 35px;\n  width: ${p => (p.hasAuthProviders ? '600px' : '490px')};\n`;\n\nconst formFooterClass = `\n  display: grid;\n  grid-template-columns: max-content 1fr;\n  grid-gap: ${space(1)};\n  align-items: center;\n  justify-items: end;\n  border-top: none;\n  margin-bottom: 0;\n  padding: 0;\n`;\n\nexport {formFooterClass};\n\nexport default withApi(Login);\n"],"sourceRoot":""}