(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[128],{2884:function(t,e,a){"use strict";a.r(e),a.d(e,"OrganizationStatsContainer",(function(){return at}));var r=a(5),n=a.n(r),c=a(9),o=a.n(c),s=a(10),i=a.n(s),l=a(11),u=a.n(l),d=a(12),f=a.n(d),p=a(7),j=a.n(p),b=a(1),g=a.n(b),h=a(264),O=a.n(h),v=a(2),y=a(38),m=a(47),P=a(54),k=a(711),w=a(131),R=a(44),q=a(443),S=a(694),D=a(96),E=a(222),T=a(154),L=a(70),z=a(15),x=a(0),N=function(t){var e=t.message;return Object(x.f)(T.a,{features:["performance-view"]},Object(x.f)(L.b,{type:"info",icon:Object(x.f)(z.J,null),"data-test-id":"performance-usage"},e||Object(v.b)("Transactions, sessions, and attachments are not yet included in the chart.")))};N.displayName="PerformanceAlert";var M=N,A=a(14),F=a.n(A),C=a(3),U=a(22),I=a(188),W=a(6),J=a(88),B=a(46),_=Object(C.a)("div",{target:"ezq28wl0",label:"ProjectTableLayout"})({name:"1bpd1bq",styles:"display:grid;grid-template-columns:auto 110px 120px 100px 100px;width:100%;"}),G=Object(C.a)("div",{target:"ezq28wl1",label:"ProjectTableDataElement"})("text-align:right;padding:0 ",Object(W.a)(.5),";",B.a,";"),H=function(t){var e=t.projectMap,a=t.projectTotals,r=t.orgTotal,n=t.organization,c=function(t,e){return 0===e?"":Object(J.h)(t/e,0)};if(!a)return null;var o=a.sort((function(t,e){return e.received-t.received})).map((function(t,a){var o=e[t.id];if(!o)return null;var s="/organizations/".concat(n.slug,"/issues/?project=").concat(o.id);return Object(x.f)(K,{key:a},Object(x.f)(Y,null,Object(x.f)(U.Link,{to:s},o.slug)),Object(x.f)(G,null,Object(x.f)(I.a,{value:t.accepted}),Object(x.f)(Q,null,c(t.accepted,r.accepted))),Object(x.f)(G,null,Object(x.f)(I.a,{value:t.rejected}),Object(x.f)(Q,null,c(t.rejected,r.rejected))),Object(x.f)(G,null,Object(x.f)(I.a,{value:t.blacklisted}),Object(x.f)(Q,null,c(t.blacklisted,r.blacklisted))),Object(x.f)(G,null,Object(x.f)(I.a,{value:t.received}),Object(x.f)(Q,null,c(t.received,r.received))))}));return Object(x.f)(g.a.Fragment,null,o)};H.displayName="ProjectTable";var Y=Object(C.a)(G,{target:"e138erfd0",label:"StyledProjectTitle"})({name:"vpdd6b",styles:"display:flex;align-items:center;text-align:left;"}),K=Object(C.a)(_,{target:"e138erfd1",label:"StyledProjectTableLayout"})("padding:",Object(W.a)(2),";&:not(:last-child){border-bottom:1px solid ",(function(t){return t.theme.innerBorder}),";}"),Q=Object(C.a)((function(t){var e=t.children,a=F()(t,["children"]);return""===e?null:Object(x.f)("div",a,e)}),{target:"e138erfd2",label:"Percentage"})("margin-top:",Object(W.a)(.25),";color:",(function(t){return t.theme.gray300}),";font-size:12px;line-height:1.2;"),V=H,X=a(696);function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,r=j()(t);if(e){var n=j()(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return f()(this,a)}}var $=function(t){u()(a,t);var e=Z(a);function a(){return o()(this,a),e.apply(this,arguments)}return i()(a,[{key:"renderContent",value:function(){var t=this.props,e=t.statsLoading,a=t.orgTotal,r=t.statsError,n=t.orgSeries,c=t.projectsLoading,o=t.projectTotals,s=t.projectMap,i=t.projectsError,l=t.organization,u=null==n?void 0:n.map((function(t){return t.color||""}));return Object(x.f)("div",null,Object(x.f)(q.a,{withMargins:!0},Object(v.b)("Organization Stats")),Object(x.f)("div",{className:"row"},Object(x.f)("div",{className:"col-md-9"},Object(x.f)(X.a,null,Object(v.b)("The chart below reflects events the system has received\n                across your entire organization. Events are broken down into\n                three categories: Accepted, Rate Limited, and Filtered. Rate\n                Limited events are entries that the system threw away due to quotas\n                being hit, and Filtered events are events that were blocked\n                due to your inbound data filter rules."))),a&&Object(x.f)("div",{className:"col-md-3 stats-column"},Object(x.f)("h6",{className:"nav-header"},Object(v.b)("Events per minute")),Object(x.f)("p",{className:"count"},a.avgRate))),Object(x.f)("div",null,Object(x.f)(M,null),e?Object(x.f)(R.default,null):r?Object(x.f)(w.a,null):Object(x.f)(D.a,null,Object(x.f)(D.c,{withPadding:!0},Object(x.f)(k.a,{isGroupedByDate:!0,showTimeInTooltip:!0,labelYAxisExtents:!0,stacked:!0,height:150,colors:u,series:null!=n?n:void 0})))),Object(x.f)(D.a,null,Object(x.f)(D.e,null,Object(x.f)(_,null,Object(x.f)("div",null,Object(v.b)("Project")),Object(x.f)(G,null,Object(v.b)("Accepted")),Object(x.f)(G,null,Object(v.b)("Rate Limited")),Object(x.f)(G,null,Object(v.b)("Filtered")),Object(x.f)(G,null,Object(v.b)("Total")))),Object(x.f)(D.c,null,!a||!o||e||c?Object(x.f)(R.default,null):i?Object(x.f)(w.a,null):Object(x.f)(V,{projectTotals:o,orgTotal:a,organization:l,projectMap:s}))),this.props.pageLinks&&Object(x.f)(S.a,this.props))}},{key:"render",value:function(){return Object(x.f)(E.b,null,this.renderContent())}}]),a}(g.a.Component);$.displayName="OrganizationStats";var tt=$;function et(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,r=j()(t);if(e){var n=j()(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return f()(this,a)}}var at=function(t){u()(a,t);var e=et(a);function a(t){var r;o()(this,a),r=e.call(this,t);var n=Math.floor((new Date).getTime()/1e3),c=n-604800;return r.state={projectsError:!1,projectsLoading:!1,projectsRequestsPending:0,statsError:!1,statsLoading:!1,statsRequestsPending:0,projectMap:{},rawProjectData:{received:{},rejected:{},blacklisted:{}},rawOrgData:{received:[],rejected:[],blacklisted:[]},orgSeries:null,orgTotal:null,projectTotals:null,querySince:c,queryUntil:n,pageLinks:null},r}return i()(a,[{key:"UNSAFE_componentWillMount",value:function(){this.fetchData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(t){t.location.search!==this.props.location.search&&this.setState({projectsError:!1,projectsRequestsPending:1,projectsLoading:!0})}},{key:"componentDidUpdate",value:function(t){var e=t.params,a=this.props.params;e.orgId!==a.orgId&&this.fetchData(),t.location.search!==this.props.location.search&&(window.scrollTo&&window.scrollTo(0,0),this.fetchProjectData());var r=this.state;r.statsLoading&&!r.statsRequestsPending&&this.processOrgData(),r.projectsLoading&&!r.projectsRequestsPending&&this.processProjectData()}},{key:"fetchProjectData",value:function(){var t=this;this.props.api.request(this.getOrganizationProjectsEndpoint(),{query:this.props.location.query,success:function(e,a,r){var n={};e.forEach((function(t){n[t.id]=t})),t.setState((function(t){return{pageLinks:r?r.getResponseHeader("Link"):null,projectMap:n,projectsRequestsPending:t.projectsRequestsPending-1}}))},error:function(){t.setState({projectsError:!0})}})}},{key:"fetchData",value:function(){var t=this;this.setState({statsError:!1,statsLoading:!0,statsRequestsPending:3,projectsError:!1,projectsLoading:!0,projectsRequestsPending:4});var e=this.getOrganizationStatsEndpoint();Object.keys(this.state.rawOrgData).forEach((function(a){t.props.api.request(e,{query:{since:t.state.querySince,until:t.state.queryUntil,resolution:"1h",stat:a},success:function(e){t.setState((function(t){var r=t.rawOrgData;return r[a]=e,{rawOrgData:r,statsRequestsPending:t.statsRequestsPending-1}}))},error:function(){t.setState({statsError:!0})}})})),Object.keys(this.state.rawProjectData).forEach((function(a){t.props.api.request(e,{query:{since:t.state.querySince,until:t.state.queryUntil,stat:a,group:"project"},success:function(e){t.setState((function(t){var r=t.rawProjectData;return r[a]=e,{rawProjectData:r,projectsRequestsPending:t.projectsRequestsPending-1}}))},error:function(){t.setState({projectsError:!0})}})})),this.fetchProjectData()}},{key:"getOrganizationStatsEndpoint",value:function(){return"/organizations/"+this.props.params.orgId+"/stats/"}},{key:"getOrganizationProjectsEndpoint",value:function(){return"/organizations/"+this.props.params.orgId+"/projects/"}},{key:"processOrgData",value:function(){var t=0,e=0,a=0,r=[0,0],n=this.state.rawOrgData,c={seriesName:Object(v.b)("Accepted"),color:y.c.gray200,data:[]},o={seriesName:Object(v.b)("Rate limited"),color:y.c.red300,data:[]},s={seriesName:Object(v.b)("Filtered"),color:y.c.orange400,data:[]};n.received.forEach((function(i,l){var u=i[1],d=n.rejected[l][1],f=n.blacklisted[l][1],p=Math.max(0,u-d-f),j=1e3*i[0];c.data.push({name:j,value:p}),o.data.push({name:j,value:d}),s.data.push({name:j,value:f}),t+=u,e+=d,a+=f,u>0&&(r[0]+=u,r[1]+=1)})),this.setState({orgSeries:[c,o,s],orgTotal:{id:"",received:t,rejected:e,blacklisted:a,accepted:Math.max(0,t-e-a),avgRate:r[1]?Math.round(r[0]/r[1]/60):0},statsLoading:!1})}},{key:"processProjectData",value:function(){var t=this.state.rawProjectData,e=[];Object.keys(t.received).forEach((function(a){var r=t.received[a],n=0,c=0,o=0;r.forEach((function(e,r){n+=e[1],c+=t.rejected[a][r][1],o+=t.blacklisted[a][r][1]})),e.push({id:a,received:n,rejected:c,blacklisted:o,accepted:Math.max(0,n-c-o)})})),this.setState({projectTotals:e,projectsLoading:!1})}},{key:"render",value:function(){var t=this.props.organization;return Object(x.f)(O.a,{title:"Stats - ".concat(t.slug," - Sentry")},Object(x.f)(tt,n()({organization:t},this.state)))}}]),a}(g.a.Component);at.displayName="OrganizationStatsContainer";e.default=Object(m.a)(Object(P.a)(at))}}]);
//# sourceMappingURL=OrganizationStats.js.map