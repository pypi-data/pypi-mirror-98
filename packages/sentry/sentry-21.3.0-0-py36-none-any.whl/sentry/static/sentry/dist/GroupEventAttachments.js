(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[87],{1951:function(t,e,n){"use strict";n(1);var r=n(18),a=n(185),c=n(0);function o(t){var e=t.className,n=t.bytes;return Object(c.f)("span",{className:e},Object(a.a)({value:Object(r.j)(n),fixed:"xx KB"}))}o.displayName="FileSize",e.a=o},2045:function(t,e,n){"use strict";var r=n(9),a=n.n(r),c=n(10),o=n.n(c),i=n(11),u=n.n(i),l=n(12),s=n.n(l),f=n(7),p=n.n(f),b=n(1),d=n.n(b),h=n(36),v=n(226),y=n(54);function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return s()(this,n)}}var j=function(t){u()(n,t);var e=O(n);function n(){return a()(this,n),e.apply(this,arguments)}return o()(n,[{key:"hasRole",value:function(){var t,e=h.default.get("user"),n=this.props,r=n.organization,a=n.role,c=r.availableRoles,o=null!==(t=r.role)&&void 0!==t?t:"";if(!e)return!1;if(e.isSuperuser)return!0;if(!Array.isArray(c))return!1;var i=c.map((function(t){return t.id}));if(!i.includes(a)||!i.includes(o))return!1;var u=i.indexOf(a);return i.indexOf(o)>=u}},{key:"render",value:function(){var t=this.props.children,e=this.hasRole();return Object(v.a)(t)?t({hasRole:e}):e&&t?t:null}}]),n}(d.a.Component);j.displayName="Role",e.a=Object(y.a)(j)},2091:function(t,e,n){var r=n(1113),a=n(582),c=n(2092),o=n(1111),i=a((function(t){return c(r(t,o))}));t.exports=i},2092:function(t,e,n){var r=n(2093),a=n(587),c=n(728);t.exports=function(t,e,n){var o=t.length;if(o<2)return o?c(t[0]):[];for(var i=-1,u=Array(o);++i<o;)for(var l=t[i],s=-1;++s<o;)s!=i&&(u[i]=r(u[i]||l,t[s],e,n));return c(a(u,1),e,n)}},2093:function(t,e,n){var r=n(734),a=n(736),c=n(1112),o=n(384),i=n(386),u=n(735);t.exports=function(t,e,n,l){var s=-1,f=a,p=!0,b=t.length,d=[],h=e.length;if(!b)return d;n&&(e=o(e,i(n))),l?(f=c,p=!1):e.length>=200&&(f=u,p=!1,e=new r(e));t:for(;++s<b;){var v=t[s],y=null==n?v:n(v);if(v=l||0!==v?v:0,p&&y==y){for(var O=h;O--;)if(e[O]===y)continue t;d.push(v)}else f(e,y,l)||d.push(v)}return d}},2102:function(t,e,n){"use strict";var r=n(9),a=n.n(r),c=n(10),o=n.n(c),i=n(11),u=n.n(i),l=n(12),s=n.n(l),f=n(7),p=n.n(f),b=n(1),d=n.n(b),h=n(2045),v=n(54),y=n(0);function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return s()(this,n)}}var j=function(t){u()(n,t);var e=O(n);function n(){return a()(this,n),e.apply(this,arguments)}return o()(n,[{key:"getDownloadUrl",value:function(){var t=this.props,e=t.attachment,n=t.organization,r=t.eventId,a=t.projectId;return"/api/0/projects/".concat(n.slug,"/").concat(a,"/events/").concat(r,"/attachments/").concat(e.id,"/")}},{key:"render",value:function(){var t=this,e=this.props,n=e.children,r=e.organization;return Object(y.f)(h.a,{role:r.attachmentsRole},(function(e){var r=e.hasRole;return n(r?t.getDownloadUrl():null)}))}}]),n}(d.a.PureComponent);j.displayName="AttachmentUrl",e.a=Object(v.a)(j)},2116:function(t,e,n){"use strict";var r=n(20),a=n.n(r),c=n(29),o=n.n(c),i=n(9),u=n.n(i),l=n(10),s=n.n(l),f=n(11),p=n.n(f),b=n(12),d=n.n(b),h=n(7),v=n.n(h),y=n(3),O=n(1),j=n.n(O),m=n(27),g=n(76),w=n(137),D=n(15),R=n(2),I=n(6),P=n(47),A=n(0);function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return d()(this,n)}}var x=function(t){p()(n,t);var e=k(n);function n(){var t;u()(this,n);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(t=e.call.apply(e,[this].concat(c))).handleDelete=o()(a.a.mark((function e(){var n,r,c,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props,r=n.api,c=n.url,o=n.onDelete,i=n.attachmentId,!c){e.next=10;break}return e.prev=2,e.next=5,r.requestPromise(c,{method:"DELETE"});case 5:o(i),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:case"end":return e.stop()}}),e,null,[[2,8]])}))),t}return s()(n,[{key:"handlePreview",value:function(){var t=this.props,e=t.onPreview,n=t.attachmentId;e&&e(n)}},{key:"render",value:function(){var t=this,e=this.props,n=e.url,r=e.withPreviewButton,a=e.hasPreview,c=e.previewIsOpen;return Object(A.f)(g.a,{gap:1},Object(A.f)(w.a,{confirmText:Object(R.b)("Delete"),message:Object(R.b)("Are you sure you wish to delete this file?"),priority:"danger",onConfirm:this.handleDelete,disabled:!n},Object(A.f)(m.b,{size:"xsmall",icon:Object(A.f)(D.r,{size:"xs"}),label:Object(R.b)("Delete"),disabled:!n,title:n?void 0:Object(R.b)("Insufficient permissions to delete attachments")})),Object(A.f)(z,{size:"xsmall",icon:Object(A.f)(D.t,{size:"xs"}),href:n?"".concat(n,"?download=1"):"",disabled:!n,title:n?void 0:Object(R.b)("Insufficient permissions to download attachments"),label:Object(R.b)("Download")}),r&&Object(A.f)(z,{size:"xsmall",disabled:!n||!a,priority:c?"primary":"default",icon:Object(A.f)(D.pb,{size:"xs"}),onClick:function(){return t.handlePreview()},title:n?a?void 0:Object(R.b)("This attachment cannot be previewed"):Object(R.b)("Insufficient permissions to preview attachments")},Object(R.b)("Preview")))}}]),n}(j.a.Component);x.displayName="EventAttachmentActions";var z=Object(y.a)(m.b,{target:"ewomrm90",label:"DownloadButton"})("margin-right:",Object(I.a)(.5),";");e.a=Object(P.a)(x)},2117:function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var r=n(8),a=n.n(r),c=n(3),o=(n(1),n(22)),i=n(114),u=n.n(i),l=n(2091),s=n.n(l),f=n(27),p=n(76),b=n(2),d=n(6),h=n(0);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){a()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O=["event.minidump","event.applecrashreport"],j=function(t){var e=t.location,n=e.query,r=e.pathname,a=n.types,c=u()(n,"types"),o=y(y({},n),{},{types:O}),i="";return void 0===a?i="all":0===s()(O,a).length&&(i="onlyCrash"),Object(h.f)(m,null,Object(h.f)(p.a,{merged:!0,active:i},Object(h.f)(f.b,{barId:"all",size:"small",to:{pathname:r,query:c}},Object(b.b)("All Attachments")),Object(h.f)(f.b,{barId:"onlyCrash",size:"small",to:{pathname:r,query:o}},Object(b.b)("Only Crash Reports"))))};j.displayName="GroupEventAttachmentsFilter";var m=Object(c.a)("div",{target:"eoyp7bi0",label:"FilterWrapper"})("display:flex;justify-content:flex-end;margin-bottom:",Object(d.a)(3),";");e.b=Object(o.withRouter)(j)},2882:function(t,e,n){"use strict";n.r(e);var r=n(1),a=n.n(r),c=n(154),o=n(446),i=n(54),u=n(8),l=n.n(u),s=n(24),f=n.n(s),p=n(9),b=n.n(p),d=n(10),h=n.n(d),v=n(187),y=n.n(v),O=n(11),j=n.n(O),m=n(12),g=n.n(m),w=n(7),D=n.n(w),R=n(22),I=n(296),P=n.n(I),A=n(693),k=n(327),x=n(44),z=n(694),S=n(96),E=n(2),N=n(2117),C=n(3),q=n(441),T=n(2116),B=n(1951),F=n(62),G=n(2102),L={"event.minidump":Object(E.b)("Minidump"),"event.applecrashreport":Object(E.b)("Apple Crash Report"),"event.attachment":Object(E.b)("Other")},W=n(0),U=function(t){var e=t.attachment,n=t.projectId,r=t.onDelete,a=t.isDeleted,c=t.orgId,o=t.groupId;return Object(W.f)(_,{isDeleted:a},Object(W.f)("td",null,Object(W.f)("h5",null,e.name,Object(W.f)("br",null),Object(W.f)("small",null,Object(W.f)(q.a,{date:e.dateCreated})," Â·"," ",Object(W.f)(F.a,{to:"/organizations/".concat(c,"/issues/").concat(o,"/events/").concat(e.event_id,"/")},e.event_id)))),Object(W.f)("td",null,L[e.type]||Object(E.b)("Other")),Object(W.f)("td",null,Object(W.f)(B.a,{bytes:e.size})),Object(W.f)("td",null,Object(W.f)(J,null,Object(W.f)(G.a,{projectId:n,eventId:e.event_id,attachment:e},(function(t){return!a&&Object(W.f)(T.a,{url:t,onDelete:r,attachmentId:e.id})})))))};U.displayName="GroupEventAttachmentsTableRow";var _=Object(C.a)("tr",{target:"ekv38qo0",label:"TableRow"})("opacity:",(function(t){return t.isDeleted?.3:1}),";td{text-decoration:",(function(t){return t.isDeleted?"line-through":"normal"}),";}"),J=Object(C.a)("div",{target:"ekv38qo1",label:"ActionsWrapper"})({name:"1baulvz",styles:"display:inline-block;"}),Q=U,K=function(t){var e=t.attachments,n=t.orgId,r=t.projectId,a=t.groupId,c=t.onDelete,o=t.deletedAttachments,i=[Object(E.b)("Name"),Object(E.b)("Type"),Object(E.b)("Size"),Object(E.b)("Actions")];return Object(W.f)("table",{className:"table events-table"},Object(W.f)("thead",null,Object(W.f)("tr",null,i.map((function(t){return Object(W.f)("th",{key:t},t)})))),Object(W.f)("tbody",null,e.map((function(t){return Object(W.f)(Q,{key:t.id,attachment:t,orgId:n,projectId:r,groupId:a,onDelete:c,isDeleted:o.some((function(e){return t.id===e}))})}))))};K.displayName="GroupEventAttachmentsTable";var M=K;function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=D()(t);if(e){var a=D()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return g()(this,n)}}var Y=function(t){j()(n,t);var e=X(n);function n(){var t;b()(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).handleDelete=function(e){t.setState((function(t){return{deletedAttachments:[].concat(f()(t.deletedAttachments),[e])}}))},t}return h()(n,[{key:"getDefaultState",value:function(){return V(V({},y()(D()(n.prototype),"getDefaultState",this).call(this)),{},{deletedAttachments:[]})}},{key:"getEndpoints",value:function(){var t=this.props,e=t.params,n=t.location;return[["eventAttachments","/issues/".concat(e.groupId,"/attachments/"),{query:V(V({},P()(n.query,["cursor","environment","types"])),{},{limit:50})}]]}},{key:"renderNoQueryResults",value:function(){return Object(W.f)(k.a,null,Object(W.f)("p",null,Object(E.b)("Sorry, no event attachments match your search query.")))}},{key:"renderEmpty",value:function(){return Object(W.f)(k.a,null,Object(W.f)("p",null,Object(E.b)("There don't seem to be any event attachments yet.")))}},{key:"renderLoading",value:function(){return this.renderBody()}},{key:"renderInnerBody",value:function(){var t=this.props,e=t.projectSlug,n=t.params,r=t.location,a=this.state,c=a.loading,o=a.eventAttachments,i=a.deletedAttachments;return c?Object(W.f)(x.default,null):o.length>0?Object(W.f)(M,{attachments:o,orgId:n.orgId,projectId:e,groupId:n.groupId,onDelete:this.handleDelete,deletedAttachments:i}):r.query.types?this.renderNoQueryResults():this.renderEmpty()}},{key:"renderBody",value:function(){return Object(W.f)(a.a.Fragment,null,Object(W.f)(N.b,null),Object(W.f)(S.a,{className:"event-list"},Object(W.f)(S.c,null,this.renderInnerBody())),Object(W.f)(z.a,{pageLinks:this.state.eventAttachmentsPageLinks}))}}]),n}(A.a),Z=R.withRouter(Y),$=function(t){var e=t.organization,n=t.group;return Object(W.f)(c.a,{features:["event-attachments"],organization:e,renderDisabled:function(t){return Object(W.f)(o.a,t)}},Object(W.f)(Z,{projectSlug:n.project.slug}))};$.displayName="GroupEventAttachmentsContainer";e.default=Object(i.a)($)}}]);
//# sourceMappingURL=GroupEventAttachments.js.map