!function(e){function t(t){for(var n,i,c=t[0],l=t[1],s=t[2],u=0,v=[];u<c.length;u++)i=c[u],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&v.push(a[i][0]),a[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(d&&d(t);v.length;)v.shift()();return r.push.apply(r,s||[]),o()}function o(){for(var e,t=0;t<r.length;t++){for(var o=r[t],n=!0,c=1;c<o.length;c++){var l=o[c];0!==a[l]&&(n=!1)}n&&(r.splice(t--,1),e=i(i.s=o[0]))}return e}var n={},a={155:0},r=[];function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.e=function(){return Promise.resolve()},i.m=e,i.c=n,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/";var c=window.coreJsonp=window.coreJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var d=l;r.push([1960,0]),o()}({1960:function(e,t,o){e.exports=o(1961)},1961:function(e,t,o){"use strict";o.r(t);var n=o(10),a=o.n(n),r=o(5),i=o.n(r),c=o(35);const l=a.a.bind(null,{endpoint:"rb.roombooking",rules:[{args:["path"],converters:{path:"PathConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/rooms/",isDynamic:!1},{data:"path",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/rooms",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),s=a.a.bind(null,{endpoint:"rb.check_room_available",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/rooms/api/rooms/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/availability/simple",isDynamic:!1}]}]},"/");window.setupEventCreationDialog=function(e){e=$.extend({categoryField:null,protectionModeFields:null,initialCategory:null,checkAvailability:!1,rbExcludedCategories:null,serverDefaultTimezone:null},e);const t=$($.parseHTML($("#event-creation-protection-messages").html())),o=$("<div>",{class:"form-group",css:{marginTop:"5px"}}),n=$("#event-creation-create_booking"),a=$("#room-available"),r=$("#room-available-prebook"),d=$("#room-conflict-booking"),u=$("#room-conflict-prebooking"),v=$("#room-conflict-prebooking-prebook"),m=$("#room-user-booking"),p=$("#room-user-prebooking"),f=$("#room-unbookable"),g=$("#room-cannot-book"),h=$("#create-booking"),b=$("#create-prebooking"),y=$("#create-booking-over-prebooking"),_=$("#create-prebooking-over-prebooking");let Y,M,k,D,H,O,S,T=null,j=!1;function x(){let n=e.protectionModeFields.filter(":checked").val();"inheriting"===n&&(n=T.is_protected?"inheriting-protected":"inheriting-public");const a=t.filter(".{0}-protection-message".format(n));a.find(".js-category-title").text(T.title),o.html(a)}function P(e){k=i()(`${e.date} ${e.time}`,"YYYY-MM-DD HH:mm"),D=i()(k).add(e.duration,"minutes")}function F(t){return e.rbExcludedCategories.some(e=>parseInt(e.id,10)===t)}function w(e){const t={path:"calendar",date:k.format("YYYY-MM-DD"),text:O.room_name},o=l(t);e.find("a").prop("href",o)}function C(e){M&&(e&&($("#availability-messages").find("input[id^='create']").prop("checked",!1),n.val("false")),M.hide())}function E(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(C(t),!("room_id"in O)||!k.isValid()||!D.isValid()||!k.isSame(D,"day")||k.isSameOrAfter(D)||F(H.id)||S!==e.serverDefaultTimezone||j)return void n.val("false");const o={room_id:O.room_id,start_dt:k.format(i.a.HTML5_FMT.DATETIME_LOCAL),end_dt:D.format(i.a.HTML5_FMT.DATETIME_LOCAL)};$.ajax({url:s(o),method:"GET",dataType:"json",contentType:"application/json",error:handleAjaxError,success(e){(e=Object(c.a)(e)).userBooking?(n.val("false"),M=m,w(M)):e.userPrebooking?(n.val("false"),M=p,w(M)):e.conflictBooking?(n.val("false"),M=d,w(M)):e.unbookable?(n.val("false"),M=f,w(M)):e.conflictPrebooking?e.canBook?(n.val(String(y[0].checked)),M=u,w(M)):e.canPrebook?(n.val(String(_[0].checked)),M=v,w(M)):(n.val("false"),M=g):e.canBook?(n.val(String(h[0].checked)),M=a):e.canPrebook?(n.val(String(b[0].checked)),M=r):(n.val("false"),M=g),M.show()}})}o.appendTo(e.protectionModeFields.closest(".form-field")),e.categoryField.on("indico:categorySelected",(t,o)=>{T||(e.protectionModeFields.prop("disabled",!1),e.protectionModeFields.filter("[value=inheriting]").prop("checked",!0)),T=o,x()}),e.protectionModeFields.on("change",(function(){x()})),e.initialCategory?e.categoryField.trigger("indico:categorySelected",[e.initialCategory]):e.protectionModeFields.prop("disabled",!0),e.checkAvailability&&(function(){const e=$("#event-creation-start_dt-datestorage").val(),t=$("#event-creation-start_dt-timestorage").val(),o=$("#event-creation-end_dt-datestorage").val(),n=$("#event-creation-end_dt-timestorage").val(),a=$("#event-creation-occurrences").val(),r=a?JSON.parse(a):null;O=JSON.parse($("#event-creation-location_data").val()),S=$("#event-creation-timezone").val(),H=JSON.parse($("#event-creation-category").val()),r&&1===r.length?P(r[0]):(k=i()(`${e} ${t}`,"DD/MM/YYYY HH:mm"),D=i()(`${o} ${n}`,"DD/MM/YYYY HH:mm"))}(),$("#event-creation-location_data").on("change",(function(){O=JSON.parse($(this).val()),Y!==O.room_id&&(Y=O.room_id,E(!0))})),$("#event-creation-start_dt-datestorage").on("change",(function(){const e=$(this).val(),t=$("#event-creation-start_dt-timestorage").val(),o=$("#event-creation-end_dt-datestorage").val(),n=$("#event-creation-end_dt-timestorage").val();k=i()(`${e} ${t}`,"DD/MM/YYYY HH:mm"),D=i()(`${o} ${n}`,"DD/MM/YYYY HH:mm"),D.isBefore(k)&&(D=i()(`${e} ${n}`,"DD/MM/YYYY HH:mm")),E()})),$("#event-creation-start_dt-timestorage").on("change",(function(){const e=$("#event-creation-start_dt-datestorage").val(),t=$("#event-creation-start_dt-timestorage").val();k=i()(`${e} ${t}`,"DD/MM/YYYY HH:mm"),E()})),$("#event-creation-end_dt-datestorage").on("change",(function(){const e=$(this).val(),t=$("#event-creation-end_dt-timestorage").val();D=i()(`${e} ${t}`,"DD/MM/YYYY HH:mm"),E()})),$("#event-creation-end_dt-timestorage").on("change",(function(){const e=$("#event-creation-end_dt-datestorage").val(),t=$(this).val();D=i()(`${e} ${t}`,"DD/MM/YYYY HH:mm"),E()})),$("#event-creation-occurrences").on("change",(function(){const e=JSON.parse($(this).val());1===e.length?(P(e[0]),j=!1):j=!0,E()})),$("#event-creation-timezone").on("change",(function(){S=$(this).val(),E()})),$("#event-creation-category").on("change",(function(){H=JSON.parse($(this).val()),E()})),h.add(b).add(y).add(_).on("change",(function(){n.val(String(this.checked))})))}}});
//# sourceMappingURL=module_events.creation.4d4d2e86.bundle.js.map