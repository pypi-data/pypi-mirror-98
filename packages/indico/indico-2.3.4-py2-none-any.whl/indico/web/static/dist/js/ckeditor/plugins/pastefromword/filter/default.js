/**
 * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or http://ckeditor.com/license
 */
!function(){var t,e,r,i,s=CKEDITOR.tools,n=["o:p","xml","script","meta","link"],a={},l=0;function o(){return!1}function u(t,e){var r,i=[];for(t.filterChildren(e),r=t.children.length-1;r>=0;r--)i.unshift(t.children[r]),t.children[r].remove();var s=t.attributes,n=t,a=!0;for(var l in s)if(a)a=!1;else{var o=new CKEDITOR.htmlParser.element(t.name);o.attributes[l]=s[l],n.add(o),n=o,delete s[l]}for(r=0;r<i.length;r++)n.add(i[r])}CKEDITOR.plugins.pastefromword={},CKEDITOR.cleanWord=function(c,m){var f=Boolean(c.match(/mso-list:\s*l\d+\s+level\d+\s+lfo\d+/));CKEDITOR.plugins.clipboard.isCustomDataTypesSupported&&(c=CKEDITOR.plugins.pastefromword.styles.inliner.inline(c).getBody().getHtml()),c=c.replace(/<!\[/g,"\x3c!--[").replace(/\]>/g,"]--\x3e");var d=CKEDITOR.htmlParser.fragment.fromHtml(c);i=new CKEDITOR.htmlParser.filter({root:function(e){e.filterChildren(i),CKEDITOR.plugins.pastefromword.lists.cleanup(t.createLists(e))},elementNames:[[/^\?xml:namespace$/,""],[/^v:shapetype/,""],[new RegExp(n.join("|")),""]],elements:{a:function(t){if(t.attributes.name){if("_GoBack"==t.attributes.name)return void delete t.name;if(t.attributes.name.match(/^OLE_LINK\d+$/))return void delete t.name}if(t.attributes.href&&t.attributes.href.match(/#.+$/)){var e=t.attributes.href.match(/#(.+)$/)[1];a[e]=t}if(t.attributes.name&&a[t.attributes.name]){var r=a[t.attributes.name];r.attributes.href=r.attributes.href.replace(/.*#(.*)$/,"#$1")}},div:function(t){e.createStyleStack(t,i,m)},img:function(t){var r={width:function(r){e.setStyle(t,"width",r+"px")},height:function(r){e.setStyle(t,"height",r+"px")}};if(t.parent&&t.parent.attributes){var i=t.parent.attributes,s=i.style||i.STYLE;s&&s.match(/mso\-list:\s?Ignore/)&&(t.attributes["cke-ignored"]=!0)}e.mapStyles(t,r),t.attributes.src&&t.attributes.src.match(/^file:\/\//)&&t.attributes.alt&&t.attributes.alt.match(/^https?:\/\//)&&(t.attributes.src=t.attributes.alt)},p:function(n){if(n.filterChildren(i),n.attributes.style&&n.attributes.style.match(/display:\s*none/i))return!1;if(t.thisIsAListItem(m,n))r.isEdgeListItem(m,n)&&r.cleanupEdgeListItem(n),t.convertToFakeListItem(m,n),s.array.reduce(n.children,(function(t,e){if("p"===e.name){if(t>0)new CKEDITOR.htmlParser.element("br").insertBefore(e);e.replaceWithChildren(),t+=1}return t}),0);else{var a=n.getAscendant((function(t){return"ul"==t.name||"ol"==t.name})),l=s.parseCssText(n.attributes.style);a&&!a.attributes["cke-list-level"]&&l["mso-list"]&&l["mso-list"].match(/level/)&&(a.attributes["cke-list-level"]=l["mso-list"].match(/level(\d+)/)[1]),m.config.enterMode==CKEDITOR.ENTER_BR&&(delete n.name,n.add(new CKEDITOR.htmlParser.element("br")))}e.createStyleStack(n,i,m)},pre:function(r){t.thisIsAListItem(m,r)&&t.convertToFakeListItem(m,r),e.createStyleStack(r,i,m)},h1:function(r){t.thisIsAListItem(m,r)&&t.convertToFakeListItem(m,r),e.createStyleStack(r,i,m)},h2:function(r){t.thisIsAListItem(m,r)&&t.convertToFakeListItem(m,r),e.createStyleStack(r,i,m)},h3:function(r){t.thisIsAListItem(m,r)&&t.convertToFakeListItem(m,r),e.createStyleStack(r,i,m)},h4:function(r){t.thisIsAListItem(m,r)&&t.convertToFakeListItem(m,r),e.createStyleStack(r,i,m)},h5:function(r){t.thisIsAListItem(m,r)&&t.convertToFakeListItem(m,r),e.createStyleStack(r,i,m)},h6:function(r){t.thisIsAListItem(m,r)&&t.convertToFakeListItem(m,r),e.createStyleStack(r,i,m)},font:function(t){if(t.getHtml().match(/^\s*$/))return new CKEDITOR.htmlParser.text(" ").insertAfter(t),!1;m&&!0===m.config.pasteFromWordRemoveFontStyles&&t.attributes.size&&delete t.attributes.size,CKEDITOR.dtd.tr[t.parent.name]&&CKEDITOR.tools.arrayCompare(CKEDITOR.tools.objectKeys(t.attributes),["class","style"])?e.createStyleStack(t,i,m):u(t,i)},ul:function(r){if(f)return"li"==r.parent.name&&0===s.indexOf(r.parent.children,r)&&e.setStyle(r.parent,"list-style-type","none"),t.dissolveList(r),!1},li:function(t){r.correctLevelShift(t),f&&(t.attributes.style=e.normalizedStyles(t,m),e.pushStylesLower(t))},ol:function(r){if(f)return"li"==r.parent.name&&0===s.indexOf(r.parent.children,r)&&e.setStyle(r.parent,"list-style-type","none"),t.dissolveList(r),!1},span:function(t){if(t.filterChildren(i),t.attributes.style=e.normalizedStyles(t,m),!t.attributes.style||t.attributes.style.match(/^mso\-bookmark:OLE_LINK\d+$/)||t.getHtml().match(/^(\s|&nbsp;)+$/)){for(var r=t.children.length-1;r>=0;r--)t.children[r].insertAfter(t);return!1}t.attributes.style.match(/FONT-FAMILY:\s*Symbol/i)&&t.forEach((function(t){t.value=t.value.replace(/&nbsp;/g,"")}),CKEDITOR.NODE_TEXT,!0),e.createStyleStack(t,i,m)},table:function(t){t._tdBorders={},t.filterChildren(i);var r,n=0;for(var a in t._tdBorders)t._tdBorders[a]>n&&(n=t._tdBorders[a],r=a);e.setStyle(t,"border",r);var l,o,u=t.parent,c=u&&u.parent;if(u.name&&"div"===u.name&&u.attributes.align&&1===s.objectKeys(u.attributes).length&&1===u.children.length){for(t.attributes.align=u.attributes.align,l=u.children.splice(0),t.remove(),o=l.length-1;o>=0;o--)c.add(l[o],u.getIndex());u.remove()}},td:function(t){var r=t.getAscendant("table"),n=r._tdBorders,a=["border","border-top","border-right","border-bottom","border-left"],l=s.parseCssText(r.attributes.style),o=l.background||l.BACKGROUND;o&&e.setStyle(t,"background",o,!0);var u=l["background-color"]||l["BACKGROUND-COLOR"];u&&e.setStyle(t,"background-color",u,!0);var c=s.parseCssText(t.attributes.style);for(var f in c){var d=c[f];delete c[f],c[f.toLowerCase()]=d}for(var p=0;p<a.length;p++)if(c[a[p]]){var h=c[a[p]];n[h]=n[h]?n[h]+1:1}e.createStyleStack(t,i,m,/margin|text\-align|padding|list\-style\-type|width|height|border|white\-space|vertical\-align|background/i)},"v:imagedata":o,"v:shape":function(t){var e=!1;if(t.parent.getFirst((function(r){"img"==r.name&&r.attributes&&r.attributes["v:shapes"]==t.attributes.id&&(e=!0)})),e)return!1;var r="";t.forEach((function(t){t.attributes&&t.attributes.src&&(r=t.attributes.src)}),CKEDITOR.NODE_ELEMENT,!0),t.filterChildren(i),t.name="img",t.attributes.src=t.attributes.src||r,delete t.attributes.type},style:function(){return!1},object:function(t){return!(!t.attributes||!t.attributes.data)}},attributes:{style:function(t,r){return e.normalizedStyles(r,m)||!1},class:function(t){return function(t){if(""===t)return!1;return t}(t.replace(/(el\d+)|(font\d+)|msonormal|msolistparagraph\w*/gi,""))},cellspacing:o,cellpadding:o,border:o,"v:shapes":o,"o:spid":o},comment:function(t){return t.match(/\[if.* supportFields.*\]/)&&l++,"[endif]"==t&&(l=l>0?l-1:0),!1},text:function(t,e){if(l)return"";var r=e.parent&&e.parent.parent;return r&&r.attributes&&r.attributes.style&&r.attributes.style.match(/mso-list:\s*ignore/i)?t.replace(/&nbsp;/g," "):t}});var p=new CKEDITOR.htmlParser.basicWriter;return i.applyTo(d),d.writeHtml(p),p.getHtml()},CKEDITOR.plugins.pastefromword.styles={setStyle:function(t,e,r,i){var n=s.parseCssText(t.attributes.style);i&&n[e]||(""===r?delete n[e]:n[e]=r,t.attributes.style=CKEDITOR.tools.writeCssText(n))},mapStyles:function(t,r){for(var i in r)t.attributes[i]&&("function"==typeof r[i]?r[i](t.attributes[i]):e.setStyle(t,r[i],t.attributes[i]),delete t.attributes[i])},normalizedStyles:function(e,r){var i=["background-color:transparent","border-image:none","color:windowtext","direction:ltr","mso-","text-indent","visibility:visible","div:border:none"],n=["font-family","font","font-size","color","background-color","line-height","text-decoration"],a=function(){for(var t=[],e=0;e<arguments.length;e++)arguments[e]&&t.push(arguments[e]);return-1!==s.indexOf(i,t.join(":"))},l=r&&!0===r.config.pasteFromWordRemoveFontStyles,o=s.parseCssText(e.attributes.style);"cke:li"==e.name&&o["TEXT-INDENT"]&&o.MARGIN&&(e.attributes["cke-indentation"]=t.getElementIndentation(e),o.MARGIN=o.MARGIN.replace(/(([\w\.]+ ){3,3})[\d\.]+(\w+$)/,"$10$3"));for(var u=s.objectKeys(o),c=0;c<u.length;c++){var m=u[c].toLowerCase(),f=o[u[c]],d=CKEDITOR.tools.indexOf;(l&&-1!==d(n,m.toLowerCase())||a(null,m,f)||a(null,m.replace(/\-.*$/,"-"))||a(null,m)||a(e.name,m,f)||a(e.name,m.replace(/\-.*$/,"-"))||a(e.name,m)||a(f))&&delete o[u[c]]}return CKEDITOR.tools.writeCssText(o)},createStyleStack:function(t,r,i,n){var a,l=[];for(t.filterChildren(r),a=t.children.length-1;a>=0;a--)l.unshift(t.children[a]),t.children[a].remove();e.sortStyles(t);var o=s.parseCssText(e.normalizedStyles(t,i)),u=t,c="span"===t.name;for(var m in o)if(!m.match(n||/margin|text\-align|width|border|padding/i))if(c)c=!1;else{var f=new CKEDITOR.htmlParser.element("span");f.attributes.style=m+":"+o[m],u.add(f),u=f,delete o[m]}for(CKEDITOR.tools.isEmpty(o)?delete t.attributes.style:t.attributes.style=CKEDITOR.tools.writeCssText(o),a=0;a<l.length;a++)u.add(l[a])},sortStyles:function(t){for(var e=["border","border-bottom","font-size","background"],r=s.parseCssText(t.attributes.style),i=s.objectKeys(r),n=[],a=[],l=0;l<i.length;l++)-1!==s.indexOf(e,i[l].toLowerCase())?n.push(i[l]):a.push(i[l]);n.sort((function(t,r){return s.indexOf(e,t.toLowerCase())-s.indexOf(e,r.toLowerCase())})),i=[].concat(n,a);var o={};for(l=0;l<i.length;l++)o[i[l]]=r[i[l]];t.attributes.style=CKEDITOR.tools.writeCssText(o)},pushStylesLower:function(t,r,i){if(!t.attributes.style||0===t.children.length)return!1;r=r||{};var n={"list-style-type":!0,width:!0,height:!0,border:!0,"border-":!0},a=s.parseCssText(t.attributes.style);for(var l in a)if(!(l.toLowerCase()in n||n[l.toLowerCase().replace(/\-.*$/,"-")]||l.toLowerCase()in r)){for(var o=!1,u=0;u<t.children.length;u++){var c=t.children[u];if(c.type===CKEDITOR.NODE_TEXT&&i){var m=new CKEDITOR.htmlParser.element("span");m.setHtml(c.value),c.replaceWith(m),c=m}c.type===CKEDITOR.NODE_ELEMENT&&(o=!0,e.setStyle(c,l,a[l]))}o&&delete a[l]}return t.attributes.style=CKEDITOR.tools.writeCssText(a),!0},inliner:{filtered:["break-before","break-after","break-inside","page-break","page-break-before","page-break-after","page-break-inside"],parse:function(t){var e=CKEDITOR.tools.parseCssText,r=CKEDITOR.plugins.pastefromword.styles.inliner.filter,i=t.is?t.$.sheet:function(t){var e=new CKEDITOR.dom.element("style"),r=new CKEDITOR.dom.element("iframe");return r.hide(),CKEDITOR.document.getBody().append(r),r.$.contentDocument.documentElement.appendChild(e.$),e.$.textContent=t,r.remove(),e.$.sheet}(t);var s,n,a,l,o,u=[];if(i)for(s=i.cssRules,n=0;n<s.length;n++)s[n].type===window.CSSRule.STYLE_RULE&&u.push({selector:s[n].selectorText,styles:r((a=s[n].cssText,l=void 0,o=void 0,l=a.indexOf("{"),o=a.indexOf("}"),e(a.substring(l+1,o),!0)))});return u},filter:function(t){var e,r=CKEDITOR.plugins.pastefromword.styles.inliner.filtered,i=s.array.indexOf,n={};for(e in t)-1===i(r,e)&&(n[e]=t[e]);return n},sort:function(t){function e(t){return-1!==(""+t).indexOf(".")}return t.sort((r=t,i=CKEDITOR.tools.array.map(r,(function(t){return t.selector})),function(t,r){var s=e(t.selector)?1:0,n=(e(r.selector)?1:0)-s;return 0!==n?n:i.indexOf(r.selector)-i.indexOf(t.selector)}));var r,i},inline:function(t){var e=CKEDITOR.plugins.pastefromword.styles.inliner.parse,r=CKEDITOR.plugins.pastefromword.styles.inliner.sort,i=function(t){var e=(new DOMParser).parseFromString(t,"text/html");return new CKEDITOR.dom.document(e)}(t),s=r(function(t){var r,i=[];for(r=0;r<t.count();r++)i=i.concat(e(t.getItem(r)));return i}(i.find("style")));return CKEDITOR.tools.array.forEach(s,(function(t){!function(t,e,r){var i,s,n,a,l=t.find(e);for(a=0;a<l.count();a++)i=l.getItem(a),s=CKEDITOR.tools.parseCssText(i.getAttribute("style")),n=CKEDITOR.tools.extend({},s,r),i.setAttribute("style",CKEDITOR.tools.writeCssText(n))}(i,t.selector,t.styles)})),i}}},e=CKEDITOR.plugins.pastefromword.styles,CKEDITOR.plugins.pastefromword.lists={thisIsAListItem:function(t,e){return!!r.isEdgeListItem(t,e)||!!(e.attributes.style&&e.attributes.style.match(/mso\-list:\s?l\d/)&&"li"!==e.parent.name||e.attributes["cke-dissolved"]||e.getHtml().match(/<!\-\-\[if !supportLists]\-\->/))},convertToFakeListItem:function(e,i){if(r.isDegenerateListItem(e,i)&&r.assignListLevels(e,i),this.getListItemInfo(i),!i.attributes["cke-dissolved"]){var n;if(i.forEach((function(t){!n&&"img"==t.name&&t.attributes["cke-ignored"]&&"*"==t.attributes.alt&&(n="·",t.remove())}),CKEDITOR.NODE_ELEMENT),i.forEach((function(t){n||t.value.match(/^ /)||(n=t.value)}),CKEDITOR.NODE_TEXT),void 0===n)return;i.attributes["cke-symbol"]=n.replace(/(?: |&nbsp;).*$/,""),t.removeSymbolText(i)}if(i.attributes.style){var a=s.parseCssText(i.attributes.style);a["margin-left"]&&(delete a["margin-left"],i.attributes.style=CKEDITOR.tools.writeCssText(a))}i.name="cke:li"},convertToRealListItems:function(t){var e=[];return t.forEach((function(t){"cke:li"==t.name&&(t.name="li",e.push(t))}),CKEDITOR.NODE_ELEMENT,!1),e},removeSymbolText:function(t){var e,r=t.attributes["cke-symbol"];t.forEach((function(i){!e&&i.value.match(r.replace(")","\\)").replace("(",""))&&(i.value=i.value.replace(r,""),i.parent.getHtml().match(/^(\s|&nbsp;)*$/)&&(e=i.parent!==t?i.parent:null))}),CKEDITOR.NODE_TEXT),e&&e.remove()},setListSymbol:function(e,r,i){i=i||1;var n=s.parseCssText(e.attributes.style);if("ol"==e.name){if(e.attributes.type||n["list-style-type"])return;var a={"[ivx]":"lower-roman","[IVX]":"upper-roman","[a-z]":"lower-alpha","[A-Z]":"upper-alpha","\\d":"decimal"};for(var l in a)if(t.getSubsectionSymbol(r).match(new RegExp(l))){n["list-style-type"]=a[l];break}e.attributes["cke-list-style-type"]=n["list-style-type"]}else{var o={"·":"disc",o:"circle","§":"square"};!n["list-style-type"]&&o[r]&&(n["list-style-type"]=o[r])}t.setListSymbol.removeRedundancies(n,i),(e.attributes.style=CKEDITOR.tools.writeCssText(n))||delete e.attributes.style},setListStart:function(e){for(var r=[],i=0,s=0;s<e.children.length;s++)r.push(e.children[s].attributes["cke-symbol"]||"");switch(r[0]||i++,e.attributes["cke-list-style-type"]){case"lower-roman":case"upper-roman":e.attributes.start=t.toArabic(t.getSubsectionSymbol(r[i]))-i;break;case"lower-alpha":case"upper-alpha":e.attributes.start=t.getSubsectionSymbol(r[i]).replace(/\W/g,"").toLowerCase().charCodeAt(0)-96-i;break;case"decimal":e.attributes.start=parseInt(t.getSubsectionSymbol(r[i]),10)-i||1}"1"==e.attributes.start&&delete e.attributes.start,delete e.attributes["cke-list-style-type"]},numbering:{toNumber:function(t,e){return"decimal"==e?Number(t):"upper-roman"==e||"lower-roman"==e?function(t){var e=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]];t=t.toUpperCase();for(var r=e.length,i=0,s=0;s<r;++s)for(var n=e[s],a=n[1].length;t.substr(0,a)==n[1];t=t.substr(a))i+=n[0];return i}(t.toUpperCase()):"lower-alpha"==e||"upper-alpha"==e?function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ";t=t.toUpperCase();for(var r=e.length,i=1,s=1;t.length>0;s*=r)i+=e.indexOf(t.charAt(t.length-1))*s,t=t.substr(0,t.length-1);return i}(t):1},getStyle:function(t){var e=t.slice(0,1),r={i:"lower-roman",v:"lower-roman",x:"lower-roman",l:"lower-roman",m:"lower-roman",I:"upper-roman",V:"upper-roman",X:"upper-roman",L:"upper-roman",M:"upper-roman"}[e];return r||(r="decimal",e.match(/[a-z]/)&&(r="lower-alpha"),e.match(/[A-Z]/)&&(r="upper-alpha")),r}},getSubsectionSymbol:function(t){return(t.match(/([\da-zA-Z]+).?$/)||["placeholder","1"])[1]},setListDir:function(t){var e={ltr:0,rtl:0};t.forEach((function(t){"li"==t.name&&("rtl"==(t.attributes.dir||t.attributes.DIR||"").toLowerCase()?e.rtl++:e.ltr++)}),CKEDITOR.ELEMENT_NODE),e.rtl>e.ltr&&(t.attributes.dir="rtl")},createList:function(t){return(t.attributes["cke-symbol"].match(/([\da-np-zA-NP-Z]).?/)||[])[1]?new CKEDITOR.htmlParser.element("ol"):new CKEDITOR.htmlParser.element("ul")},createLists:function(e){var r,i,s,n,a=t.convertToRealListItems(e);if(0===a.length)return[];var l=t.groupLists(a);for(s=0;s<l.length;s++){var o=l[s],u=o[0];for(n=0;n<o.length;n++)if(1==o[n].attributes["cke-list-level"]){u=o[n];break}var c,m=[t.createList(u)],f=m[0],d=[m[0]];for(f.insertBefore(o[0]),n=0;n<o.length;n++){for(i=(r=o[n]).attributes["cke-list-level"];i>m.length;){var p=t.createList(r),h=f.children;if(h.length>0)h[h.length-1].add(p);else{var b=new CKEDITOR.htmlParser.element("li",{style:"list-style-type:none"});b.add(p),f.add(b)}m.push(p),d.push(p),f=p,i==m.length&&t.setListSymbol(p,r.attributes["cke-symbol"],i)}for(;i<m.length;)m.pop(),f=m[m.length-1],i==m.length&&t.setListSymbol(f,r.attributes["cke-symbol"],i);r.remove(),f.add(r)}for(m[0].children.length&&(!(c=m[0].children[0].attributes["cke-symbol"])&&m[0].children.length>1&&(c=m[0].children[1].attributes["cke-symbol"]),c&&t.setListSymbol(m[0],c)),n=0;n<d.length;n++)t.setListStart(d[n]);for(n=0;n<o.length;n++)this.determineListItemValue(o[n])}return a},cleanup:function(t){var e,r,i=["cke-list-level","cke-symbol","cke-list-id","cke-indentation","cke-dissolved"];for(e=0;e<t.length;e++)for(r=0;r<i.length;r++)delete t[e].attributes[i[r]]},determineListItemValue:function(t){if("ol"===t.parent.name){var e,r,i=this.calculateValue(t),s=t.attributes["cke-symbol"].match(/[a-z0-9]+/gi);s&&(s=s[s.length-1],r=t.parent.attributes["cke-list-style-type"]||this.numbering.getStyle(s),(e=this.numbering.toNumber(s,r))!==i&&(t.attributes.value=e))}},calculateValue:function(t){if(!t.parent)return 1;var e,r,i,s=t.parent,n=t.getIndex(),a=null;for(i=n;i>=0&&null===a;i--)(r=s.children[i]).attributes&&void 0!==r.attributes.value&&(e=i,a=parseInt(r.attributes.value,10));return null===a&&(a=void 0!==s.attributes.start?parseInt(s.attributes.start,10):1,e=0),a+(n-e)},dissolveList:function(t){var r,i,n=function(t){return function(e){return e.name==t}},a=function(t){return n("ul")(t)||n("ol")(t)},l=CKEDITOR.tools.array,o=[];t.forEach((function(t){o.push(t)}),CKEDITOR.NODE_ELEMENT,!1);var u=l.filter(o,n("li")),c=l.filter(o,a);for(l.forEach(c,(function(t){var e=t.attributes.type,r=parseInt(t.attributes.start,10)||1,i=function(t,e){return r(e,0);function r(e,i){return e&&e.parent?t(e.parent)?r(e.parent,i+1):r(e.parent,i):i}}(a,t)+1;if(!e){var o=s.parseCssText(t.attributes.style);e=o["list-style-type"]}l.forEach(l.filter(t.children,n("li")),(function(s,n){var a;switch(e){case"disc":a="·";break;case"circle":a="o";break;case"square":a="§";break;case"1":case"decimal":a=r+n+".";break;case"a":case"lower-alpha":a=String.fromCharCode("a".charCodeAt(0)+r-1+n)+".";break;case"A":case"upper-alpha":a=String.fromCharCode("A".charCodeAt(0)+r-1+n)+".";break;case"i":case"lower-roman":a=m(r+n)+".";break;case"I":case"upper-roman":a=m(r+n).toUpperCase()+".";break;default:a="ul"==t.name?"·":r+n+"."}s.attributes["cke-symbol"]=a,s.attributes["cke-list-level"]=i}))})),i=(r=l.reduce(u,(function(t,r){var i=r.children[0];if(i&&i.name&&i.attributes.style&&i.attributes.style.match(/mso-list:/i)){e.pushStylesLower(r,{"list-style-type":!0,display:!0});var n=s.parseCssText(i.attributes.style,!0);e.setStyle(r,"mso-list",n["mso-list"],!0),e.setStyle(i,"mso-list",""),delete r["cke-list-level"];var l=n.display?"display":n.DISPLAY?"DISPLAY":"";l&&e.setStyle(r,"display",n[l],!0)}return 1===r.children.length&&a(r.children[0])||(r.name="p",r.attributes["cke-dissolved"]=!0,t.push(r)),t}),[])).length-1;i>=0;i--)r[i].insertAfter(t);for(i=c.length-1;i>=0;i--)delete c[i].name;function m(t){return t>=50?"l"+m(t-50):t>=40?"xl"+m(t-40):t>=10?"x"+m(t-10):9==t?"ix":t>=5?"v"+m(t-5):4==t?"iv":t>=1?"i"+m(t-1):""}},groupLists:function(e){var r,i,s=[[e[0]]],n=s[0];for((i=e[0]).attributes["cke-indentation"]=i.attributes["cke-indentation"]||t.getElementIndentation(i),r=1;r<e.length;r++){i=e[r];var a=e[r-1];i.attributes["cke-indentation"]=i.attributes["cke-indentation"]||t.getElementIndentation(i),i.previous!==a&&(t.chopDiscontinuousLists(n,s),s.push(n=[])),n.push(i)}return t.chopDiscontinuousLists(n,s),s},chopDiscontinuousLists:function(e,r){for(var i,n={},a=[[]],l=0;l<e.length;l++){var o,u,c=n[e[l].attributes["cke-list-level"]],m=this.getListItemInfo(e[l]);c?(u=c.type.match(/alpha/)&&7==c.index?"alpha":u,u="o"==e[l].attributes["cke-symbol"]&&14==c.index?"alpha":u,o=t.getSymbolInfo(e[l].attributes["cke-symbol"],u),m=this.getListItemInfo(e[l]),(c.type!=o.type||i&&m.id!=i.id&&!this.isAListContinuation(e[l]))&&a.push([])):o=t.getSymbolInfo(e[l].attributes["cke-symbol"]);for(var f=parseInt(e[l].attributes["cke-list-level"],10)+1;f<20;f++)n[f]&&delete n[f];n[e[l].attributes["cke-list-level"]]=o,a[a.length-1].push(e[l]),i=m}[].splice.apply(r,[].concat([s.indexOf(r,e),1],a))},isAListContinuation:function(t){var e=t;do{if((e=e.previous)&&e.type===CKEDITOR.NODE_ELEMENT){if(void 0===e.attributes["cke-list-level"])return!1;if(e.attributes["cke-list-level"]===t.attributes["cke-list-level"])return e.attributes["cke-list-id"]===t.attributes["cke-list-id"]}}while(e);return!1},getElementIndentation:function(t){var e=s.parseCssText(t.attributes.style);if(e.margin||e.MARGIN){e.margin=e.margin||e.MARGIN;var r={styles:{margin:e.margin}};CKEDITOR.filter.transformationsTools.splitMarginShorthand(r),e["margin-left"]=r.styles["margin-left"]}return parseInt(s.convertToPx(e["margin-left"]||"0px"),10)},toArabic:function(e){return e.match(/[ivxl]/i)?e.match(/^l/i)?50+t.toArabic(e.slice(1)):e.match(/^lx/i)?40+t.toArabic(e.slice(1)):e.match(/^x/i)?10+t.toArabic(e.slice(1)):e.match(/^ix/i)?9+t.toArabic(e.slice(2)):e.match(/^v/i)?5+t.toArabic(e.slice(1)):e.match(/^iv/i)?4+t.toArabic(e.slice(2)):e.match(/^i/i)?1+t.toArabic(e.slice(1)):t.toArabic(e.slice(1)):0},getSymbolInfo:function(e,r){var i=e.toUpperCase()==e?"upper-":"lower-",s={"·":["disc",-1],o:["circle",-2],"§":["square",-3]};return e in s||r&&r.match(/(disc|circle|square)/)?{index:s[e][1],type:s[e][0]}:e.match(/\d/)?{index:e?parseInt(t.getSubsectionSymbol(e),10):0,type:"decimal"}:(e=e.replace(/\W/g,"").toLowerCase(),!r&&e.match(/[ivxl]+/i)||r&&"alpha"!=r||"roman"==r?{index:t.toArabic(e),type:i+"roman"}:e.match(/[a-z]/i)?{index:e.charCodeAt(0)-97,type:i+"alpha"}:{index:-1,type:"disc"})},getListItemInfo:function(t){if(void 0!==t.attributes["cke-list-id"])return{id:t.attributes["cke-list-id"],level:t.attributes["cke-list-level"]};var e=s.parseCssText(t.attributes.style)["mso-list"],r={id:"0",level:"1"};return e&&(e+=" ",r.level=e.match(/level(.+?)\s+/)[1],r.id=e.match(/l(\d+?)\s+/)[1]),t.attributes["cke-list-level"]=void 0!==t.attributes["cke-list-level"]?t.attributes["cke-list-level"]:r.level,t.attributes["cke-list-id"]=r.id,r}},t=CKEDITOR.plugins.pastefromword.lists,CKEDITOR.plugins.pastefromword.heuristics={isEdgeListItem:function(t,e){if(!CKEDITOR.env.edge||!t.config.pasteFromWord_heuristicsEdgeList)return!1;var i="";return e.forEach&&e.forEach((function(t){i+=t.value}),CKEDITOR.NODE_TEXT),!!i.match(/^(?: |&nbsp;)*\(?[a-zA-Z0-9]+?[\.\)](?: |&nbsp;){2,}/)||r.isDegenerateListItem(t,e)},cleanupEdgeListItem:function(t){var e=!1;t.forEach((function(t){e||(t.value=t.value.replace(/^(?:&nbsp;|[\s])+/,""),t.value.length&&(e=!0))}),CKEDITOR.NODE_TEXT)},isDegenerateListItem:function(t,e){return!!e.attributes["cke-list-level"]||e.attributes.style&&!e.attributes.style.match(/mso\-list/)&&!!e.find((function(t){if(t.type==CKEDITOR.NODE_ELEMENT&&e.name.match(/h\d/i)&&t.getHtml().match(/^[a-zA-Z0-9]+?[\.\)]$/))return!0;var r=s.parseCssText(t.attributes&&t.attributes.style,!0);if(!r)return!1;var i=r.font||r["font-size"]||"",n=r["font-family"]||"";return i.match(/7pt/i)&&!!t.previous||n.match(/symbol/i)}),!0).length},assignListLevels:function(e,i){if(!i.attributes||void 0===i.attributes["cke-list-level"]){for(var s=[t.getElementIndentation(i)],n=[i],a=[],l=CKEDITOR.tools.array,o=l.map;i.next&&i.next.attributes&&!i.next.attributes["cke-list-level"]&&r.isDegenerateListItem(e,i.next);)i=i.next,s.push(t.getElementIndentation(i)),n.push(i);var u=o(s,(function(t,e){return 0===e?0:t-s[e-1]})),c=this.guessIndentationStep(l.filter(s,(function(t){return 0!==t})));return a=o(s,(function(t){return Math.round(t/c)})),-1!==l.indexOf(a,0)&&(a=o(a,(function(t){return t+1}))),l.forEach(n,(function(t,e){t.attributes["cke-list-level"]=a[e]})),{indents:s,levels:a,diffs:u}}},guessIndentationStep:function(t){return t.length?Math.min.apply(null,t):null},correctLevelShift:function(t){if(this.isShifted(t)){var e=CKEDITOR.tools.array.filter(t.children,(function(t){return"ul"==t.name||"ol"==t.name})),i=CKEDITOR.tools.array.reduce(e,(function(t,e){return(function(t){return t.children&&1==t.children.length&&r.isShifted(t.children[0])}(e)?[e]:e.children).concat(t)}),[]);CKEDITOR.tools.array.forEach(e,(function(t){t.remove()})),CKEDITOR.tools.array.forEach(i,(function(e){t.add(e,0)})),delete t.name}},isShifted:function(t){return"li"===t.name&&0===CKEDITOR.tools.array.filter(t.children,(function(t){if(t.name){if("ul"==t.name||"ol"==t.name)return!1;if("p"==t.name&&0===t.children.length)return!1}return!0})).length}},r=CKEDITOR.plugins.pastefromword.heuristics,t.setListSymbol.removeRedundancies=function(t,e){(1===e&&"disc"===t["list-style-type"]||"decimal"===t["list-style-type"])&&delete t["list-style-type"]},CKEDITOR.plugins.pastefromword.createAttributeStack=u,CKEDITOR.config.pasteFromWord_heuristicsEdgeList=!0}();