/**
 * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or http://ckeditor.com/license
 */
CKEDITOR.dialog.add("colordialog",(function(e){var t,o,l,a,r=CKEDITOR.dom.element,n=CKEDITOR.document,i=e.lang.colordialog,s="cke_colordialog_focused_light",c="cke_colordialog_focused_dark",d="cke_colordialog_selected",g={type:"html",html:"&nbsp;"};function u(){n.getById(x).removeStyle("background-color"),t.getContentElement("picker","selectedColor").setValue(""),m()}function p(e){var l,a=e.data.getTarget();"td"==a.getName()&&(l=a.getChild(0).getHtml())&&(m(),(o=a).setAttribute("aria-selected",!0),o.addClass(d),t.getContentElement("picker","selectedColor").setValue(l))}function m(){o&&(o.removeClass(d),o.removeAttribute("aria-selected"),o=null)}function f(e){!e.name&&(e=new CKEDITOR.event(e));var t,o=!/mouse/.test(e.name),r=e.data.getTarget();"td"==r.getName()&&(t=r.getChild(0).getHtml())&&(v(e),o?l=r:a=r,o&&r.addClass(function(e){e=e.replace(/^#/,"");for(var t=0,o=[];t<=2;t++)o[t]=parseInt(e.substr(2*t,2),16);return.2126*o[0]+.7152*o[1]+.0722*o[2]>=165}(t)?s:c),b(t))}function v(e){var t=!/mouse/.test(e.name)&&l;t&&(t.removeClass(s),t.removeClass(c)),l||a||b(!1)}function b(e){e?(n.getById(I).setStyle("background-color",e),n.getById(k).setHtml(e)):(n.getById(I).removeStyle("background-color"),n.getById(k).setHtml("&nbsp;"))}function h(t){var o,l,a=t.data,r=a.getTarget(),n=a.getKeystroke(),i="rtl"==e.lang.dir;switch(n){case 38:(o=r.getParent().getPrevious())&&(l=o.getChild([r.getIndex()])).focus(),a.preventDefault();break;case 40:(o=r.getParent().getNext())&&(l=o.getChild([r.getIndex()]))&&1==l.type&&l.focus(),a.preventDefault();break;case 32:case 13:p(t),a.preventDefault();break;case i?37:39:(l=r.getNext())?1==l.type&&(l.focus(),a.preventDefault(!0)):(o=r.getParent().getNext())&&(l=o.getChild([0]))&&1==l.type&&(l.focus(),a.preventDefault(!0));break;case i?39:37:(l=r.getPrevious())?(l.focus(),a.preventDefault(!0)):(o=r.getParent().getPrevious())&&((l=o.getLast()).focus(),a.preventDefault(!0));break;default:return}}var y,C=function(e){return CKEDITOR.tools.getNextId()+"_"+e},I=C("hicolor"),k=C("hicolortext"),x=C("selhicolor");return function(){(y=CKEDITOR.dom.element.createFromHtml('<table tabIndex="-1" class="cke_colordialog_table" aria-label="'+i.options+'" role="grid" style="border-collapse:separate;" cellspacing="0"><caption class="cke_voice_label">'+i.options+'</caption><tbody role="presentation"></tbody></table>')).on("mouseover",f),y.on("mouseout",v);var e=["00","33","66","99","cc","ff"];function t(t,l){for(var a=t;a<t+3;a++){var n=new r(y.$.insertRow(-1));n.setAttribute("role","row");for(var i=l;i<l+3;i++)for(var s=0;s<6;s++)o(n.$,"#"+e[i]+e[s]+e[a])}}function o(e,t){var o=new r(e.insertCell(-1));o.setAttribute("class","ColorCell cke_colordialog_colorcell"),o.setAttribute("tabIndex",-1),o.setAttribute("role","gridcell"),o.on("keydown",h),o.on("click",p),o.on("focus",f),o.on("blur",v),o.setStyle("background-color",t);var l=C("color_table_cell");o.setAttribute("aria-labelledby",l),o.append(CKEDITOR.dom.element.createFromHtml('<span id="'+l+'" class="cke_voice_label">'+t+"</span>",CKEDITOR.document))}t(0,0),t(3,0),t(0,3),t(3,3);var l=new r(y.$.insertRow(-1));l.setAttribute("role","row"),o(l.$,"#000000");for(var a=0;a<16;a++){var n=a.toString(16);o(l.$,"#"+n+n+n+n+n+n)}o(l.$,"#ffffff")}(),CKEDITOR.document.appendStyleSheet(CKEDITOR.getUrl(CKEDITOR.plugins.get("colordialog").path+"dialogs/colordialog.css")),{title:i.title,minWidth:360,minHeight:220,onLoad:function(){t=this},onHide:function(){u(),l.removeClass(s),l.removeClass(c),b(!1),l=null},contents:[{id:"picker",label:i.title,accessKey:"I",elements:[{type:"hbox",padding:0,widths:["70%","10%","30%"],children:[{type:"html",html:"<div></div>",onLoad:function(){CKEDITOR.document.getById(this.domId).append(y)},focus:function(){(l||this.getElement().getElementsByTag("td").getItem(0)).focus()}},g,{type:"vbox",padding:0,widths:["70%","5%","25%"],children:[{type:"html",html:"<span>"+i.highlight+'</span><div id="'+I+'" style="border: 1px solid; height: 74px; width: 74px;"></div><div id="'+k+'">&nbsp;</div><span>'+i.selected+'</span><div id="'+x+'" style="border: 1px solid; height: 20px; width: 74px;"></div>'},{type:"text",label:i.selected,labelStyle:"display:none",id:"selectedColor",style:"width: 76px;margin-top:4px",onChange:function(){try{n.getById(x).setStyle("background-color",this.getValue())}catch(e){u()}}},g,{type:"button",id:"clear",label:i.clear,onClick:u}]}]}]}]}}));