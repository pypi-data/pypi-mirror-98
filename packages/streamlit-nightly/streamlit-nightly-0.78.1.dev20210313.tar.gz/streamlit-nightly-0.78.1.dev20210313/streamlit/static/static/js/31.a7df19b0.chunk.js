/*! For license information please see 31.a7df19b0.chunk.js.LICENSE.txt */
(this["webpackJsonpstreamlit-browser"]=this["webpackJsonpstreamlit-browser"]||[]).push([[31],{1175:function(e,t,s){"use strict";s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return n}));var i=s(7),a=s.n(i);const n=a()("label",{target:"effi0qh0"})((({theme:e})=>({fontSize:e.fontSizes.smDefault,color:e.colors.bodyText,marginBottom:e.fontSizes.halfSmDefault})),""),l=a()("div",{target:"effi0qh1"})((({theme:e})=>({fontSize:e.fontSizes.smDefault,color:e.colors.gray,margin:e.spacing.none,textAlign:"right",position:"absolute",bottom:0,right:e.fontSizes.halfSmDefault})),"")},3992:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return re}));var i=s(142),a=s.n(i),n=s(1175),l=s(46);let r;!function(e){e.Gigabyte="gb",e.Megabyte="mb",e.Kilobyte="kb",e.Byte="b"}(r||(r={}));const o=Object(l.g)()?1024:1e3,c=[r.Gigabyte,r.Megabyte,r.Kilobyte,r.Byte],d=(e,t,s=1)=>{if(t||(t=r.Byte),s<0&&(s=0),e<0)throw new Error("Size must be greater than or equal to 0");const i=c.indexOf(t);return i&&e>o/2?d(e/o,c[i-1],s):"".concat(e.toFixed(s)).concat(t.toUpperCase())};var g=s(10),p=s(0),h=s.n(p),m=s(6),u=s(2659),f=s.n(u),x=s(18),j=s(7),b=s.n(j);const y=b()("section",{target:"exg6vvm0"})((({isDisabled:e,theme:t})=>({display:"flex",alignItems:"center",padding:t.spacing.lg,backgroundColor:t.inSidebar?t.colors.white:t.colors.lightestGray,borderRadius:t.radii.md,":focus":{outline:"none",boxShadow:"0 0 0 1px ".concat(t.colors.primary)},color:e?t.colors.gray:t.colors.bodyText})),""),v=b()("div",{target:"exg6vvm1"})((({theme:e})=>({marginRight:"auto",alignItems:"center",display:"flex"})),""),O=b()("span",{target:"exg6vvm2"})((({theme:e})=>({color:e.colors.secondary,marginRight:e.spacing.lg})),""),S=b()("span",{target:"exg6vvm3"})((({theme:e})=>({marginBottom:e.spacing.twoXS})),""),w=b()("div",{target:"exg6vvm4"})({name:"j7qwjs",styles:"display:flex;flex-direction:column;"}),z=b()("div",{target:"exg6vvm5"})((({theme:e})=>({left:0,right:0,lineHeight:e.lineHeights.tight,paddingTop:e.spacing.md,paddingLeft:e.spacing.lg,paddingRight:e.spacing.lg})),""),F=b()("ul",{target:"exg6vvm6"})((({theme:e})=>({listStyleType:"none",marginBottom:0})),""),D=b()("li",{target:"exg6vvm7"})((({theme:e})=>({margin:e.spacing.none,padding:e.spacing.none})),""),I=b()("div",{target:"exg6vvm8"})((({theme:e})=>({display:"flex",alignItems:"baseline",flex:1,paddingLeft:e.spacing.lg,overflow:"hidden"})),""),M=b()("div",{target:"exg6vvm9"})((({theme:e})=>({marginRight:e.spacing.sm,marginBottom:e.spacing.twoXS,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})),""),B=b()("div",{target:"exg6vvm10"})((({theme:e})=>({display:"flex",alignItems:"center",marginBottom:e.spacing.twoXS})),""),k=b()("span",{target:"exg6vvm11"})((({theme:e})=>({marginRight:e.spacing.twoXS})),""),C=b()("div",{target:"exg6vvm12"})((({theme:e})=>({display:"flex",padding:e.spacing.twoXS,color:e.colors.secondary})),""),E=b()("small",{target:"exg6vvm13"})((({theme:e})=>({color:e.colors.danger,fontSize:e.fontSizes.smDefault,height:e.fontSizes.smDefault,lineHeight:e.fontSizes.smDefault,display:"flex",alignItems:"center",whiteSpace:"nowrap"})),""),R=b()("span",{target:"exg6vvm14"})({name:"0",styles:""}),A=e=>({[y]:{display:"flex",flexDirection:"column",alignItems:"flex-start"},[v]:{marginBottom:e.spacing.lg},[O]:{display:"none"},[z]:{paddingRight:e.spacing.lg},[B]:{maxWidth:"inherit",flex:1,alignItems:"flex-start",marginBottom:e.spacing.sm},[M]:{width:e.sizes.full},[I]:{flexDirection:"column"},[E]:{height:"auto",whiteSpace:"initial"},[R]:{display:"none"},[D]:{margin:e.spacing.none,padding:e.spacing.none}}),N=b()("div",{target:"exg6vvm15"})((({theme:e})=>e.inSidebar?A(e):{["@media (max-width: ".concat(e.breakpoints.sm,")")]:A(e)}),"");var U=s(1516),L=s(66);let P;!function(e){e.SECONDARY="secondary",e.DANGER="danger"}(P||(P={}));const T=b()("small",{target:"euu6i2w0"})((({kind:e,theme:t})=>{const s=e===P.SECONDARY&&t.colors.secondary;return{color:e===P.DANGER&&t.colors.danger||s||t.colors.darkGray,fontSize:t.fontSizes.smDefault,height:t.fontSizes.smDefault,lineHeight:t.fontSizes.smDefault,display:"flex",alignItems:"center"}}),"");var X=s(1);var q=({multiple:e,acceptedExtensions:t,maxSizeBytes:s})=>Object(X.jsxs)(v,{children:[Object(X.jsx)(O,{children:Object(X.jsx)(L.a,{content:U.CloudUpload,size:"threeXL"})}),Object(X.jsxs)(w,{children:[Object(X.jsxs)(S,{children:["Drag and drop file",e?"s":""," here"]}),Object(X.jsxs)(T,{children:["Limit ".concat(d(s,r.Byte,0)," per file"),t.length?" \u2022 ".concat(t.join(", ").replace(/\./g,"").toUpperCase()):null]})]})]});var G=({onDrop:e,multiple:t,acceptedExtensions:s,maxSizeBytes:i,disabled:a})=>Object(X.jsx)(f.a,{onDrop:e,multiple:t,accept:s.length?s:void 0,maxSize:i,disabled:a,children:({getRootProps:e,getInputProps:n})=>Object(X.jsxs)(y,Object(m.a)(Object(m.a)({},e()),{},{"data-testid":"stFileUploadDropzone",isDisabled:a,children:[Object(X.jsx)("input",Object(m.a)({},n())),Object(X.jsx)(q,{multiple:t,acceptedExtensions:s,maxSizeBytes:i}),Object(X.jsx)(x.c,{kind:x.a.PRIMARY,disabled:a,size:x.b.SMALL,children:"Browse files"})]}))}),H=s(47),Y=s(131),J=s(77),K=s.n(J);const V=b()("div",{target:"e1f8s2qs0"})((({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"space-between",paddingBottom:e.spacing.twoXS,marginBottom:e.spacing.twoXS})),""),W=b()("div",{target:"e1f8s2qs1"})((({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",color:e.colors.secondary})),"");var Q=({className:e,currentPage:t,totalPages:s,onNext:i,onPrevious:a})=>Object(X.jsxs)(V,{className:e,children:[Object(X.jsx)(T,{children:"Showing page ".concat(t," of ").concat(s)}),Object(X.jsxs)(W,{children:[Object(X.jsx)(x.c,{onClick:a,kind:x.a.MINIMAL,children:Object(X.jsx)(L.a,{content:U.ChevronLeft,size:"xl"})}),Object(X.jsx)(x.c,{onClick:i,kind:x.a.MINIMAL,children:Object(X.jsx)(L.a,{content:U.ChevronRight,size:"xl"})})]})]});const Z=(e,t)=>Math.ceil(e.length/t);var $=e=>K()((t=>{let s=t.pageSize,i=t.items,a=t.resetOnAdd,n=Object(Y.a)(t,["pageSize","items","resetOnAdd"]);const l=Object(p.useState)(0),r=Object(H.a)(l,2),o=r[0],c=r[1],d=Object(p.useState)(Z(i,s)),g=Object(H.a)(d,2),h=g[0],u=g[1],f=(e=>{const t=Object(p.useRef)();return Object(p.useEffect)((()=>{t.current=e}),[e]),t.current})(i);Object(p.useEffect)((()=>{f&&f.length!==i.length&&u(Z(i,s)),f&&f.length<i.length?a&&c(0):o+1>=h&&c(h-1)}),[i,o,s,f,a,h]);const x=i.slice(o*s,o*s+s);return Object(X.jsxs)(X.Fragment,{children:[Object(X.jsx)(e,Object(m.a)({items:x},n)),i.length>s?Object(X.jsx)(Q,{className:"streamlit-paginator",pageSize:s,totalPages:h,currentPage:o+1,onNext:()=>{c(Math.min(o+1,h-1))},onPrevious:()=>{c(Math.max(0,o-1))}}):null]})}),e),_=s(224);const ee=({fileInfo:e})=>"uploading"===e.status.type?Object(X.jsx)(_.b,{value:e.status.progress,size:_.a.SMALL,overrides:{Bar:{style:{marginLeft:0,marginTop:"4px"}}}}):"error"===e.status.type?Object(X.jsxs)(E,{children:[Object(X.jsx)(k,{"data-testid":"stUploadedFileErrorMessage",children:e.status.errorMessage}),Object(X.jsx)(R,{children:Object(X.jsx)(L.a,{content:U.Error,size:"lg"})})]}):"uploaded"===e.status.type?Object(X.jsx)(T,{kind:P.SECONDARY,children:d(e.file.size,r.Byte)}):"deleting"===e.status.type?Object(X.jsx)(T,{kind:P.SECONDARY,children:"Removing file"}):null;var te=({fileInfo:e,onDelete:t})=>Object(X.jsxs)(B,{className:"uploadedFile",children:[Object(X.jsx)(C,{children:Object(X.jsx)(L.a,{content:U.InsertDriveFile,size:"twoXL"})}),Object(X.jsxs)(I,{className:"uploadedFileData",children:[Object(X.jsx)(M,{className:"uploadedFileName",title:e.file.name,children:e.file.name}),Object(X.jsx)(ee,{fileInfo:e})]}),Object(X.jsx)("div",{"data-testid":"fileDeleteBtn",children:Object(X.jsx)(x.c,{onClick:()=>t(e.id),kind:x.a.MINIMAL,children:Object(X.jsx)(L.a,{content:U.Clear,size:"lg"})})})]});const se=$((({items:e,onDelete:t})=>Object(X.jsx)(F,{children:e.map((e=>Object(X.jsx)(D,{children:Object(X.jsx)(te,{fileInfo:e,onDelete:t})},e.id)))})));var ie=e=>Object(X.jsx)(z,{children:Object(X.jsx)(se,Object(m.a)({},e))});class ae{setStatus(e){return new ae(this.file,e,this.id)}constructor(e,t,s){this.file=void 0,this.status=void 0,this.id=void 0,this.file=e,this.status=t,this.id=null!=s?s:"".concat((new Date).getTime(),"-").concat(Math.random())}}function ne(e){return e.files.some((e=>"uploading"===e.status.type||"deleting"===e.status.type))?"updating":"ready"}class le extends h.a.PureComponent{constructor(e){super(e),this.componentDidUpdate=(e,t)=>{const s=this.props.element.id;if(e.disabled!==this.props.disabled&&this.props.disabled)return this.reset(),void this.props.widgetStateManager.setStringArrayValue(s,[],{fromUi:!1});const i=ne(t);"ready"===this.status&&"ready"!==i&&this.props.widgetStateManager.setStringArrayValue(s,this.uploadedFileIds,{fromUi:!0})},this.reset=()=>{this.setState({files:[]})},this.dropHandler=(e,t)=>{const s=this.props.element.multipleFiles;if(!s&&0===e.length&&t.length>1){const s=t.findIndex((e=>1===e.errors.length&&"too-many-files"===e.errors[0].code));s>=0&&(e.push(t[s].file),t.splice(s,1))}if(!s&&e.length>0&&this.state.files.length>0&&this.removeFile(this.state.files[0].id||""),e.forEach(this.uploadFile),t.length>0){const e=t.map((e=>new ae(e.file,{type:"error",errorMessage:this.getErrorMessage(e.errors[0].code,e.file)})));this.addFiles(e)}},this.uploadFile=e=>{const t=a.a.CancelToken.source(),s=new ae(e,{type:"uploading",cancelToken:t,progress:1});this.addFile(s),this.props.uploadClient.uploadFiles(this.props.element.id,[s],(e=>this.onUploadProgress(e,s.id)),t.token,!this.props.element.multipleFiles).then((()=>{this.updateFile(s.id,s.setStatus({type:"uploaded"}))})).catch((e=>{a.a.isCancel(e)||this.updateFile(s.id,s.setStatus({type:"error",errorMessage:e?e.toString():"Unknown error"}))}))},this.getErrorMessage=(e,t)=>{switch(e){case"file-too-large":return"File must be ".concat(d(this.maxUploadSizeInBytes,r.Byte)," or smaller.");case"file-invalid-type":return"".concat(t.type," files are not allowed.");case"file-too-small":return"File size is too small.";case"too-many-files":return"Only one file is allowed.";default:return"Unexpected error. Please try again."}},this.deleteFile=e=>{const t=this.state.files.find((t=>t.id===e));null!=t&&"deleting"!==t.status.type&&("error"!==t.status.type?("uploading"===t.status.type&&t.status.cancelToken.cancel(),this.updateFile(e,t.setStatus({type:"deleting"})),this.props.uploadClient.delete(this.props.element.id,e).then((()=>this.removeFile(e))).catch((s=>{Object(g.d)("uploadClient.delete error: ".concat(s)),this.updateFile(e,t.setStatus({type:"error",errorMessage:"".concat(s)}))}))):this.removeFile(e))},this.addFile=e=>{this.setState((t=>({files:[...t.files,e]})))},this.addFiles=e=>{this.setState((t=>({files:[...t.files,...e]})))},this.removeFile=e=>{this.setState((t=>({files:t.files.filter((t=>t.id!==e))})))},this.updateFile=(e,t)=>{this.setState((s=>({files:s.files.map((s=>s.id===e?t:s))})))},this.onUploadProgress=(e,t)=>{const s=this.state.files.find((e=>e.id===t));if(null==s||"uploading"!==s.status.type)return;const i=Math.round(100*e.loaded/e.total);s.status.progress!==i&&this.updateFile(t,s.setStatus({type:"uploading",cancelToken:s.status.cancelToken,progress:i}))},this.render=()=>{const e=this.state.files,t=this.props,s=t.element,i=t.disabled,a=s.type,l=e.slice().reverse();return Object(X.jsxs)(N,{"data-testid":"stFileUploader",children:[Object(X.jsx)(n.b,{children:s.label}),Object(X.jsx)(G,{onDrop:this.dropHandler,multiple:s.multipleFiles,acceptedExtensions:a,maxSizeBytes:this.maxUploadSizeInBytes,disabled:i}),Object(X.jsx)(ie,{items:l,pageSize:3,onDelete:this.deleteFile,resetOnAdd:!0})]})},this.state={files:[]}}get maxUploadSizeInBytes(){return((e,t,s)=>{if(e<0)throw Error("Size must be 0 or greater");const i=c.findIndex((e=>e===t)),a=c.findIndex((e=>e===s));if(-1===i||-1===a)throw Error("Unexpected byte unit provided");if(i===a)return e;const n=Math.abs(i-a),l=Math.pow(o,n);return i>a?e/l:e*l})(this.props.element.maxUploadSizeMb,r.Megabyte,r.Byte)}get status(){return ne(this.state)}get uploadedFileIds(){return this.state.files.filter((e=>"uploaded"===e.status.type)).map((e=>e.id))}}var re=le}}]);
//# sourceMappingURL=31.a7df19b0.chunk.js.map