(this.webpackJsonpqsl=this.webpackJsonpqsl||[]).push([[0],{195:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(0),r=n.n(c),i=n(50),o=n.n(i),l=n(6),s=n(4),u=n(69),b=n(115),j=n(23),d=n(22),h=n(5),O=n(43),f=n.n(O),x=n(58),g=n(19),m=n(197),p=n(262),v=n(117),y=n(105),C=n(66),S=n(76),k=n(252),w=n(210),B=n(56),I=n(253),N=n(205),E=n(260),L=n(153),P=function(e){return Object(a.jsx)(m.a,{value:e.optionName,control:e.control,label:"".concat(e.optionName," (").concat(e.optionConfig.shortcut,")")})},R=function(e){var t=c.useState(""),n=Object(s.a)(t,2),r=n[0],i=n[1],o=c.useState("single"),l=Object(s.a)(o,2),u=l[0],b=l[1];return Object(a.jsxs)(p.a,{container:!0,spacing:3,children:[Object(a.jsx)(p.a,{item:!0,xs:6,children:Object(a.jsx)(v.a,{value:r,placeholder:"New label name",onChange:function(e){return i(e.target.value)},style:{width:"100%"}})}),Object(a.jsx)(p.a,{item:!0,xs:3,children:Object(a.jsxs)(y.a,{labelId:"config-type-selector",id:"config-type-selector",label:"New label type",value:u,onChange:function(e){return b(e.target.value)},style:{width:"100%"},children:[Object(a.jsx)(C.a,{value:"single",children:"Single"}),Object(a.jsx)(C.a,{value:"multiple",children:"Multiple"}),Object(a.jsx)(C.a,{value:"text",children:"Text"})]})}),Object(a.jsx)(p.a,{item:!0,xs:3,children:Object(a.jsx)(S.a,{variant:"contained",color:"primary",onClick:function(){e.addConfig(r,u),i("")},style:{width:"100%"},disabled:!r||e.configGroup[u].hasOwnProperty(r),children:"Add Label"})})]})},z=function(e){var t=c.useState(""),n=Object(s.a)(t,2),r=n[0],i=n[1],o=c.useState(""),l=Object(s.a)(o,2),u=l[0],b=l[1];return Object(a.jsxs)(k.a,{style:{marginBottom:"10px"},children:[Object(a.jsx)(v.a,{value:r,onChange:function(e){return i(e.target.value)},placeholder:"New option name",style:{marginRight:"10px"}}),Object(a.jsx)(v.a,{value:u,onChange:function(e){return b(e.target.value)},placeholder:"Keyboard shortcut",style:{marginRight:"10px"}}),Object(a.jsx)(S.a,{disabled:0===r.length||1!==u.length||!e.isShortcutValid(r,u),variant:"contained",color:"primary",onClick:function(){e.addOption(r,u),i(""),b("")},children:"Add Option"})]})},H=function(e){return Object(a.jsxs)(w.a,{children:[Object(a.jsx)(B.a,{component:"fieldset",children:Object(a.jsxs)(I.a,{"aria-label":e.configName,name:e.configName,value:e.selected,children:[Object(a.jsx)(N.a,{component:"legend",children:e.configName}),Object.entries(e.config.options).map((function(t){var n=Object(s.a)(t,2),c=n[0],r=n[1];return Object(a.jsx)(P,{optionName:c,optionConfig:r,control:Object(a.jsx)(E.a,{disabled:!e.onChange,onClick:function(t){return e.onChange(t,t.target.value)}})},c)}))]})}),e.setConfig?Object(a.jsx)(z,{isShortcutValid:e.isShortcutValid,addOption:function(t,n){return e.setConfig(e.configName,Object(l.a)(Object(l.a)({},e.config),{},{options:Object(l.a)(Object(l.a)({},e.config.options),{},Object(h.a)({},t,{shortcut:n,id:null}))}))}}):null]})},A=function(e){return Object(a.jsxs)("div",{children:[Object(a.jsx)(w.a,{children:Object(a.jsxs)(B.a,{component:"fieldset",children:[Object(a.jsx)(N.a,{component:"legend",children:e.configName}),Object.entries(e.config.options).map((function(t){var n=Object(s.a)(t,2),c=n[0],r=n[1];return Object(a.jsx)(P,{optionName:c,optionConfig:r,control:Object(a.jsx)(L.a,{disabled:!e.onChange,checked:!!e.selected&&e.selected.indexOf(c)>=0,onChange:function(t){return e.onChange(t,c)},name:c})},c)}))]})}),e.setConfig?Object(a.jsx)(z,{isShortcutValid:e.isShortcutValid,addOption:function(t,n){return e.setConfig(e.configName,Object(l.a)(Object(l.a)({},e.config),{},{options:Object(l.a)(Object(l.a)({},e.config.options),{},Object(h.a)({},t,{shortcut:n,id:null}))}))}}):null]})},T=function(e){return Object(a.jsx)(B.a,{component:"fieldset",children:Object(a.jsxs)(w.a,{children:[Object(a.jsx)(N.a,{component:"legend",children:e.configName}),Object(a.jsx)(v.a,{value:e.value,onChange:function(t){return e.onChange(t,t.target.value)},onBlur:e.onBlur,onFocus:e.onFocus,disabled:!e.onChange})]})})},D=function(e,t,n,a,c){if(e.hasOwnProperty(c)){var r=e[c];return r.configName===t&&r.optionName===n&&r.type===a}return!0},M=function(e){var t=e.configGroup,n=e.labels,r=e.setLabelGroup,i=e.onEnter,o=e.onShiftEnter,u=e.onCtrlEnter,b=e.onEsc,j=e.onDel,d=e.setConfigGroup,O=c.useMemo((function(){return function(e){return Object.entries(e.single).map((function(e){var t=Object(s.a)(e,2);return[t[0],t[1],"single"]})).concat(Object.entries(e.multiple).map((function(e){var t=Object(s.a)(e,2);return[t[0],t[1],"multiple"]}))).map((function(e){var t=Object(s.a)(e,3),n=t[0],a=t[1],c=t[2];return Object.entries(a.options).map((function(e){var t=Object(s.a)(e,2),a=t[0];return{key:t[1].shortcut,configName:n,optionName:a,type:c}}))})).flat().reduce((function(e,t){return e[t.key]={type:t.type,configName:t.configName,optionName:t.optionName},e}),{})}(t)}),[t]),f=c.useState(!1),x=Object(s.a)(f,2),m=x[0],p=x[1],v=c.useCallback((function(e,n,a){var c=Object(l.a)(Object(l.a)({},t),{},Object(h.a)({},n,Object(l.a)(Object(l.a)({},t[n]),{},Object(h.a)({},e,a))));d(c)}),[t,d]),y=c.useCallback((function(e,n){var a=Object(l.a)(Object(l.a)({},t),{},Object(h.a)({},n,Object(l.a)(Object(l.a)({},t[n]),{},Object(h.a)({},e,{id:null}))));"multiple"!==n&&"single"!==n||(a[n][e].options={}),d(a)}),[t,d]),C=c.useCallback((function(e,t,a){if(r){var c,i;if("single"===t||"text"===t)i="single"===t&&n[t][e]===a?null:a,c=Object(l.a)(Object(l.a)({},n),{},Object(h.a)({},t,Object(l.a)(Object(l.a)({},n[t]),{},Object(h.a)({},e,i))));else if("multiple"===t){var o=Object(g.a)(n[t][e]),s=o.indexOf(a);s>=0?o.splice(s,1):o.push(a),c=Object(l.a)(Object(l.a)({},n),{},Object(h.a)({},t,Object(l.a)(Object(l.a)({},n[t]),{},Object(h.a)({},e,o))))}r(c)}}),[n,r]);return c.useEffect((function(){var e=function(e){if(i||r||b||j)if(!O.hasOwnProperty(e.key)||e.ctrlKey||e.shiftKey||m)!i||"Enter"!==e.key||e.shiftKey||e.ctrlKey?o&&"Enter"===e.key&&e.shiftKey&&!e.ctrlKey?o():u&&"Enter"===e.key&&!e.shiftKey&&e.ctrlKey?u():b&&"Escape"===e.key?b():j&&"Delete"===e.key&&j():i();else{var t=O[e.key],n=t.type,a=t.configName,c=t.optionName;C(a,n,c)}};return document.addEventListener("keydown",e,!1),function(){document.removeEventListener("keydown",e,!1)}}),[i,r,O,m,C]),Object(a.jsxs)("div",{children:[Object.entries(t.single).map((function(t){var n=Object(s.a)(t,2),c=n[0],i=n[1];return Object(a.jsx)(H,{config:i,onChange:r?function(e,t){return C(c,"single",t)}:null,setConfig:e.setConfigGroup?function(e,t){return v(e,"single",t)}:null,isShortcutValid:function(e,t){return D(O,c,e,"single",t)},configName:c,selected:e.labels?e.labels.single[c]:null},c)})),Object.entries(t.multiple).map((function(t){var n=Object(s.a)(t,2),c=n[0],i=n[1];return Object(a.jsx)(A,{config:i,onChange:r?function(e,t){return C(c,"multiple",t)}:null,setConfig:e.setConfigGroup?function(e,t){return v(e,"multiple",t)}:null,isShortcutValid:function(e,t){return D(O,c,e,"multiple",t)},configName:c,selected:e.labels?e.labels.multiple[c]:null},c)})),Object.entries(t.text).map((function(t){var n=Object(s.a)(t,2),c=n[0];n[1];return Object(a.jsx)(T,{onChange:r?function(e,t){return C(c,"text",t)}:null,onFocus:function(){return p(!0)},onBlur:function(){return p(!1)},configName:c,value:e.labels&&e.labels.text[c]||""},c)})),e.setConfigGroup?Object(a.jsx)(R,{addConfig:y,configGroup:t}):null]})},_=n(199).a({startIcon:{position:"absolute",left:"8px"},label:{paddingLeft:"40px"}})(S.a),U=n(77),G=n(264),F=n(265),K=n(209),q=n(266),V=n(261),W=n(267),J=n(268),Y=n(254),X=n(255),Z=n(256),Q=n(257),$=n(47),ee=n(45),te=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"",ne=function(e){return{text:Object.entries(e.text).reduce((function(e,t){var n=Object(s.a)(t,2),a=n[0];n[1];return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},a,null))}),{}),multiple:Object.entries(e.multiple).reduce((function(e,t){var n=Object(s.a)(t,2),a=n[0];n[1];return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},a,[]))}),{}),single:Object.entries(e.single).reduce((function(e,t){var n=Object(s.a)(t,2),a=n[0];n[1];return Object(l.a)(Object(l.a)({},e),{},Object(h.a)({},a,null))}),{})}},ae=function(e){return{image:ne(e.labelingConfiguration.image),boxes:[],default:!1,ignored:!1}},ce=function(e){return Object.keys(e.box.single).length>0||Object.keys(e.box.multiple).length>0||Object.keys(e.box.text).length>0},re={credentials:"include"},ie={method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"},oe=function(e){return fetch("".concat(te,"/api/v1/projects/").concat(e),re).then((function(e){return e.json()}))},le=function(e,t){return fetch("".concat(te,"/api/v1/projects/").concat(e,"/images/").concat(t,"/labels"),re).then((function(e){return e.json()}))},se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],c=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=t.map((function(e){return"exclude=".concat(e)})).join("&"),l="".concat(te,"/api/v1/projects/").concat(e,"/images?shuffle=").concat(a,"&limit=").concat(n,"&exclude_ignored=").concat(c,"&max_labels=").concat(r,"&").concat(o);return i&&(l+="&page=".concat(i)),fetch(l,re).then((function(e){return e.json()}))},ue=function(e,t,n){return fetch("".concat(te,"/api/v1/projects/").concat(e,"/images/").concat(t,"/labels"),Object(l.a)(Object(l.a)({},ie),{},{body:JSON.stringify(n)})).then((function(e){return e.json()}))},be=function(e,t){return fetch("".concat(te,"/api/v1/projects/").concat(e,"/images/").concat(t,"/labels"),Object(l.a)(Object(l.a)({},re),{},{method:"DELETE"})).then((function(e){return e.json()}))},je=function(e,t){return"".concat(te,"/api/v1/projects/").concat(e,"/images/").concat(t,"/file")},de=function(e){return"".concat(te,"/api/v1/projects/").concat(e,"/export")},he=function(e){return new Promise((function(t){return setTimeout(t,e)}))},Oe=function(){var e=Object(x.a)(f.a.mark((function e(t){var n,a,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=t.current)||void 0===n||n.focus(),e.next=3,he(200);case 3:null===(a=t.current)||void 0===a||a.blur(),null===(c=t.current)||void 0===c||c.click();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(e){return Object.fromEntries(e.map((function(e){return[e.id,{selected:!0,remoteStatus:"unknown"}]})))},xe=ee.a((function(e){return{checkbox:{left:"50%",top:"50%",transform:"translate(-50%, -50%)"},checked:{color:"rgba(0, 150, 0, 1)"},unchecked:{color:"rgba(150, 0, 0, 1)"}}})),ge=function(e){var t=xe(),n=function(n){return Object(a.jsx)(U.a,{className:"".concat(t.checkbox," ").concat(n.selected?t.checked:t.unchecked),onClick:function(){return e.toggleSelected(n.image.id)},"aria-label":"selected ".concat(n.image.id),children:n.selected?Object(a.jsx)(Y.a,{}):Object(a.jsx)(X.a,{})})};return Object(a.jsx)(G.a,{rowHeight:e.thumbnailSize,cols:Math.ceil(800/e.thumbnailSize),children:e.items.map((function(t){return Object(a.jsxs)(F.a,{cols:1,children:[Object(a.jsx)("img",{style:{maxWidth:"100%",maxHeight:"100%",height:"100%",width:"100%",objectFit:"contain",transform:"none",margin:"auto",position:"absolute",top:0,bottom:0,left:0,right:0},src:je(e.projectId,t.image.id),alt:"ID: ".concat(t.image.id),onClick:function(){return e.toggleSelected(t.image.id)}}),n(t)]},t.image.id)}))})},me=function(){var e=d.g().params,t=e.projectId,n=e.imageIds,r=c.useState({labels:null,dirty:!1,saved:[],batches:[],batchSize:10,thumbnailSize:160,redirecting:!1,advanceOnSave:!1,history:[],project:null,currentBatchStatus:{},currentBatch:[]}),i=Object(s.a)(r,2),o=i[0],u=i[1],b=c.useRef(),O=c.useRef(),g=c.useRef(),v=c.useRef(),y=c.useRef(),C=c.useRef(),w=c.useRef(),B=c.useCallback((function(){return o.history.filter((function(e){return e.images.map((function(e){return e.id})).join(",")!==n}))}),[o,n]),I=c.useCallback((function(e){var n,a,c=o.currentBatch.filter((function(e){return o.currentBatchStatus[e.id].selected}));switch(e){case"ignore":a="ignored",n=c.map((function(e){return ue(t,e.id,Object(l.a)(Object(l.a)({},o.labels),{},{ignored:!0}))}));break;case"delete":a="unknown",n=c.map((function(e){return be(t,e.id)}));break;case"save":a="labeled",n=c.map((function(e){return ue(t,e.id,o.labels)}))}Promise.all(n).then((function(){var e=Object(l.a)(Object(l.a)({},o),{},{currentBatchStatus:Object(l.a)(Object(l.a)({},o.currentBatchStatus),Object.fromEntries(c.map((function(e){return[e.id,{selected:!1,remoteStatus:a}]}))))});u(e),o.advanceOnSave&&Object.entries(e.currentBatchStatus).filter((function(e){var t=Object(s.a)(e,2);t[0];return"unknown"!==t[1].remoteStatus})).length===e.currentBatch.length&&Oe(O)}))}),[o,O]),N=c.useCallback((function(){console.log("Get length",o.batches.length);var e=[{images:o.currentBatch,status:o.currentBatchStatus}].concat(B());u(Object(l.a)(Object(l.a)({},o),{},{currentBatch:o.batches[0],currentBatchStatus:fe(o.batches[0]),batches:o.batches.slice(1),history:e,redirecting:!0}))}),[o,B]),E=c.useCallback((function(){u(Object(l.a)(Object(l.a)({},o),{},{history:o.history.slice(1),currentBatch:o.history[0].images,currentBatchStatus:o.history[0].status,batches:[o.currentBatch].concat(o.batches),redirecting:!0}))}),[o]),P=c.useCallback((function(){return u(Object(l.a)(Object(l.a)({},o),{},{currentBatchStatus:fe(o.currentBatch)}))}),[o]),R=c.useCallback((function(){return u(Object(l.a)(Object(l.a)({},o),{},{currentBatchStatus:Object.fromEntries(Object.entries(o.currentBatchStatus).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return[n,Object(l.a)(Object(l.a)({},a),{},{selected:"unknown"===a.remoteStatus})]})))}))}),[o]),z=c.useCallback((function(){return u(Object(l.a)(Object(l.a)({},o),{},{currentBatchStatus:Object.fromEntries(Object.entries(o.currentBatchStatus).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return[n,Object(l.a)(Object(l.a)({},a),{},{selected:!1})]})))}))}),[o]);c.useEffect((function(){var e=n.split(",").map((function(e){return{id:parseInt(e)}})),a=fe(e),c=o.batches.length>0?Promise.resolve(o.batches):se(t,e.map((function(e){return e.id})),o.batchSize,!0,!0,0).then((function(e){return Promise.resolve([e])}));Promise.all([oe(t),le(t,e[0].id),c]).then((function(t){var n=Object(s.a)(t,3),c=n[0],r=n[1],i=n[2];return u(Object(l.a)(Object(l.a)({},o),{},{labels:r,batches:i,project:c,currentBatchStatus:a,currentBatch:e,redirecting:!1}))}))}),[t,n]),c.useEffect((function(){var e=function(){var e=Object(x.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=null,e.t0=t.key,e.next="A"===e.t0?4:"a"===e.t0?6:"ArrowRight"===e.t0?8:"ArrowLeft"===e.t0?10:"Enter"===e.t0?12:"Backspace"===e.t0||"Delete"===e.t0?14:16;break;case 4:return n=t.ctrlKey&&t.shiftKey?w:null,e.abrupt("break",16);case 6:return n=t.ctrlKey&&!t.shiftKey?C:null,e.abrupt("break",16);case 8:return n=O,e.abrupt("break",16);case 10:return n=g,e.abrupt("break",16);case 12:return n=t.shiftKey?v:b,e.abrupt("break",16);case 14:return n=y,e.abrupt("break",16);case 16:n&&Oe(n);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return document.addEventListener("keydown",e,!1),function(){document.removeEventListener("keydown",e,!1)}}),[o,O,g,b,v,y,C,w]);var H=null;if(o.redirecting){var A=o.currentBatch.map((function(e){return e.id})).join(",");A?A!==n&&(H=Object(a.jsx)(d.a,{to:"/projects/".concat(t,"/batches/").concat(A),push:!0})):H=Object(a.jsx)(d.a,{to:"/projects/".concat(t),push:!0})}if(!o.project||!o.labels)return null;var T=Object.entries(o.currentBatchStatus).reduce((function(e,t){var n=Object(s.a)(t,2);n[0];return e+("labeled"===n[1].remoteStatus?1:0)}),0),D=Object.entries(o.currentBatchStatus).reduce((function(e,t){var n=Object(s.a)(t,2);n[0];return e+("ignored"===n[1].remoteStatus?1:0)}),0),U=Object.entries(o.currentBatchStatus).reduce((function(e,t){var n=Object(s.a)(t,2);n[0];return e+n[1].selected}),0);return Object(a.jsxs)(p.a,{container:!0,spacing:2,children:[Object(a.jsxs)(p.a,{item:!0,xs:3,children:[Object(a.jsxs)(p.a,{item:!0,children:[H,Object(a.jsx)(K.a,{style:{marginBottom:"10px"},variant:"h6",children:"Image-Level Labels"}),o.labels&&o.project?Object(a.jsx)(M,{configGroup:o.project.labelingConfiguration.image,labels:o.labels.image,setLabelGroup:function(e){return u(Object(l.a)(Object(l.a)({},o),{},{labels:{boxes:[],image:e,default:!1,ignored:!1}}))}}):null,Object(a.jsx)(q.a,{})]}),Object(a.jsxs)(p.a,{item:!0,children:[Object(a.jsx)(K.a,{variant:"h6",children:"View Settings"}),Object(a.jsx)(K.a,{id:"batch-size-selector",gutterBottom:!0,children:"Target Batch Size"}),Object(a.jsx)(V.a,{value:o.batchSize,"aria-labelledby":"batch-size-selector",valueLabelDisplay:"auto",onChange:function(e,t){return u(Object(l.a)(Object(l.a)({},o),{},{batchSize:t}))},step:10,marks:!0,min:10,max:110}),Object(a.jsx)(K.a,{id:"batch-size-selector",gutterBottom:!0,children:"Thumbnail Size"}),Object(a.jsx)(V.a,{value:o.thumbnailSize,"aria-labelledby":"batch-size-selector",valueLabelDisplay:"auto",onChange:function(e,t){return u(Object(l.a)(Object(l.a)({},o),{},{thumbnailSize:t}))},step:20,marks:!0,min:160,max:500}),Object(a.jsx)(q.a,{})]}),Object(a.jsxs)(p.a,{item:!0,children:[Object(a.jsx)(K.a,{style:{marginBottom:"10px"},variant:"h6",children:"Label Actions"}),Object(a.jsxs)(W.a,{size:"small",orientation:"vertical",color:"primary",style:{width:"100%"},"aria-label":"acton button group",children:[Object(a.jsx)(_,{startIcon:"\u23ce",disabled:T+D===o.currentBatch.length||0===U,onClick:function(){return I("save")},ref:b,children:"Save"}),Object(a.jsx)(_,{startIcon:"\u21e7\u23ce",disabled:T+D===o.currentBatch.length||0===U,onClick:function(){return I("ignore")},ref:v,children:"Ignore"}),Object(a.jsx)(_,{startIcon:"\u232b",ref:y,disabled:T+D===o.currentBatch.length||0===U,onClick:function(){return I("delete")},children:"Remove Labels"}),Object(a.jsx)(_,{startIcon:Object(a.jsx)(Z.a,{}),ref:O,onClick:N,disabled:0==o.batches.length,children:"Next"}),Object(a.jsx)(_,{startIcon:Object(a.jsx)(Q.a,{}),onClick:E,ref:g,disabled:0===B().length,children:"Previous"}),Object(a.jsx)(_,{disabled:U===o.currentBatch.length-T,onClick:R,startIcon:"\u2303A",ref:C,children:"Select All"}),Object(a.jsx)(_,{startIcon:"\u2303\u21e7A",disabled:0===U,onClick:z,ref:w,children:"Select None"})]}),Object(a.jsx)(m.a,{control:Object(a.jsx)(L.a,{checked:o.advanceOnSave,onChange:function(e,t){return u(Object(l.a)(Object(l.a)({},o),{},{advanceOnSave:t}))},name:"advanceOnSave"}),label:"Advance when batch complete?"}),ce(o.project.labelingConfiguration)?Object(a.jsx)(K.a,{variant:"body1",children:"This project has box-level labels which will be overwritten in batch mode."}):null]}),Object(a.jsxs)(p.a,{item:!0,children:[Object(a.jsx)(q.a,{style:{marginBottom:"10px"}}),Object(a.jsx)(K.a,{variant:"h6",children:"History"}),Object(a.jsx)(K.a,{variant:"caption",children:"Ten most recently reviewed batches."}),Object(a.jsx)($.a,{rows:o.history.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{id:e.images.map((function(e){return e.id})).join(",")})})),hideFooterPagination:!0,disableColumnSelector:!0,disableSelectionOnClick:!0,disableColumnMenu:!0,hideFooter:!0,disableColumnReorder:!0,disableColumnFilter:!0,autoHeight:!0,columns:[{field:"images",headerName:"ID",flex:1,renderCell:function(e){var n=e.value.map((function(e){return e.id}));return Object(a.jsx)(j.b,{to:"/projects/".concat(t,"/images/").concat(n.join(",")),children:n.slice(0,5).join(", ")+(n.length>5?", ...":"")})}}]}),H,Object(a.jsx)(q.a,{style:{marginBottom:"10px"}}),Object(a.jsx)(J.a,{component:j.b,variant:"body1",to:"/projects/".concat(t),children:"Return to Project Menu"})]})]}),Object(a.jsxs)(p.a,{item:!0,xs:9,children:[T+D<o.currentBatch.length?Object(a.jsxs)(k.a,{children:[Object(a.jsx)(ge,{items:o.currentBatch.filter((function(e){return"unknown"===o.currentBatchStatus[e.id].remoteStatus})).map((function(e){return{image:e,selected:o.currentBatchStatus[e.id].selected}})),thumbnailSize:o.thumbnailSize,projectId:t,toggleSelected:function(e){return u(Object(l.a)(Object(l.a)({},o),{},{currentBatchStatus:Object(l.a)(Object(l.a)({},o.currentBatchStatus),{},Object(h.a)({},e,Object(l.a)(Object(l.a)({},o.currentBatchStatus[e]),{},{selected:!o.currentBatchStatus[e].selected})))}))}}),Object(a.jsx)(q.a,{style:{marginBottom:"10px"}})]}):null,Object(a.jsxs)(p.a,{container:!0,direction:"row",alignItems:"center",spacing:1,children:[Object(a.jsx)(p.a,{item:!0,children:Object(a.jsx)(S.a,{onClick:P,disabled:0===T&&0===D,variant:"contained",children:"Reset"})}),Object(a.jsx)(p.a,{item:!0,children:Object(a.jsxs)(K.a,{variant:"body1",children:["Hiding ",T," labeled and ",D," ignored images."]})})]})]})]})},pe=n(157),ve=n(269),ye=n(263),Ce=n(212),Se=n(270),ke=n(258),we=n(154),Be=n(141),Ie=n.n(Be),Ne=we.a((function(e){return{box:{position:"absolute",border:"2px solid black",backgroundColor:"rgba(255,255,255,0.5)",color:"black"},selectedBox:{border:"2px solid red",color:"red"},startIcon:{position:"absolute",left:"8px"},iconButtonSpan:{paddingLeft:"40px"}}})),Ee=function(e){return"".concat(100*e,"%")},Le=function(e){return{left:Ee(e.x),top:Ee(e.y),width:Ee(e.w),height:Ee(e.h)}},Pe=function(e){return{x:Math.min(e.x1,e.x2),y:Math.min(e.y1,e.y2),w:Math.abs(e.x2-e.x1),h:Math.abs(e.y2-e.y1),id:e.id,labels:e.labels}},Re=function(e){var t=Pe(e);return{left:Ee(t.x),top:Ee(t.y),width:Ee(t.w),height:Ee(t.h)}},ze=function(e){var t=e.y1>e.y2,n=e.x1>e.x2,a=1===e.next&&!t||2===e.next&&t,c=1===e.next&&!n||2===e.next&&n;return{left:c?"0%":"auto",top:a?"0%":"auto",right:c?"auto":"0%",bottom:a?"auto":"0%",width:"10px",height:"10px",position:"absolute",backgroundColor:"red",marginLeft:c?"-5px":"0",marginRight:c?"0":"-5px",marginTop:a?"-5px":"0",marginBottom:a?"0":"-5px"}},He=function(e){return Object.values(e.single).join(", ")},Ae=function(e,t,n){var a=t.getBoundingClientRect(),c=a.x,r=a.y,i=a.width,o=a.height;return{x:(e.nativeEvent.pageX-window.scrollX-c*n)/(i*n),y:(e.nativeEvent.pageY-window.scrollY-r*n)/(o*n)}},Te=function(e){var t=Ne(),n=d.g().params,r=n.projectId,i=n.imageId,o=c.useRef(),l=Ie.a.debounce((function(t){e.onHover(Ae(t,o.current,e.zoom))}),5),s=function(t){e.onClick&&e.onClick(Ae(t,o.current,e.zoom))};return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[Object(a.jsx)(pe.a,{children:Object(a.jsx)("img",{ref:o,src:je(r,i),alt:"ID: ".concat(i),onMouseMove:l,onClick:s,style:{display:"block",zoom:e.zoom}})}),e.draftBox&&e.draftBox.x1&&e.draftBox.y1&&e.draftBox.x2&&e.draftBox.y2?Object(a.jsxs)("div",{onMouseMove:l,className:"".concat(t.box," ").concat(t.selectedBox),style:Re(e.draftBox),onClick:s,children:[Object(a.jsx)(K.a,{variant:"caption",children:He(e.draftBox.labels)}),e.draftBox.fixed?Object(a.jsx)("div",{style:ze(e.draftBox)}):null]}):null,e.boxes.map((function(n,c){return Object(a.jsx)("div",{onMouseMove:l,className:t.box,style:Le(n),onClick:function(t){e.onSelectBox(c,Ae(t,o.current,e.zoom))},children:Object(a.jsx)(K.a,{variant:"caption",children:He(n.labels)})},c)}))]})})},De=function(e){return e.length>0?e[0].id.toString():null},Me=function(e,t,n){return[{id:parseInt(e),status:t}].concat(n.filter((function(t){return t.id!==parseInt(e)}))).slice(0,10)},_e=function(){var e=d.g().params,t=e.projectId,n=e.imageId,r=c.useRef(),i=c.useRef(),o=c.useRef(),u=c.useRef(),b=c.useRef(),h=c.useRef(),O=c.useRef(),g=c.useState(null),v=Object(s.a)(g,2),y=v[0],C=v[1],S=c.useState(null),w=Object(s.a)(S,2),I=w[0],E=w[1],P=c.useState({queueSize:20,desiredImageId:n,status:"initializing",labels:null,advanceOnSave:!1,dirty:!1,notice:null,history:[],queue:[]}),R=Object(s.a)(P,2),z=R[0],H=R[1],A=c.useState(1),T=Object(s.a)(A,2),D=T[0],G=T[1],F=y&&y.fixed,Y=I?F?I.labelingConfiguration.box:I.labelingConfiguration.image:null,X=z.labels?F?y.labels:z.labels.image:null,ee=I?Math.round(100*I.nLabeled/I.nImages):null,te=c.useCallback((function(e){C(y?Object(l.a)(Object(l.a)({},y),{},{x1:1===y.next?e.x:y.x1,y1:1===y.next?e.y:y.y1,x2:2===y.next?e.x:y.x2,y2:2===y.next?e.y:y.y2,fixed:!0,next:1===y.next?2:1}):{x1:e.x,y1:e.y,x2:null,y2:null,labels:ne(I.labelingConfiguration.box),id:null,fixed:!1,next:2})}),[y,I]),ae=c.useCallback((function(e){y&&!y.fixed&&C(Object(l.a)(Object(l.a)({},y),{},{x2:e.x,y2:e.y}))}),[y]),re=c.useCallback((function(e,t){if(y)te(t);else{var n=z.labels.boxes.splice(e,1)[0];C({x1:(a=n).x,x2:a.x+a.w,y1:a.y,y2:a.y+a.h,labels:a.labels,id:a.id,next:2,fixed:!0}),H(Object(l.a)(Object(l.a)({},z),{},{labels:Object(l.a)(Object(l.a)({},z.labels),{},{boxes:z.labels.boxes,default:!1})}))}var a}),[z,y]);c.useEffect((function(){oe(t).then(E)}),[t,n]),c.useEffect((function(){var e=z.queue.filter((function(e){return e.id.toString()!==n})),a=e.map((function(e){return e.id})).concat(n?[parseInt(n)]:[]);Promise.all([n?le(t,n):Promise.resolve(null),z.queueSize<=e.length?Promise.resolve([]):se(t,a,z.queueSize-e.length)]).then((function(t){var a=Object(s.a)(t,2),c=a[0],r=a[1],i=e.concat(r);H(Object(l.a)(Object(l.a)({},z),{},{labels:c,queue:i,status:n?"waiting":"redirecting",desiredImageId:n||De(i)}))}))}),[n]);var ie=c.useCallback((function(){C(null)}),[]),de=c.useCallback((function(){z.labels.default||be(t,n).then((function(e){H(Object(l.a)(Object(l.a)({},z),{},{labels:e,dirty:!1,history:Me(n,"Unlabeled",z.history),notice:"Deleted your label and reverted to default."}))}))}),[n,z]),he=c.useCallback((function(){return H(Object(l.a)(Object(l.a)({},z),{},{notice:null}))}),[z]),fe=c.useCallback((function(){ue(t,n,Object(l.a)(Object(l.a)({},z.labels),{},{ignored:!1})).then(function(){var e=Object(x.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:H(Object(l.a)(Object(l.a)({},z),{},{labels:t,dirty:!1,history:Me(n,"Labeled",z.history),notice:"Saved your labels."})),z.advanceOnSave&&Oe(r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[z,r]),xe=c.useCallback((function(){C(null),H(Object(l.a)(Object(l.a)({},z),{},{dirty:!0,labels:Object(l.a)(Object(l.a)({},z.labels),{},{boxes:z.labels.boxes.concat([Pe(y)])})}))}),[y,z]),ge=c.useCallback((function(){F||ue(t,n,Object(l.a)(Object(l.a)({},z.labels),{},{ignored:!0})).then((function(e){H(Object(l.a)(Object(l.a)({},z),{},{labels:e,dirty:!1,history:Me(n,"Ignored",z.history),notice:"Ignored this image."}))}))}),[z,F]),me=c.useCallback((function(){F||H(Object(l.a)(Object(l.a)({},z),{},{desiredImageId:De(z.queue),history:Me(n,z.labels.ignored?"Ignored":z.labels.default?"Unlabeled":"Labeled",z.history),notice:"Advancing to next image.",status:"redirecting"}))}),[n,z.labels,z]),pe=c.useCallback((function(){F||0===z.history.length||H(Object(l.a)(Object(l.a)({},z),{},{desiredImageId:z.history.length>0?z.history[0].id.toString():null,history:z.history.slice(1),queue:[{id:parseInt(n)}].concat(z.queue),status:"redirecting"}))}),[n,z]),we=c.useCallback((function(e){F?(C(Object(l.a)(Object(l.a)({},y),{},{labels:e})),H(Object(l.a)(Object(l.a)({},z),{},{dirty:!0}))):H(Object(l.a)(Object(l.a)({},z),{},{dirty:!0,labels:Object(l.a)(Object(l.a)({},z.labels),{},{image:e,default:!1})}))}),[z,y]);c.useEffect((function(){var e=function(){var e=Object(x.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=null,e.t0=t.key,e.next="ArrowRight"===e.t0?4:"ArrowLeft"===e.t0?6:"Enter"===e.t0?8:"Backspace"===e.t0||"Delete"===e.t0?10:12;break;case 4:return n=r,e.abrupt("break",12);case 6:return n=i,e.abrupt("break",12);case 8:return n=F?h:t.shiftKey?u:o,e.abrupt("break",12);case 10:return n=F?O:b,e.abrupt("break",12);case 12:n&&Oe(n);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return document.addEventListener("keydown",e,!1),function(){document.removeEventListener("keydown",e,!1)}}),[z,F,h,O,r,i,o,u,b]);var Be="redirecting"===z.status?Object(a.jsx)(d.a,{to:z.desiredImageId?"/projects/".concat(t,"/images/").concat(z.desiredImageId):"/projects/".concat(t),push:!0}):null;return z.labels&&I?Object(a.jsxs)(p.a,{container:!0,spacing:2,children:[Object(a.jsx)(p.a,{item:!0,xs:12,children:Object(a.jsx)(ve.a,{position:"static",children:Object(a.jsxs)(ye.a,{children:[Object(a.jsxs)(k.a,{position:"relative",display:"inline-flex",children:[Object(a.jsx)(Ce.a,{style:{color:"white"},variant:"determinate",size:40,color:"secondary",value:ee}),Object(a.jsx)(k.a,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:Object(a.jsx)(K.a,{variant:"caption",component:"div",style:{color:"white"},children:"".concat(ee,"%")})})]}),Object(a.jsxs)(K.a,{variant:"h6",style:{marginLeft:"10px"},children:[I.name," / Images / ",n]})]})})}),Object(a.jsxs)(p.a,{container:!0,item:!0,xs:12,sm:3,direction:"column",spacing:2,children:[Object(a.jsxs)(p.a,{item:!0,children:[Be,Object(a.jsx)(K.a,{style:{marginBottom:"10px"},variant:"h6",children:F?"Box-Level Labels":"Image-Level Labels"}),Object(a.jsx)(M,{configGroup:Y,labels:X,setLabelGroup:we}),Object(a.jsx)(q.a,{})]}),Object(a.jsxs)(p.a,{item:!0,children:[Object(a.jsx)(K.a,{variant:"h6",children:"View Settings"}),Object(a.jsxs)(B.a,{style:{width:"100%",margin:"10px 0px"},component:"fieldset",children:[Object(a.jsx)(N.a,{component:"legend",children:"Zoom"}),Object(a.jsx)(V.a,{style:{margin:"0 5px"},valueLabelDisplay:"auto","aria-labelledby":"zoom-slider",value:D,min:1,max:5,onChange:function(e,t){return G(t)}})]}),Object(a.jsx)(q.a,{})]}),Object(a.jsxs)(p.a,{item:!0,children:[Object(a.jsx)(K.a,{style:{marginBottom:"10px"},variant:"h6",children:"Label Actions"}),Object(a.jsxs)(W.a,{size:"small",orientation:"vertical",color:"primary",style:{width:"100%"},"aria-label":"acton button group",children:[F?Object(a.jsx)(_,{startIcon:"\u23ce",onClick:xe,ref:h,children:"Set Box Label"}):null,F?Object(a.jsx)(_,{startIcon:"\u232b",onClick:ie,ref:O,children:"Delete Box"}):null,F?null:Object(a.jsx)(_,{startIcon:"\u23ce",disabled:!z.labels.default&&!z.dirty,onClick:fe,ref:o,children:"Save"}),F?null:Object(a.jsx)(_,{startIcon:"\u21e7\u23ce",disabled:z.labels.ignored,onClick:ge,ref:u,children:"Ignore"}),F?null:Object(a.jsx)(_,{startIcon:Object(a.jsx)(Z.a,{}),ref:r,onClick:me,children:"Next"}),F?null:Object(a.jsx)(_,{startIcon:Object(a.jsx)(Q.a,{}),onClick:pe,ref:i,disabled:0===z.history.filter((function(e){return e.id!==parseInt(n)})).length,children:"Previous"}),F?null:Object(a.jsx)(_,{disabled:z.labels.default,startIcon:"\u232b",ref:b,onClick:de,children:z.labels.ignored?"Unignore":"Remove Label"})]}),Object(a.jsx)(m.a,{control:Object(a.jsx)(L.a,{checked:z.advanceOnSave,onChange:function(e,t){return H(Object(l.a)(Object(l.a)({},z),{},{advanceOnSave:t}))},name:"advanceOnSave"}),label:"Advance on saving?"})]}),Object(a.jsxs)(p.a,{item:!0,children:[Object(a.jsx)(q.a,{style:{marginBottom:"10px"}}),Object(a.jsx)(K.a,{variant:"h6",children:"History"}),Object(a.jsx)(K.a,{variant:"caption",children:"Ten most recently reviewed images."}),Object(a.jsx)($.a,{rows:z.history,hideFooterPagination:!0,disableColumnSelector:!0,disableSelectionOnClick:!0,disableColumnMenu:!0,hideFooter:!0,disableColumnReorder:!0,disableColumnFilter:!0,autoHeight:!0,columns:[{field:"id",headerName:"ID",flex:1,renderCell:function(e){return Object(a.jsx)(j.b,{to:"/projects/".concat(t,"/images/").concat(e.value),children:e.value})}},{field:"status",headerName:"Status",flex:3}]})]}),Object(a.jsx)(p.a,{item:!0,children:Object(a.jsx)(J.a,{component:j.b,variant:"body1",to:"/projects/".concat(t),children:"Return to Project Menu"})})]}),Object(a.jsxs)(p.a,{item:!0,xs:12,sm:9,children:[Object(a.jsx)(Te,{onClick:ce(I.labelingConfiguration)?te:null,onHover:ae,onSelectBox:re,boxes:z.labels.boxes,draftBox:y,zoom:D}),Object(a.jsx)(Se.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:null!==z.notice,autoHideDuration:1500,onClose:he,message:z.notice,action:Object(a.jsx)(c.Fragment,{children:Object(a.jsx)(U.a,{size:"small","aria-label":"close",color:"inherit",onClick:he,children:Object(a.jsx)(ke.a,{fontSize:"small"})})})}),z.queue&&z.queue.length?z.queue.map((function(e,c){return Object(a.jsx)("img",{alt:"Background Load: ".concat(e.id),src:je(t,n),style:{width:0,height:0}},c)})):null]})]}):Be},Ue=r.a.createContext({apiUrl:null,postHeaders:null,getHeaders:null,queueSize:null,user:null}),Ge=function(){var e=c.useContext(Ue),t=e.apiUrl,n=e.postHeaders,r=e.getHeaders,i=d.g().params.projectId,o=c.useState(null),u=Object(s.a)(o,2),b=u[0],h=u[1],O=c.useState(!1),f=Object(s.a)(O,2),x=f[0],g=f[1],m=c.useState(!1),v=Object(s.a)(m,2),y=v[0],C=v[1],k=c.useCallback((function(){return fetch("".concat(t,"/api/v1/projects/").concat(i),Object(l.a)(Object(l.a)({},n),{},{body:JSON.stringify(b)})).then((function(e){return e.json()})).then((function(e){h(e),g(!1),C(!0)}))}),[b,h]);return c.useEffect((function(){fetch("".concat(t,"/api/v1/projects/").concat(i),Object(l.a)({},r)).then((function(e){return e.json()})).then((function(e){h(e)}))}),[]),b?y?Object(a.jsx)(d.a,{to:"/projects/".concat(i)}):Object(a.jsxs)(p.a,{container:!0,spacing:2,children:[Object(a.jsxs)(p.a,{item:!0,xs:12,children:[Object(a.jsx)(j.b,{to:"/projects/".concat(i),children:Object(a.jsx)(K.a,{variant:"subtitle1",children:"Back to project menu"})}),Object(a.jsxs)(K.a,{variant:"h3",children:["Project: ",b.name]}),Object(a.jsx)(K.a,{variant:"h5",children:"Edit Labeling Configuration"})]}),Object(a.jsxs)(p.a,{item:!0,xs:12,sm:6,children:[Object(a.jsx)(K.a,{variant:"h6",children:"Image-Level Labels"}),Object(a.jsx)(M,{configGroup:b.labelingConfiguration.image,setConfigGroup:function(e){g(!0),h(Object(l.a)(Object(l.a)({},b),{},{labelingConfiguration:Object(l.a)(Object(l.a)({},b.labelingConfiguration),{},{image:e})}))}})]}),Object(a.jsxs)(p.a,{item:!0,sm:12,md:6,children:[Object(a.jsx)(K.a,{variant:"h6",children:"Box-Level Labels"}),Object(a.jsx)(M,{configGroup:b.labelingConfiguration.box,setConfigGroup:function(e){g(!0),h(Object(l.a)(Object(l.a)({},b),{},{labelingConfiguration:Object(l.a)(Object(l.a)({},b.labelingConfiguration),{},{box:e})}))}})]}),Object(a.jsx)(p.a,{item:!0,xs:12,children:Object(a.jsx)(S.a,{onClick:k,style:{width:"100%"},variant:"contained",disabled:!x,color:"primary",children:"Save Labeling Configuration"})})]}):null},Fe=function(){var e=c.useContext(Ue),t=c.useState(""),n=Object(s.a)(t,2),r=n[0],i=n[1],o=c.useState([]),u=Object(s.a)(o,2),b=u[0],d=u[1];c.useEffect((function(){fetch("".concat(e.apiUrl,"/api/v1/projects"),Object(l.a)({},e.getHeaders)).then((function(e){return e.json()})).then(d)}),[]);var h=c.useCallback((function(){fetch("".concat(e.apiUrl,"/api/v1/projects"),Object(l.a)(Object(l.a)({},e.postHeaders),{},{body:JSON.stringify({name:r})})).then((function(e){return e.json()})).then((function(e){d(b.concat([e])),i("")}))}),[r,b,d]);return Object(a.jsxs)(p.a,{container:!0,spacing:2,children:[Object(a.jsx)(p.a,{item:!0,xs:12,children:Object(a.jsx)(K.a,{variant:"h5",children:"Projects"})}),Object(a.jsx)(p.a,{item:!0,xs:12,children:Object(a.jsx)($.a,{rows:b,disableColumnSelector:!0,disableSelectionOnClick:!0,disableColumnMenu:!0,disableColumnFilter:!0,autoHeight:!0,columns:[{field:"id",headerName:"ID",flex:1,renderCell:function(e){return Object(a.jsx)(j.b,{to:"/projects/".concat(e.value),children:e.value})}},{field:"name",headerName:"Name",flex:3},{field:"nImages",headerName:"Number of Images",flex:1},{field:"nLabeled",headerName:"Labeled Images",flex:1}]})}),Object(a.jsx)(p.a,{item:!0,xs:12,children:Object(a.jsxs)(k.a,{children:[Object(a.jsx)(v.a,{value:r,onChange:function(e){return i(e.target.value)},style:{marginRight:"10px"}}),Object(a.jsx)(S.a,{variant:"contained",color:"primary",disabled:""===r,onClick:h,children:"Create Project"})]})})]})},Ke=function(){var e=c.useContext(Ue),t=c.useState(""),n=Object(s.a)(t,2),r=n[0],i=n[1],o=c.useState(!1),u=Object(s.a)(o,2),b=u[0],j=u[1],d=c.useState([]),h=Object(s.a)(d,2),O=h[0],f=h[1],x=c.useState(null),g=Object(s.a)(x,2),y=g[0],C=g[1],k=c.useState(null),w=Object(s.a)(k,2),B=w[0],I=w[1];c.useEffect((function(){fetch("".concat(e.apiUrl,"/api/v1/users/me"),Object(l.a)({},e.getHeaders)).then((function(e){return e.json()})).then(C)}),[]),c.useEffect((function(){fetch("".concat(e.apiUrl,"/api/v1/users"),Object(l.a)({},e.getHeaders)).then((function(e){return e.json()})).then(f)}),[]),c.useEffect((function(){fetch("".concat(e.apiUrl,"/api/v1/auth/config"),Object(l.a)({},e.getHeaders)).then((function(e){return e.json()})).then(I)}),[]);var N=c.useCallback((function(){fetch("".concat(e.apiUrl,"/api/v1/users"),Object(l.a)(Object(l.a)({},e.postHeaders),{},{body:JSON.stringify({name:r,isAdmin:b})})).then((function(e){return e.json()})).then((function(e){f(O.concat([e])),i("")}))}),[b,r,O,f]);return y&&B?Object(a.jsxs)(p.a,{container:!0,spacing:2,children:[Object(a.jsx)(p.a,{item:!0,xs:12,children:Object(a.jsx)(K.a,{variant:"h5",children:"Users"})}),Object(a.jsx)(p.a,{item:!0,xs:12,children:Object(a.jsxs)(K.a,{variant:"body1",children:["github"===B.provider?"You are using GitHub as the authentication provider. Usernames should match GitHub usernames.":null,"google"===B.provider?"You are using Google as the authentication provider. Usernames should match email addresses.":null,null===B.provider?"You are not using an authentication provider. You will always be logged in as the first user.":null]})}),Object(a.jsx)(p.a,{item:!0,xs:12,children:Object(a.jsx)($.a,{rows:O,autoHeight:!0,columns:[{field:"id",headerName:"ID",flex:1,disableColumnMenu:!0},{field:"name",headerName:"Name",flex:5,disableColumnMenu:!0},{field:"isAdmin",headerName:"Adminstrator",flex:2,valueFormatter:function(e){return e.value?"Yes":"No"},disableColumnMenu:!0}]})}),Object(a.jsx)(p.a,{item:!0,xs:12,children:y.isAdmin?Object(a.jsxs)(p.a,{container:!0,direction:"row",children:[Object(a.jsx)(v.a,{value:r,onChange:function(e){return i(e.target.value)},placeholder:"New user name"}),Object(a.jsx)(m.a,{control:Object(a.jsx)(L.a,{checked:b,onChange:function(e,t){return j(t)},name:"makeAdmin"}),label:"Administrator"}),Object(a.jsx)(S.a,{disabled:""===r,onClick:N,children:"Create User"})]}):null})]}):null},qe=n(142),Ve=n.n(qe),We=function(){var e=c.useContext(Ue),t=e.apiUrl,n=e.postHeaders,r=e.getHeaders,i=d.g().params.projectId,o=c.useState(null),u=Object(s.a)(o,2),b=u[0],h=u[1],O=c.useState([]),f=Object(s.a)(O,2),x=f[0],g=f[1],m=c.useState(null),v=Object(s.a)(m,2),y=v[0],C=v[1],k=c.useCallback((function(){return fetch("".concat(t,"/api/v1/projects/").concat(i,"/images"),Object(l.a)(Object(l.a)({},n),{},{body:JSON.stringify({files:x,defaults:y})})).then((function(){C(ae(b)),g([])}))}),[b,x,y]);return c.useEffect((function(){fetch("".concat(t,"/api/v1/projects/").concat(i),Object(l.a)({},r)).then((function(e){return e.json()})).then((function(e){C(ae(e)),h(e)}))}),[]),b?Object(a.jsxs)(p.a,{container:!0,spacing:2,children:[Object(a.jsxs)(p.a,{item:!0,xs:12,children:[Object(a.jsx)(j.b,{to:"/projects/".concat(i),children:Object(a.jsx)(K.a,{variant:"subtitle1",children:"Back to project menu"})}),Object(a.jsx)(K.a,{variant:"h5",children:"Add Files to Project"})]}),Object(a.jsx)(p.a,{item:!0,xs:6,children:Object(a.jsx)(Ve.a,{label:"New Files",variant:"outlined",value:x,onPaste:function(e){e.preventDefault(),g(x.concat(e.clipboardData.getData("Text").split("\n").filter((function(e){return e.length>0}))))},onAdd:function(e){return g(x.concat([e]))},onDelete:function(e){return g(x.filter((function(t){return t!==e})))},fullWidth:!0})}),Object(a.jsxs)(p.a,{item:!0,xs:6,children:[Object(a.jsx)(K.a,{variant:"h6",children:"Defaults"}),Object(a.jsx)(M,{configGroup:b.labelingConfiguration.image,labels:y.image,setLabelGroup:function(e){return C(Object(l.a)(Object(l.a)({},y),{},{image:e}))}})]}),Object(a.jsx)(p.a,{item:!0,xs:12,children:Object(a.jsx)(S.a,{onClick:k,disabled:0===x.length,style:{width:"100%"},variant:"contained",color:"primary",children:"Add Files"})})]}):null},Je=function(){var e=d.g().params.projectId,t=c.useState([]),n=Object(s.a)(t,2),r=n[0],i=n[1],o=c.useState(null),l=Object(s.a)(o,2),u=l[0],b=l[1],h=c.useState(0),O=Object(s.a)(h,2),f=O[0],x=O[1],g=c.useState([]),m=Object(s.a)(g,2),v=m[0],y=m[1],C=c.useState(!1),k=Object(s.a)(C,2),w=k[0],B=k[1];if(c.useEffect((function(){oe(e).then(b)}),[]),c.useEffect((function(){se(e,[],10,!1,!0,0).then(i)}),[e]),c.useEffect((function(){B(!0),se(e,[],15,!1,!1,-1,f+1).then((function(e){y(e),B(!1)}))}),[e,f]),!u)return null;var I,N=(I=u.labelingConfiguration,Object.keys(I.box.single).length>0||Object.keys(I.box.multiple).length>0||Object.keys(I.box.text).length>0||Object.keys(I.image.single).length>0||Object.keys(I.image.multiple).length>0||Object.keys(I.image.text).length>0);return Object(a.jsxs)(p.a,{container:!0,spacing:2,children:[Object(a.jsxs)(p.a,{item:!0,xs:12,children:[Object(a.jsx)(j.b,{to:"/projects",children:Object(a.jsx)(K.a,{variant:"subtitle1",children:"Back to projects list"})}),Object(a.jsxs)(K.a,{variant:"h3",children:["Project: ",u.name]})]}),Object(a.jsx)(p.a,{item:!0,children:Object(a.jsxs)("ul",{children:[N&&v.length>0?Object(a.jsx)("li",{children:r.length>0?Object(a.jsx)(j.b,{to:"/projects/".concat(e,"/images/").concat(r[0].id),children:Object(a.jsx)(K.a,{variant:"body1",children:"Start labeling individual images"})}):Object(a.jsx)(K.a,{variant:"body1",children:"No images remain for labeling."})}):null,N&&0!==v.length&&0!==r.length?Object(a.jsx)("li",{children:Object(a.jsx)(j.b,{to:"/projects/".concat(e,"/batches/").concat(r.map((function(e){return e.id})).join(",")),children:Object(a.jsx)(K.a,{variant:"body1",children:"Start labeling image batches"})})}):null,Object(a.jsx)("li",{children:Object(a.jsx)(j.b,{to:"/projects/".concat(e,"/edit-project"),children:Object(a.jsx)(K.a,{variant:"body1",children:N?"Edit project configuration":"Configure project"})})}),Object(a.jsx)("li",{children:Object(a.jsx)("a",{href:de(e),children:Object(a.jsx)(K.a,{variant:"body1",children:"Export project"})})})]})}),Object(a.jsx)(p.a,{item:!0,xs:12,children:Object(a.jsx)($.a,{rows:v,autoHeight:!0,disableColumnSelector:!0,disableSelectionOnClick:!0,disableColumnMenu:!0,disableColumnFilter:!0,columns:[{field:"id",headerName:"ID",flex:1,disableColumnMenu:!0,renderCell:function(t){return Object(a.jsx)(j.b,{to:"/projects/".concat(e,"/images/").concat(t.value),children:t.value})}},{field:"filepath",headerName:"Path",flex:5},{field:"labels",headerName:"# Labels",flex:1},{field:"status",headerName:"Status",renderCell:function(e){return Object(a.jsx)("span",{style:{textTransform:"capitalize"},children:e.value})},flex:1}],pagination:!0,pageSize:15,rowsPerPageOptions:[15],rowCount:u.nImages,paginationMode:"server",onPageChange:function(e){return x(e.page)},loading:w})}),Object(a.jsx)(p.a,{item:!0,children:Object(a.jsx)(S.a,{component:j.b,to:"/projects/".concat(e,"/add-images"),variant:"contained",color:"primary",disabled:!N,children:"Add Images"})})]})},Ye=u.a({components:{MuiImageListItem:{styleOverrides:{img:{maxWidth:"100%",maxHeight:"100%",height:"auto",width:"auto",transform:"none",margin:"auto",position:"absolute",top:0,bottom:0,left:0,right:0}}}}}),Xe=function(){var e=c.useState({queueSize:20,apiUrl:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"",postHeaders:{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"},getHeaders:{credentials:"include"},user:void 0}),t=Object(s.a)(e,2),n=t[0],r=t[1];return c.useEffect((function(){fetch("".concat(n.apiUrl,"/api/v1/users/me"),Object(l.a)({},n.getHeaders)).then((function(e){if(e.ok)return e;throw Error(e.statusText)})).then((function(e){return e.json().then((function(e){r(Object(l.a)(Object(l.a)({},n),{},{user:e}))}))}),(function(){r(Object(l.a)(Object(l.a)({},n),{},{user:null}))}))}),[]),void 0===n.user?null:null===n.user?(window.location.href="".concat(n.apiUrl,"/auth/login"),null):Object(a.jsx)(Ue.Provider,{value:n,children:Object(a.jsx)(b.a,{theme:Ye,children:Object(a.jsx)(j.a,{children:Object(a.jsxs)(d.d,{children:[Object(a.jsx)(d.b,{path:"/projects/:projectId/images/:imageId",children:Object(a.jsx)(_e,{})}),Object(a.jsx)(d.b,{path:"/projects/:projectId/batches/:imageIds",children:Object(a.jsx)(me,{})}),Object(a.jsx)(d.b,{path:"/projects/:projectId/edit-project",children:Object(a.jsx)(Ge,{})}),Object(a.jsx)(d.b,{path:"/projects/:projectId/add-images",children:Object(a.jsx)(We,{})}),Object(a.jsx)(d.b,{path:"/projects/:projectId",children:Object(a.jsx)(Je,{})}),Object(a.jsx)(d.b,{path:"/projects",children:Object(a.jsx)(Fe,{})}),Object(a.jsx)(d.b,{path:"/users",children:Object(a.jsx)(Ke,{})}),Object(a.jsx)(d.b,{path:"/",children:Object(a.jsx)(d.a,{to:"/projects"})})]})})})})};n(194);o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(Xe,{})}),document.getElementById("root"))}},[[195,1,2]]]);
//# sourceMappingURL=main.f6795bae.chunk.js.map