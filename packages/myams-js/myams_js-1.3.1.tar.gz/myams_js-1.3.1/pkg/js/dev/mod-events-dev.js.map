{"version":3,"sources":["mod-events.js"],"names":["$","MyAMS","_initialized","events","init","document","on","clickHandler","changeHandler","triggerEvent","initElement","element","each","idx","elt","context","handlers","data","event","handler","options","length","core","executeFunctionByName","Object","entries","getHandlers","result","push","source","currentTarget","amsClickHandler","amsPreventDefault","amsClickPreventDefault","preventDefault","amsStopPropagation","amsClickStopPropagation","stopPropagation","split","callback","getFunctionByName","undefined","call","amsClickHandlerOptions","prop","amsChangeHandler","amsKeepDefault","amsChangeKeepDefault","amsChangeStopPropagation","amsChangeHandlerOptions","target","trigger","env","bundle","config","modules","console","debug"],"mappings":"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","sourcesContent":["/* global MyAMS */\n/**\n * MyAMS events management\n */\n\nconst $ = MyAMS.$;\n\nlet _initialized = false;\n\n\nexport const events = {\n\n\tinit: () => {\n\n\t\tif (_initialized) {\n\t\t\treturn;\n\t\t}\n\t\t_initialized = true;\n\n\t\t// Initialize custom click handlers\n\t\t$(document).on('click', '[data-ams-click-handler]', MyAMS.events.clickHandler);\n\n\t\t// Initialize custom change handlers\n\t\t$(document).on('change', '[data-ams-change-handler]', MyAMS.events.changeHandler);\n\n\t\t// Initialize custom event on click\n\t\t$(document).on('click', '[data-ams-click-event]', MyAMS.events.triggerEvent);\n\n\t},\n\n\tinitElement: (element) => {\n\t\t$('[data-ams-events-handlers]', element).each((idx, elt) => {\n\t\t\tconst\n\t\t\t\tcontext = $(elt),\n\t\t\t\thandlers = context.data('ams-events-handlers');\n\t\t\tif (handlers) {\n\t\t\t\tfor (const [event, handler] of Object.entries(handlers)) {\n\t\t\t\t\tcontext.on(event, (event, ...options) => {\n\t\t\t\t\t\tif (options.length > 0) {\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(handler, document, event, ...options);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(handler, document, event,\n\t\t\t\t\t\t\t\tcontext.data('ams-events-options') || {});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Get events handlers on given element for a specific event\n\t *\n\t * @param element: the checked element\n\t * @param event: event for which handlers lookup is made\n\t * @returns: an array of elements for which the event handler is defined\n\t */\n\tgetHandlers: (element, event) => {\n\n\t\tconst\n\t\t\tresult = [],\n\t\t\thandlers = element.data('ams-events-handlers');\n\t\tif (handlers && handlers[event]) {\n\t\t\tresult.push(element);\n\t\t}\n\t\t$('[data-ams-events-handlers]', element).each((idx, elt) => {\n\t\t\tconst\n\t\t\t\tcontext = $(elt),\n\t\t\t\thandlers = context.data('ams-events-handlers');\n\t\t\tif (handlers && handlers[event]) {\n\t\t\t\tresult.push(context);\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t},\n\n\t/**\n\t * Generic click event handler\n\t */\n\tclickHandler: (event) => {\n\t\tconst\n\t\t\tsource = $(event.currentTarget),\n\t\t\thandlers = source.data('ams-disabled-handlers');\n\t\tif ((handlers === true) || (handlers === 'click') || (handlers === 'all')) {\n\t\t\treturn;\n\t\t}\n\t\tconst data = source.data();\n\t\tif (data.amsClickHandler) {\n\t\t\tif ((data.amsPreventDefault !== false) && (data.amsClickPreventDefault !== false)) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\tif ((data.amsStopPropagation !== false) && (data.amsClickStopPropagation !== false)) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t\tfor (const handler of data.amsClickHandler.split(/[\\s,;]+/)) {\n\t\t\t\tconst callback = MyAMS.core.getFunctionByName(handler);\n\t\t\t\tif (callback !== undefined) {\n\t\t\t\t\tcallback.call(document, event, data.amsClickHandlerOptions);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Generic change event handler\n\t */\n\tchangeHandler: (event) => {\n\t\tconst source = $(event.currentTarget);\n\t\t// Disable change handlers for readonly inputs\n\t\t// These change handlers are activated by IE!!!\n\t\tif (source.prop('readonly')) {\n\t\t\treturn;\n\t\t}\n\t\tconst handlers = source.data('ams-disabled-handlers');\n\t\tif ((handlers === true) || (handlers === 'change') || (handlers === 'all')) {\n\t\t\treturn;\n\t\t}\n\t\tconst data = source.data();\n\t\tif (data.amsChangeHandler) {\n\t\t\tif ((data.amsKeepDefault !== false) && (data.amsChangeKeepDefault !== false)) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\tif ((data.amsStopPropagation !== false) && (data.amsChangeStopPropagation !== false)) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t\tfor (const handler of data.amsChangeHandler.split(/[\\s,;]+/)) {\n\t\t\t\tconst callback = MyAMS.core.getFunctionByName(handler);\n\t\t\t\tif (callback !== undefined) {\n\t\t\t\t\tcallback.call(document, event, data.amsChangeHandlerOptions);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Genenric click event trigger\n\t */\n\ttriggerEvent: (event) => {\n\t\tconst source = $(event.currentTarget);\n\t\t$(event.target).trigger(source.data('ams-click-event'),\n\t\t\tsource.data('ams-click-event-options'));\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (MyAMS.env.bundle) {\n\tMyAMS.config.modules.push('events');\n} else {\n\tMyAMS.events = events;\n\tconsole.debug(\"MyAMS: events module loaded...\");\n}\n"],"file":"mod-events-dev.js"}