{"version":3,"sources":["mod-helpers.js"],"names":["$","MyAMS","helpers","clearValue","evt","target","currentTarget","data","val","clearDatetimeValue","picker","date","refreshElement","form","options","Promise","resolve","reject","element","object_id","core","executeFunctionByName","config","clearContent","document","then","replaceWith","content","initContent","refreshWidget","widget","widget_id","group","parents","refreshTableRow","selector","row_id","row","table","first","dtTable","DataTable","newRow","refreshImage","image","image_id","attr","src","moveElementToParentEnd","parent","detach","appendTo","hideDropdown","closest","dropdown","window","env","bundle","modules","push","console","debug"],"mappings":"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","sourcesContent":["/* global MyAMS */\n/**\n * MyAMS generic helpers\n */\n\nconst $ = MyAMS.$;\n\n\nexport const helpers = {\n\n\t/**\n\t * Click handler used to clear input\n\t */\n\tclearValue: (evt) => {\n\t\tconst target = $(evt.currentTarget).data('target');\n\t\tif (target) {\n\t\t\t$(target).val(null);\n\t\t}\n\t},\n\n\t/**\n\t * Click handler used to clear datetime input\n\t */\n\tclearDatetimeValue: (evt) => {\n\t\tconst\n\t\t\ttarget = $(evt.currentTarget).data('target'),\n\t\t\tpicker = $(target).data('datetimepicker');\n\t\tif (picker) {\n\t\t\tpicker.date(null);\n\t\t}\n\t},\n\n\t/**\n\t * Refresh a DOM element with content provided in\n\t * the <code>options</code> object.\n\t *\n\t * @param form: optional parent element\n\t * @param options: element properties:\n\t *   - object_id: ID of the refreshed element\n\t *   - content: new element content\n\t */\n\trefreshElement: (form, options) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet element = $(`[id=\"${options.object_id}\"]`);\n\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.clearContent, document, element).then(() => {\n\t\t\t\telement.replaceWith($(options.content));\n\t\t\t\telement = $(`[id=\"${options.object_id}\"]`);\n\t\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.initContent, document, element).then(() => {\n\t\t\t\t\tresolve(element);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t});\n\t},\n\n\t/**\n\t * Refresh a form widget with content provided in\n\t * the <code>options</code> object\n\t *\n\t * @param form: optional parent form\n\t * @param options: updated widget properties:\n\t *   - widget_id: ID of the refreshed widget\n\t *   - content: new element content\n\t */\n\trefreshWidget: (form, options) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet widget = $(`[id=\"${options.widget_id}\"]`),\n\t\t\t\tgroup = widget.parents('.widget-group');\n\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.clearContent, document, group).then(() => {\n\t\t\t\tgroup.replaceWith($(options.content));\n\t\t\t\twidget = $(`[id=\"${options.widget_id}\"]`);\n\t\t\t\tgroup = widget.parents('.widget-group');\n\t\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.initContent, document, group).then(() => {\n\t\t\t\t\tresolve(widget);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t});\n\t},\n\n\t/**\n\t * Refresh a table row with content provided in\n\t * the <code>options</code> object\n\t *\n\t * @param form: optional parent form\n\t * @param options: updated row properties:\n\t *   - row_id: ID of the refreshed row\n\t *   - content: new row content\n\t */\n\trefreshTableRow: (form, options) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst\n\t\t\t\tselector = `tr[id=\"${options.row_id}\"]`,\n\t\t\t\trow = $(selector),\n\t\t\t\ttable = row.parents('table').first(),\n\t\t\t\tdtTable = table.DataTable();\n\t\t\tif (options.data) {\n\t\t\t\tdtTable.row(selector).data(options.data);\n\t\t\t\tresolve(row);\n\t\t\t} else {\n\t\t\t\tconst newRow = $(options.content);\n\t\t\t\trow.replaceWith(newRow);\n\t\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.initContent,\n\t\t\t\t\tdocument, newRow).then(() => {\n\t\t\t\t\tresolve(newRow);\n\t\t\t\t}, reject);\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Refresh a single image with content provided in\n\t * the <code>options</code> object.\n\t *\n\t * @param form: optional parent element\n\t * @param options: image properties:\n\t *   - image_id: ID of the refreshed image\n\t *   - src: new image source URL\n\t */\n\trefreshImage: (form, options) => {\n\t\tconst image = $(`[id=\"${options.image_id}\"]`);\n\t\timage.attr('src', options.src);\n\t},\n\n\t/**\n\t * Move given element to the end of it's parent\n\t *\n\t * @param element: the element to be moved\n\t * @returns {*}\n\t */\n\tmoveElementToParentEnd: (element) => {\n\t\tconst parent = element.parent();\n\t\treturn element.detach()\n\t\t\t.appendTo(parent);\n\t},\n\n\t/**\n\t * Toggle dropdown associated with given event target\n\t *\n\t * @param evt: source event\n\t */\n\thideDropdown: (evt) => {\n\t\t$(evt.target).closest('.dropdown-menu').dropdown('hide');\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (window.MyAMS) {\n\tif (MyAMS.env.bundle) {\n\t\tMyAMS.config.modules.push('helpers');\n\t} else {\n\t\tMyAMS.helpers = helpers;\n\t\tconsole.debug(\"MyAMS: helpers module loaded...\");\n\t}\n}\n"],"file":"mod-helpers-dev.js"}