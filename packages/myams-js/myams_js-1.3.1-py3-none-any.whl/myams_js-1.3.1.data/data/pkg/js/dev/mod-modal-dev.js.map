{"version":3,"sources":["mod-modal.js"],"names":["$","MyAMS","_initialized","modalToggleEventHandler","evt","Promise","resolve","reject","source","currentTarget","handlers","data","attr","hasClass","stopPropagation","preventDefault","modal","open","then","modalShownEventHandler","zIndexModal","dialog","target","visibleModalsCount","length","zIndex","css","setTimeout","not","first","addClass","off","on","handler","modalDismissEventHandler","core","executeFunctionByName","document","dynamicModalShownEventHandler","config","initContent","parents","form","confirmChangedForm","status","modalHiddenEventHandler","fn","Constructor","prototype","_checkScrollbar","_setScrollbar","dynamicModalHiddenEventHandler","clearContent","remove","init","ajaxNav","options","sourceData","url","amsUrl","urlGetter","getFunctionByName","startsWith","ajax","type","cache","amsAllowCache","undefined","request","require","response","getResponse","dataType","contentType","result","content","dialogData","dialogOptions","settings","handleJSON","wrap","parent","backdrop","extend","amsOptions","amsInit","append","stats","amsLogEvent","logPageview","close","element","objectOrParentWithClass","env","bundle","modules","push","console","debug"],"mappings":"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","sourcesContent":["/* global MyAMS */\n/**\n * MyAMS modal dialogs support\n */\n\nconst $ = MyAMS.$;\n\n\nlet _initialized = false;\n\n\n/*\n * Standard data-toggle=\"modal\" handler\n */\nexport function modalToggleEventHandler(evt) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst\n\t\t\tsource = $(evt.currentTarget),\n\t\t\thandlers = source.data('ams-disabled-handlers');\n\t\tif (source.attr('disabled') ||\n\t\t\tsource.hasClass('disabled') ||\n\t\t\t(handlers === true) ||\n\t\t\t(handlers === 'click') ||\n\t\t\t(handlers === 'all')) {\n\t\t\tresolve(false);\n\t\t\treturn;\n\t\t}\n\t\tif (source.data('ams-context-menu') === true) {\n\t\t\tresolve(false);\n\t\t\treturn;\n\t\t}\n\t\tif (source.data('ams-stop-propagation') === true) {\n\t\t\tevt.stopPropagation();\n\t\t}\n\t\tevt.preventDefault();\n\t\tMyAMS.modal.open(source).then(() => {\n\t\t\tresolve(true);\n\t\t}, reject);\n\t});\n}\n\n/**\n * Standard modal shown event handler\n * This handler is used to allow modals stacking\n */\nexport function modalShownEventHandler(evt) {\n\n\tconst zIndexModal = 1100;\n\n\t// Enable modals stacking\n\tconst\n\t\tdialog = $(evt.target),\n\t\tvisibleModalsCount = $('.modal:visible').length,\n\t\tzIndex = zIndexModal + (100 * visibleModalsCount);\n\tdialog.css('z-index', zIndex);\n\tsetTimeout(() => {\n\t\t$('.modal-backdrop').not('.modal-stack')\n\t\t\t.first()\n\t\t\t.css('z-index', zIndex - 10)\n\t\t\t.addClass('modal-stack');\n\t}, 0);\n\t// Check form contents before closing modals\n\t$(dialog).off('click', '[data-dismiss=\"modal\"]')\n\t\t.on('click', '[data-dismiss=\"modal\"]', (evt) => {\n\t\t\tconst handler = $(evt.currentTarget).data('ams-dismiss-handler') || modalDismissEventHandler;\n\t\t\treturn MyAMS.core.executeFunctionByName(handler, document, evt);\n\t\t});\n}\n\n\n/**\n * Dynamic modal 'shown' callback\n * This callback is used to initialize modal's viewport size\n *\n * @param evt: source event\n */\nexport function dynamicModalShownEventHandler(evt) {\n\tconst dialog = $(evt.target);\n\treturn MyAMS.core.executeFunctionByName(dialog.data('ams-init-content') ||\n\t\tMyAMS.config.initContent, document, dialog);\n}\n\n\n/**\n * Modal dismiss handler\n */\nexport function modalDismissEventHandler(evt) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst\n\t\t\tsource = $(evt.currentTarget),\n\t\t\tdialog = source.parents('.modal').first();\n\t\tdialog.data('modal-result', $(evt.currentTarget).data('modal-dismiss-value'));\n\t\tif (MyAMS.form) {\n\t\t\tMyAMS.form.confirmChangedForm(dialog).then((status) => {\n\t\t\t\tif (status === 'success') {\n\t\t\t\t\tdialog.modal('hide');\n\t\t\t\t}\n\t\t\t}).then(resolve, reject);\n\t\t} else {\n\t\t\tdialog.modal('hide');\n\t\t\tresolve();\n\t\t}\n\t});\n}\n\n\n/**\n * Standard modal hidden event handler\n *\n * If several visible modals are still, a \"modal-open\" class is added to body to ensure\n * modals are still visible.\n */\nexport function modalHiddenEventHandler() {\n\tif ($('.modal:visible').length > 0) {\n\t\t$.fn.modal.Constructor.prototype._checkScrollbar();\n\t\t$.fn.modal.Constructor.prototype._setScrollbar();\n\t\t$('body').addClass('modal-open');\n\t}\n}\n\n\n/**\n * Dynamic modal 'hidden' callback\n * This callback is used to clear and remove dynamic modals\n *\n * @param evt: source event\n */\nexport function dynamicModalHiddenEventHandler(evt) {\n\tconst dialog = $(evt.target);\n\tMyAMS.core.executeFunctionByName(dialog.data('ams-clear-content') ||\n\t\tMyAMS.config.clearContent, document, dialog).then(() => {\n\t\tif (dialog.data('dynamic') === true) {\n\t\t\tdialog.remove();\n\t\t}\n\t});\n}\n\n\n/**\n * Main modal module definition\n */\nexport const modal = {\n\n\tinit: () => {\n\n\t\tif (_initialized) {\n\t\t\treturn;\n\t\t}\n\t\t_initialized = true;\n\n\t\tif (MyAMS.config.ajaxNav) {\n\t\t\t// Initialize modal dialogs links\n\t\t\t// Standard Bootstrap handlers are removed!!\n\t\t\t$(document).off('click', '[data-toggle=\"modal\"]')\n\t\t\t\t.on('click', '[data-toggle=\"modal\"]', (evt) => {\n\t\t\t\t\tconst handler = $(evt.currentTarget).data('ams-modal-handler') || modalToggleEventHandler;\n\t\t\t\t\tMyAMS.core.executeFunctionByName(handler, document, evt);\n\t\t\t\t});\n\t\t}\n\n\t\t// Handle modal shown event to allow modals stacking\n\t\t$(document).on('shown.bs.modal', '.modal', (evt) => {\n\t\t\tconst handler = $(evt.currentTarget).data('ams-shown-handler') || modalShownEventHandler;\n\t\t\tMyAMS.core.executeFunctionByName(handler, document, evt);\n\t\t});\n\n\t\t// Handle modal hidden event to check remaining modals\n\t\t$(document).on('hidden.bs.modal', '.modal', (evt) => {\n\t\t\tconst handler = $(evt.currentTarget).data('ams-hidden-handler') || modalHiddenEventHandler;\n\t\t\tMyAMS.core.executeFunctionByName(handler, document, evt);\n\t\t});\n\t},\n\n\topen: (source, options) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet sourceData = {},\n\t\t\t\turl = source;\n\t\t\tif (typeof source !== 'string') {\n\t\t\t\tsourceData = source.data();\n\t\t\t\turl = source.attr('href') || sourceData.amsUrl;\n\t\t\t}\n\t\t\tconst urlGetter = MyAMS.core.getFunctionByName(url);\n\t\t\tif (typeof urlGetter === 'function') {\n\t\t\t\turl = urlGetter(source);\n\t\t\t}\n\t\t\tif (!url) {\n\t\t\t\treject(\"No provided URL!\");\n\t\t\t}\n\t\t\tif (url.startsWith('#')) {  // Open inner modal\n\t\t\t\t$(url).modal('show');\n\t\t\t\tresolve();\n\t\t\t} else {\n\t\t\t\t$.ajax({\n\t\t\t\t\ttype: 'get',\n\t\t\t\t\turl: url,\n\t\t\t\t\tcache: sourceData.amsAllowCache === undefined ? false : sourceData.amsAllowCache,\n\t\t\t\t\tdata: options\n\t\t\t\t}).then((data, status, request) => {\n\t\t\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tresponse = MyAMS.ajax.getResponse(request),\n\t\t\t\t\t\t\tdataType = response.contentType,\n\t\t\t\t\t\t\tresult = response.data;\n\t\t\t\t\t\tlet content,\n\t\t\t\t\t\t\tdialog,\n\t\t\t\t\t\t\tdialogData,\n\t\t\t\t\t\t\tdialogOptions,\n\t\t\t\t\t\t\tsettings;\n\t\t\t\t\t\tswitch (dataType) {\n\t\t\t\t\t\t\tcase 'json':\n\t\t\t\t\t\t\t\tMyAMS.ajax.handleJSON(result,\n\t\t\t\t\t\t\t\t\t$($(source).data('ams-json-target') || '#content'));\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'script':\n\t\t\t\t\t\t\tcase 'xml':\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'html':\n\t\t\t\t\t\t\tcase 'text':\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tcontent = $(result),\n\t\t\t\t\t\t\t\tdialog = $('.modal-dialog', content.wrap('<div></div>').parent()),\n\t\t\t\t\t\t\t\tdialogData = dialog.data() || {},\n\t\t\t\t\t\t\t\tdialogOptions = {\n\t\t\t\t\t\t\t\t\tbackdrop: dialogData.backdrop === undefined ? 'static' : dialogData.backdrop\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tsettings = $.extend({}, dialogOptions, dialogData.amsOptions);\n\t\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(dialogData.amsInit, dialog, settings) || settings;\n\t\t\t\t\t\t\t\t$('<div>').addClass('modal fade')\n\t\t\t\t\t\t\t\t\t.data('dynamic', true)\n\t\t\t\t\t\t\t\t\t.append(content)\n\t\t\t\t\t\t\t\t\t.on('show.bs.modal', dynamicModalShownEventHandler)\n\t\t\t\t\t\t\t\t\t.on('hidden.bs.modal', dynamicModalHiddenEventHandler)\n\t\t\t\t\t\t\t\t\t.modal(settings);\n\t\t\t\t\t\t\t\tif (MyAMS.stats &&\n\t\t\t\t\t\t\t\t\t!((sourceData.amsLogEvent === false) ||\n\t\t\t\t\t\t\t\t\t\t(dialogData.amsLogEvent === false))) {\n\t\t\t\t\t\t\t\t\tMyAMS.stats.logPageview(url);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then(resolve);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Close modal associated with given element\n\t *\n\t * @param element: the element contained into closed modal\n\t */\n\tclose: (element) => {\n\t\tif (typeof element === 'string') {\n\t\t\telement = $(element);\n\t\t} else if (typeof element === 'undefined') {\n\t\t\telement = $('.modal-dialog:last');\n\t\t}\n\t\tconst dialog = element.objectOrParentWithClass('modal');\n\t\tif (dialog.length > 0) {\n\t\t\tdialog.modal('hide');\n\t\t}\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (MyAMS.env.bundle) {\n\tMyAMS.config.modules.push('modal');\n} else {\n\tMyAMS.modal = modal;\n\tconsole.debug(\"MyAMS: modal module loaded...\");\n}\n"],"file":"mod-modal-dev.js"}