(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b44ec4e"],{"38cf":function(t,e,s){var a=s("23e7"),n=s("1148");a({target:"String",proto:!0},{repeat:n})},"46c6":function(t,e,s){},8752:function(t,e,s){"use strict";s("46c6")},bcf7:function(t,e,s){"use strict";s.r(e);s("38cf");var a=s("7a23"),n=Object(a["K"])("data-v-5d3d83de");Object(a["u"])("data-v-5d3d83de");var i={key:1,class:"music"},c={class:"track"},r={key:0,class:"unknown"},u={key:1,class:"no-track"},o={key:0,class:"time"},l={class:"row"},h={class:"progress-bar"},p=Object(a["h"])("div",{class:"total"},null,-1),m={class:"row"},d={key:1,class:"playback-status"},b={class:"status-property col-4"},v=Object(a["h"])("i",{class:"fa fa-volume-up"},null,-1),g=Object(a["g"])("Â  "),f={class:"status-property col-2"},k={class:"status-property col-2"},O={class:"status-property col-2"},j={class:"status-property col-2"};Object(a["s"])();var y=n((function(t,e,s,n,y,w){var C=Object(a["z"])("Loading");return y.loading?(Object(a["r"])(),Object(a["e"])(C,{key:0})):(Object(a["r"])(),Object(a["e"])("div",i,[Object(a["h"])("div",c,[y.status?Object(a["f"])("",!0):(Object(a["r"])(),Object(a["e"])("div",r,"[Unknown state]")),y.status&&"stop"===y.status.state?(Object(a["r"])(),Object(a["e"])("div",u,"No media is being played")):Object(a["f"])("",!0),y.status&&"stop"!==y.status.state&&y.track&&y.track.artist?(Object(a["r"])(),Object(a["e"])("div",{key:2,class:"artist",textContent:Object(a["C"])(y.track.artist)},null,8,["textContent"])):Object(a["f"])("",!0),y.status&&"stop"!==y.status.state&&y.track&&y.track.title?(Object(a["r"])(),Object(a["e"])("div",{key:3,class:"title",textContent:Object(a["C"])(y.track.title)},null,8,["textContent"])):Object(a["f"])("",!0)]),y.status&&"play"===y.status.state?(Object(a["r"])(),Object(a["e"])("div",o,[Object(a["h"])("div",l,[Object(a["h"])("div",h,[Object(a["h"])("div",{class:"elapsed",style:{width:y.track.time?y.status.elapsed/y.track.time*100+"%":"100%"}},null,4),p])]),Object(a["h"])("div",m,[Object(a["h"])("div",{class:"col-6 time-elapsed",textContent:Object(a["C"])(w.convertTime(y.status.elapsed))},null,8,["textContent"]),y.track.time?(Object(a["r"])(),Object(a["e"])("div",{key:0,class:"col-6 time-total",textContent:Object(a["C"])(w.convertTime(y.track.time))},null,8,["textContent"])):Object(a["f"])("",!0)])])):Object(a["f"])("",!0),y.status?(Object(a["r"])(),Object(a["e"])("div",d,[Object(a["h"])("div",b,[v,g,Object(a["h"])("span",{textContent:Object(a["C"])(y.status.volume+"%")},null,8,["textContent"])]),Object(a["h"])("div",f,[Object(a["h"])("i",{class:["fas fa-random",{active:y.status.random}]},null,2)]),Object(a["h"])("div",k,[Object(a["h"])("i",{class:["fas fa-redo",{active:y.status.repeat}]},null,2)]),Object(a["h"])("div",O,[Object(a["h"])("i",{class:["fa fa-bullseye",{active:y.status.single}]},null,2)]),Object(a["h"])("div",j,[Object(a["h"])("i",{class:["fa fa-utensils",{active:y.status.consume}]},null,2)])])):Object(a["f"])("",!0)]))})),w=(s("c975"),s("a15b"),s("a9e3"),s("b680"),s("4fad"),s("3835")),C=(s("96cf"),s("1da1")),T=s("3e54"),x=s("3a5e"),S={name:"Music",components:{Loading:x["a"]},mixins:[T["a"]],props:{refreshSeconds:{type:Number,required:!1,default:60}},data:function(){return{track:void 0,status:void 0,timer:void 0,loading:!1,syncTime:{timestamp:null,elapsed:null}}},methods:{refresh:function(){var t=this;return Object(C["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,t.request("music.mpd.status");case 4:return s=e.sent,e.next=7,t.request("music.mpd.currentsong");case 7:a=e.sent,t._parseStatus(s),t._parseTrack(a),"play"!==s.state||t.timer?"play"!==s.state&&t.timer&&t.stopTimer():t.startTimer();case 11:return e.prev=11,t.loading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,,11,14]])})))()},convertTime:function(t){t=parseFloat(t);var e={};e.h=parseInt(t/3600),e.m=parseInt(t/60-60*e.h),e.s=parseInt(t-(3600*e.h+60*e.m));for(var s=0,a=["m","s"];s<a.length;s++){var n=a[s];e[n]=""+e[n]}for(var i=0,c=["m","s"];i<c.length;i++){var r=c[i];parseInt(e[r])<10&&(e[r]="0"+e[r])}var u=[];return parseInt(e.h)&&u.push(e.h),u.push(e.m,e.s),u.join(":")},_parseStatus:function(t){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function s(){var a,n,i,c,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(t&&0!==t.length){s.next=4;break}return s.next=3,e.request("music.mpd.status");case 3:t=s.sent;case 4:for(e.status||(e.status={}),a=0,n=Object.entries(t);a<n.length;a++)i=Object(w["a"])(n[a],2),c=i[0],r=i[1],["consume","random","repeat","single","bitrate"].indexOf(c)>=0?e.status[c]=!!parseInt(r):["nextsong","nextsongid","playlist","playlistlength","volume","xfade","song","songid"].indexOf(c)>=0?e.status[c]=parseInt(r):["elapsed"].indexOf(c)>=0?e.status[c]=parseFloat(r):e.status[c]=r;case 6:case"end":return s.stop()}}),s)})))()},_parseTrack:function(t){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function s(){var a,n,i,c,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(t&&0!==t.length){s.next=4;break}return s.next=3,e.request("music.mpd.currentsong");case 3:t=s.sent;case 4:for(e.track||(e.track={}),a=0,n=Object.entries(t);a<n.length;a++)i=Object(w["a"])(n[a],2),c=i[0],r=i[1],["id","pos","time","track","disc"].indexOf(c)>=0?e.track[c]=parseInt(r):e.track[c]=r;case 6:case"end":return s.stop()}}),s)})))()},showNewTrackNotification:function(){this.notify({html:"<b>"+(this.track.artist||"[No Artist]")+"</b><br>"+(this.track.title||"[No Title]"),image:{icon:"play"}})},onNewPlayingTrack:function(t){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function s(){var a,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(a=void 0,e.track&&(a={file:e.track.file,artist:e.track.artist,title:e.track.title}),e.status.state="play",e.status.elapsed=0,e.track={},e._parseTrack(t.track),!t.status){s.next=10;break}s.t0=t.status,s.next=13;break;case 10:return s.next=12,e.request("music.mpd.status");case 12:s.t0=s.sent;case 13:n=s.t0,e._parseStatus(n),e.startTimer(),a&&e.track.file===a.file&&e.track.artist===a.artist&&e.track.title===a.title||e.showNewTrackNotification();case 17:case"end":return s.stop()}}),s)})))()},onMusicStop:function(t){this.status.state="stop",this.status.elapsed=0,this._parseStatus(t.status),this._parseTrack(t.track),this.stopTimer()},onMusicPlay:function(t){this.status.state="play",this._parseStatus(t.status),this._parseTrack(t.track),this.startTimer()},onMusicPause:function(t){this.status.state="pause",this._parseStatus(t.status),this._parseTrack(t.track),this.syncTime.timestamp=new Date,this.syncTime.elapsed=this.status.elapsed},onSeekChange:function(t){null!=t.position&&(this.status.elapsed=parseFloat(t.position)),t.status&&this._parseStatus(t.status),t.track&&this._parseTrack(t.track),this.syncTime.timestamp=new Date,this.syncTime.elapsed=this.status.elapsed},onVolumeChange:function(t){null!=t.volume&&(this.status.volume=parseFloat(t.volume)),t.status&&this._parseStatus(t.status),t.track&&this._parseTrack(t.track)},onRepeatChange:function(t){this.status.repeat=t.state},onRandomChange:function(t){this.status.random=t.state},onConsumeChange:function(t){this.status.consume=t.state},onSingleChange:function(t){this.status.single=t.state},startTimer:function(){null!=this.timer&&this.stopTimer(),this.syncTime.timestamp=new Date,this.syncTime.elapsed=this.status.elapsed,this.timer=setInterval(this.timerFunc,1e3)},stopTimer:function(){null==this.timer&&(clearInterval(this.timer),this.timer=null)},timerFunc:function(){"play"===this.status.state&&null!=this.status.elapsed&&(this.status.elapsed=this.syncTime.elapsed+(new Date).getTime()/1e3-this.syncTime.timestamp.getTime()/1e3)}},mounted:function(){this.refresh(),this.refreshSeconds&&setInterval(this.refresh,parseInt((1e3*this.refreshSeconds).toFixed(0))),this.subscribe(this.onNewPlayingTrack,"widget-music-on-new-track","platypush.message.event.music.NewPlayingTrackEvent"),this.subscribe(this.onMusicStop,"widget-music-on-music-stop","platypush.message.event.music.MusicStopEvent"),this.subscribe(this.onMusicPlay,"widget-music-on-music-play","platypush.message.event.music.MusicPlayEvent"),this.subscribe(this.onMusicPause,"widget-music-on-music-pause","platypush.message.event.music.MusicPauseEvent"),this.subscribe(this.onSeekChange,"widget-music-on-music-seek","platypush.message.event.music.SeekChangeEvent"),this.subscribe(this.onVolumeChange,"widget-music-on-volume-change","platypush.message.event.music.VolumeChangeEvent"),this.subscribe(this.onRepeatChange,"widget-music-on-repeat-change","platypush.message.event.music.PlaybackRepeatModeChangeEvent"),this.subscribe(this.onRandomChange,"widget-music-on-random-change","platypush.message.event.music.PlaybackRandomModeChangeEvent"),this.subscribe(this.onConsumeChange,"widget-music-on-consume-change","platypush.message.event.music.PlaybackConsumeModeChangeEvent"),this.subscribe(this.onSingleChange,"widget-music-on-single-change","platypush.message.event.music.PlaybackSingleModeChangeEvent")}};s("8752");S.render=y,S.__scopeId="data-v-5d3d83de";e["default"]=S}}]);
//# sourceMappingURL=chunk-3b44ec4e.7824d0f7.js.map