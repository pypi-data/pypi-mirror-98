[target]
description = Device Tree Blobs (for kernels with no dtbs_install)
dependencies = config
preconditions = test -d arch/{target_arch}/boot/dts && ! grep -q ^dtbs_install: {source_tree}/Makefile
commands = {make} dtbs
    && mkdir -p {build_dir}/dtbsinstall
    && cp -r {build_dir}/arch/{target_arch}/boot/dts {build_dir}/dtbsinstall/dtbs
    && find {build_dir}/dtbsinstall/dtbs/ -type f -and -not -name \*.dtb -delete
    && tar caf {build_dir}/dtbs.tar.xz -C {build_dir}/dtbsinstall dtbs


[artifacts]
dtbs.tar.xz = dtbs.tar.xz

