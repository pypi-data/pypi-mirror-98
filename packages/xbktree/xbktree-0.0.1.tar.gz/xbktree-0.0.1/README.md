An algorithm for calculating edit distance